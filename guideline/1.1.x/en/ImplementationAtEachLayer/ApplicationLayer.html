<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>4.3. Implementation of Application Layer &mdash; TERASOLUNA Global Framework Development Guideline 1.1.0-SNAPSHOT documentation</title>
    
    <link rel="stylesheet" href="../_static/solar.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.1.0-SNAPSHOT',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="TERASOLUNA Global Framework Development Guideline 1.1.0-SNAPSHOT documentation" href="../index.html" />
    <link rel="up" title="4. Application Development using TERASOLUNA Global Framework" href="index.html" />
    <link rel="next" title="5. Architecture in Detail - TERASOLUNA Global Framework" href="../ArchitectureInDetail/index.html" />
    <link rel="prev" title="4.2. Implementation of Infrastructure Layer" href="InfrastructureLayer.html" /><script src="../_static/jquery.treeview.js" type="text/javascript"></script>
<!-- <link href='http://fonts.googleapis.com/css?family=Source+Code+Pro|Open+Sans:300italic,400italic,700italic,400,300,700' rel='stylesheet' type='text/css'> -->
<link href="../_static/solarized-dark.css" rel="stylesheet">
<link href="../_static/jquery.treeview.css" rel="stylesheet">
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../ArchitectureInDetail/index.html" title="5. Architecture in Detail - TERASOLUNA Global Framework"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="InfrastructureLayer.html" title="4.2. Implementation of Infrastructure Layer"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">TERASOLUNA Global Framework Development Guideline 1.1.0-SNAPSHOT documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">4. Application Development using TERASOLUNA Global Framework</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper"><label><input id="scroll" type="checkbox" checked> scroll sidebar</label>

  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">4.3. Implementation of Application Layer</a><ul>
<li><a class="reference internal" href="#implementing-controller">4.3.1. Implementing Controller</a><ul>
<li><a class="reference internal" href="#creating-controller-class">4.3.1.1. Creating Controller class</a></li>
<li><a class="reference internal" href="#mapping-request-and-processing-method">4.3.1.2. Mapping request and processing method</a><ul>
<li><a class="reference internal" href="#mapping-with-request-path">4.3.1.2.1. Mapping with request path</a></li>
<li><a class="reference internal" href="#mapping-by-http-method">4.3.1.2.2. Mapping by HTTP method</a></li>
<li><a class="reference internal" href="#mapping-by-request-parameter">4.3.1.2.3. Mapping by request parameter</a></li>
<li><a class="reference internal" href="#mapping-using-request-header">4.3.1.2.4. Mapping using request header</a></li>
<li><a class="reference internal" href="#mapping-using-content-type-header">4.3.1.2.5. Mapping using Content-Type header</a></li>
<li><a class="reference internal" href="#mapping-using-accept-header">4.3.1.2.6. Mapping using Accept header</a></li>
</ul>
</li>
<li><a class="reference internal" href="#controller-mapping-policy-label">4.3.1.3. Mapping request and processing method</a><ul>
<li><a class="reference internal" href="#overview-of-sample-application">4.3.1.3.1. Overview of sample application</a></li>
<li><a class="reference internal" href="#request-url">4.3.1.3.2. Request URL</a></li>
<li><a class="reference internal" href="#controller-mapping-policy-sampleapp-mapping-design-label">4.3.1.3.3. Mapping request and processing method</a></li>
<li><a class="reference internal" href="#implementing-form-display">4.3.1.3.4. Implementing form display</a></li>
<li><a class="reference internal" href="#implementing-the-display-of-user-input-confirmation-screen">4.3.1.3.5. Implementing the display of user input confirmation screen</a></li>
<li><a class="reference internal" href="#implementing-redisplay-of-form">4.3.1.3.6. Implementing &#8216;redisplay of form&#8217;</a></li>
<li><a class="reference internal" href="#implementing-create-new-user-business-logic">4.3.1.3.7. Implementing &#8216;create new user&#8217; business logic</a></li>
<li><a class="reference internal" href="#implementing-notification-of-create-new-user-process-completion">4.3.1.3.8. Implementing notification of create new user process completion</a></li>
<li><a class="reference internal" href="#placing-multiple-buttons-on-html-form">4.3.1.3.9. Placing multiple buttons on HTML form</a></li>
<li><a class="reference internal" href="#source-code-of-controller-of-sample-application">4.3.1.3.10. Source code of controller of sample application</a></li>
</ul>
</li>
<li><a class="reference internal" href="#regarding-arguments-of-processing-method">4.3.1.4. Regarding arguments of processing method</a><ul>
<li><a class="reference internal" href="#passing-data-to-screen-view">4.3.1.4.1. Passing data to screen (View)</a></li>
<li><a class="reference internal" href="#retrieving-values-from-url-path">4.3.1.4.2. Retrieving values from URL path</a></li>
<li><a class="reference internal" href="#retrieving-request-parameters-individually">4.3.1.4.3. Retrieving request parameters individually</a></li>
<li><a class="reference internal" href="#retrieving-request-parameters-collectively">4.3.1.4.4. Retrieving request parameters collectively</a></li>
<li><a class="reference internal" href="#performing-input-validation">4.3.1.4.5. Performing input validation</a></li>
<li><a class="reference internal" href="#passing-data-while-redirecting-request">4.3.1.4.6. Passing data while redirecting request</a></li>
<li><a class="reference internal" href="#passing-request-parameters-to-redirect-destination">4.3.1.4.7. Passing request parameters to redirect destination</a></li>
<li><a class="reference internal" href="#inserting-values-in-redirect-destination-url-path">4.3.1.4.8. Inserting values in redirect destination URL path</a></li>
<li><a class="reference internal" href="#acquiring-values-from-cookie">4.3.1.4.9. Acquiring values from Cookie</a></li>
<li><a class="reference internal" href="#writing-values-in-cookie">4.3.1.4.10. Writing values in Cookie</a></li>
<li><a class="reference internal" href="#retrieving-pagination-information">4.3.1.4.11. Retrieving pagination information</a></li>
<li><a class="reference internal" href="#retrieving-uploaded-file">4.3.1.4.12. Retrieving uploaded file</a></li>
<li><a class="reference internal" href="#displaying-result-message-on-the-screen">4.3.1.4.13. Displaying result message on the screen</a></li>
</ul>
</li>
<li><a class="reference internal" href="#regarding-return-value-of-processing-method">4.3.1.5. Regarding return value of processing method</a><ul>
<li><a class="reference internal" href="#html-response">4.3.1.5.1. HTML response</a></li>
<li><a class="reference internal" href="#responding-to-downloaded-data">4.3.1.5.2. Responding to downloaded data</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-the-process">4.3.1.6. Implementing the process</a><ul>
<li><a class="reference internal" href="#correlation-check-of-input-value">4.3.1.6.1. Correlation check of input value</a></li>
<li><a class="reference internal" href="#calling-business-logic">4.3.1.6.2. Calling business logic</a></li>
<li><a class="reference internal" href="#reflecting-values-to-domain-object">4.3.1.6.3. Reflecting values to domain object</a></li>
<li><a class="reference internal" href="#reflecting-values-to-form-object">4.3.1.6.4. Reflecting values to form object</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-form-object">4.3.2. Implementing form object</a><ul>
<li><a class="reference internal" href="#creating-form-object">4.3.2.1. Creating form object</a><ul>
<li><a class="reference internal" href="#number-format-conversion-of-fields">4.3.2.1.1. Number format conversion of fields</a></li>
<li><a class="reference internal" href="#date-and-time-format-conversion-of-fields">4.3.2.1.2. Date and time format conversion of fields</a></li>
<li><a class="reference internal" href="#datatype-conversion-in-controller">4.3.2.1.3. DataType conversion in controller</a></li>
<li><a class="reference internal" href="#specifying-annotation-for-input-validation">4.3.2.1.4. Specifying annotation for input validation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#initializing-form-object">4.3.2.2. Initializing form object</a></li>
<li><a class="reference internal" href="#binding-to-html-form">4.3.2.3. Binding to HTML form</a></li>
<li><a class="reference internal" href="#binding-request-parameters">4.3.2.4. Binding request parameters</a><ul>
<li><a class="reference internal" href="#determining-binding-result">4.3.2.4.1. Determining binding result</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-view">4.3.3. Implementing View</a><ul>
<li><a class="reference internal" href="#implementing-jsp">4.3.3.1. Implementing JSP</a><ul>
<li><a class="reference internal" href="#creating-common-jsp-for-include">4.3.3.1.1. Creating common JSP for include</a></li>
<li><a class="reference internal" href="#displaying-value-stored-in-model">4.3.3.1.2. Displaying value stored in model</a></li>
<li><a class="reference internal" href="#displaying-numbers-stored-in-model">4.3.3.1.3. Displaying numbers stored in model</a></li>
<li><a class="reference internal" href="#displaying-date-and-time-stored-in-model">4.3.3.1.4. Displaying date and time stored in model</a></li>
<li><a class="reference internal" href="#binding-form-object-to-html-form">4.3.3.1.5. Binding form object to HTML form</a></li>
<li><a class="reference internal" href="#displaying-input-validation-errors">4.3.3.1.6. Displaying input validation errors</a></li>
<li><a class="reference internal" href="#displaying-message-of-processing-result">4.3.3.1.7. Displaying message of processing result</a></li>
<li><a class="reference internal" href="#displaying-codelist">4.3.3.1.8. Displaying codelist</a></li>
<li><a class="reference internal" href="#displaying-fixed-text-content">4.3.3.1.9. Displaying fixed text content</a></li>
<li><a class="reference internal" href="#switching-display-according-to-conditions">4.3.3.1.10. Switching display according to conditions</a></li>
<li><a class="reference internal" href="#repeated-display-of-collection-elements">4.3.3.1.11. Repeated display of collection elements</a></li>
<li><a class="reference internal" href="#displaying-link-for-pagination">4.3.3.1.12. Displaying link for pagination</a></li>
<li><a class="reference internal" href="#switching-display-according-to-authority">4.3.3.1.13. Switching display according to authority</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-javascript">4.3.3.2. Implementing JavaScript</a></li>
<li><a class="reference internal" href="#implementing-style-sheet">4.3.3.3. Implementing style sheet</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-common-logic">4.3.4. Implementing common logic</a><ul>
<li><a class="reference internal" href="#implementing-common-logic-to-be-executed-before-and-after-calling-controller">4.3.4.1. Implementing common logic to be executed before and after calling controller</a><ul>
<li><a class="reference internal" href="#implementing-servlet-filter">4.3.4.1.1. Implementing Servlet Filter</a></li>
<li><a class="reference internal" href="#implementing-handlerinterceptor">4.3.4.1.2. Implementing HandlerInterceptor</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-common-processes-of-controller">4.3.4.2. Implementing common processes of controller</a><ul>
<li><a class="reference internal" href="#implementing-handlermethodargumentresolver">4.3.4.2.1. Implementing HandlerMethodArgumentResolver</a></li>
<li><a class="reference internal" href="#implementing-controlleradvice">4.3.4.2.2. Implementing &#8220;&#64;ControllerAdvice&#8221;</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#prevention-of-double-submission">4.3.5. Prevention of double submission</a></li>
<li><a class="reference internal" href="#usage-of-session">4.3.6. Usage of session</a></li>
</ul>
</li>
</ul>


  <h4>Previous topic</h4>
  <p class="topless"><a href="InfrastructureLayer.html"
                        title="previous chapter">4.2. Implementation of Infrastructure Layer</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../ArchitectureInDetail/index.html"
                        title="next chapter">5. Architecture in Detail - TERASOLUNA Global Framework</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/ImplementationAtEachLayer/ApplicationLayer.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="implementation-of-application-layer">
<h1>4.3. Implementation of Application Layer<a class="headerlink" href="#implementation-of-application-layer" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="index">
<p class="topic-title first">Index</p>
<ul class="simple">
<li><a class="reference internal" href="#implementing-controller" id="id26">Implementing Controller</a><ul>
<li><a class="reference internal" href="#creating-controller-class" id="id27">Creating Controller class</a></li>
<li><a class="reference internal" href="#mapping-request-and-processing-method" id="id28">Mapping request and processing method</a><ul>
<li><a class="reference internal" href="#mapping-with-request-path" id="id29">Mapping with request path</a></li>
<li><a class="reference internal" href="#mapping-by-http-method" id="id30">Mapping by HTTP method</a></li>
<li><a class="reference internal" href="#mapping-by-request-parameter" id="id31">Mapping by request parameter</a></li>
<li><a class="reference internal" href="#mapping-using-request-header" id="id32">Mapping using request header</a></li>
<li><a class="reference internal" href="#mapping-using-content-type-header" id="id33">Mapping using Content-Type header</a></li>
<li><a class="reference internal" href="#mapping-using-accept-header" id="id34">Mapping using Accept header</a></li>
</ul>
</li>
<li><a class="reference internal" href="#controller-mapping-policy-label" id="id35">Mapping request and processing method</a><ul>
<li><a class="reference internal" href="#overview-of-sample-application" id="id36">Overview of sample application</a></li>
<li><a class="reference internal" href="#request-url" id="id37">Request URL</a></li>
<li><a class="reference internal" href="#controller-mapping-policy-sampleapp-mapping-design-label" id="id38">Mapping request and processing method</a></li>
<li><a class="reference internal" href="#implementing-form-display" id="id39">Implementing form display</a></li>
<li><a class="reference internal" href="#implementing-the-display-of-user-input-confirmation-screen" id="id40">Implementing the display of user input confirmation screen</a></li>
<li><a class="reference internal" href="#implementing-redisplay-of-form" id="id41">Implementing &#8216;redisplay of form&#8217;</a></li>
<li><a class="reference internal" href="#implementing-create-new-user-business-logic" id="id42">Implementing &#8216;create new user&#8217; business logic</a></li>
<li><a class="reference internal" href="#implementing-notification-of-create-new-user-process-completion" id="id43">Implementing notification of create new user process completion</a></li>
<li><a class="reference internal" href="#placing-multiple-buttons-on-html-form" id="id44">Placing multiple buttons on HTML form</a></li>
<li><a class="reference internal" href="#source-code-of-controller-of-sample-application" id="id45">Source code of controller of sample application</a></li>
</ul>
</li>
<li><a class="reference internal" href="#regarding-arguments-of-processing-method" id="id46">Regarding arguments of processing method</a><ul>
<li><a class="reference internal" href="#passing-data-to-screen-view" id="id47">Passing data to screen (View)</a></li>
<li><a class="reference internal" href="#retrieving-values-from-url-path" id="id48">Retrieving values from URL path</a></li>
<li><a class="reference internal" href="#retrieving-request-parameters-individually" id="id49">Retrieving request parameters individually</a></li>
<li><a class="reference internal" href="#retrieving-request-parameters-collectively" id="id50">Retrieving request parameters collectively</a></li>
<li><a class="reference internal" href="#performing-input-validation" id="id51">Performing input validation</a></li>
<li><a class="reference internal" href="#passing-data-while-redirecting-request" id="id52">Passing data while redirecting request</a></li>
<li><a class="reference internal" href="#passing-request-parameters-to-redirect-destination" id="id53">Passing request parameters to redirect destination</a></li>
<li><a class="reference internal" href="#inserting-values-in-redirect-destination-url-path" id="id54">Inserting values in redirect destination URL path</a></li>
<li><a class="reference internal" href="#acquiring-values-from-cookie" id="id55">Acquiring values from Cookie</a></li>
<li><a class="reference internal" href="#writing-values-in-cookie" id="id56">Writing values in Cookie</a></li>
<li><a class="reference internal" href="#retrieving-pagination-information" id="id57">Retrieving pagination information</a></li>
<li><a class="reference internal" href="#retrieving-uploaded-file" id="id58">Retrieving uploaded file</a></li>
<li><a class="reference internal" href="#displaying-result-message-on-the-screen" id="id59">Displaying result message on the screen</a></li>
</ul>
</li>
<li><a class="reference internal" href="#regarding-return-value-of-processing-method" id="id60">Regarding return value of processing method</a><ul>
<li><a class="reference internal" href="#html-response" id="id61">HTML response</a></li>
<li><a class="reference internal" href="#responding-to-downloaded-data" id="id62">Responding to downloaded data</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-the-process" id="id63">Implementing the process</a><ul>
<li><a class="reference internal" href="#correlation-check-of-input-value" id="id64">Correlation check of input value</a></li>
<li><a class="reference internal" href="#calling-business-logic" id="id65">Calling business logic</a></li>
<li><a class="reference internal" href="#reflecting-values-to-domain-object" id="id66">Reflecting values to domain object</a></li>
<li><a class="reference internal" href="#reflecting-values-to-form-object" id="id67">Reflecting values to form object</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-form-object" id="id68">Implementing form object</a><ul>
<li><a class="reference internal" href="#creating-form-object" id="id69">Creating form object</a><ul>
<li><a class="reference internal" href="#number-format-conversion-of-fields" id="id70">Number format conversion of fields</a></li>
<li><a class="reference internal" href="#date-and-time-format-conversion-of-fields" id="id71">Date and time format conversion of fields</a></li>
<li><a class="reference internal" href="#datatype-conversion-in-controller" id="id72">DataType conversion in controller</a></li>
<li><a class="reference internal" href="#specifying-annotation-for-input-validation" id="id73">Specifying annotation for input validation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#initializing-form-object" id="id74">Initializing form object</a></li>
<li><a class="reference internal" href="#binding-to-html-form" id="id75">Binding to HTML form</a></li>
<li><a class="reference internal" href="#binding-request-parameters" id="id76">Binding request parameters</a><ul>
<li><a class="reference internal" href="#determining-binding-result" id="id77">Determining binding result</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-view" id="id78">Implementing View</a><ul>
<li><a class="reference internal" href="#implementing-jsp" id="id79">Implementing JSP</a><ul>
<li><a class="reference internal" href="#creating-common-jsp-for-include" id="id80">Creating common JSP for include</a></li>
<li><a class="reference internal" href="#displaying-value-stored-in-model" id="id81">Displaying value stored in model</a></li>
<li><a class="reference internal" href="#displaying-numbers-stored-in-model" id="id82">Displaying numbers stored in model</a></li>
<li><a class="reference internal" href="#displaying-date-and-time-stored-in-model" id="id83">Displaying date and time stored in model</a></li>
<li><a class="reference internal" href="#binding-form-object-to-html-form" id="id84">Binding form object to HTML form</a></li>
<li><a class="reference internal" href="#displaying-input-validation-errors" id="id85">Displaying input validation errors</a></li>
<li><a class="reference internal" href="#displaying-message-of-processing-result" id="id86">Displaying message of processing result</a></li>
<li><a class="reference internal" href="#displaying-codelist" id="id87">Displaying codelist</a></li>
<li><a class="reference internal" href="#displaying-fixed-text-content" id="id88">Displaying fixed text content</a></li>
<li><a class="reference internal" href="#switching-display-according-to-conditions" id="id89">Switching display according to conditions</a></li>
<li><a class="reference internal" href="#repeated-display-of-collection-elements" id="id90">Repeated display of collection elements</a></li>
<li><a class="reference internal" href="#displaying-link-for-pagination" id="id91">Displaying link for pagination</a></li>
<li><a class="reference internal" href="#switching-display-according-to-authority" id="id92">Switching display according to authority</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-javascript" id="id93">Implementing JavaScript</a></li>
<li><a class="reference internal" href="#implementing-style-sheet" id="id94">Implementing style sheet</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-common-logic" id="id95">Implementing common logic</a><ul>
<li><a class="reference internal" href="#implementing-common-logic-to-be-executed-before-and-after-calling-controller" id="id96">Implementing common logic to be executed before and after calling controller</a><ul>
<li><a class="reference internal" href="#implementing-servlet-filter" id="id97">Implementing Servlet Filter</a></li>
<li><a class="reference internal" href="#implementing-handlerinterceptor" id="id98">Implementing HandlerInterceptor</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementing-common-processes-of-controller" id="id99">Implementing common processes of controller</a><ul>
<li><a class="reference internal" href="#implementing-handlermethodargumentresolver" id="id100">Implementing HandlerMethodArgumentResolver</a></li>
<li><a class="reference internal" href="#implementing-controlleradvice" id="id101">Implementing &#8220;&#64;ControllerAdvice&#8221;</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#prevention-of-double-submission" id="id102">Prevention of double submission</a></li>
<li><a class="reference internal" href="#usage-of-session" id="id103">Usage of session</a></li>
</ul>
</div>
<p>This chapter explains implementation of application layer of a web application that uses HTML forms.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Refer to the following page for the implementation required for Ajax development and REST API.</p>
<ul class="last simple">
<li><a class="reference internal" href="../ArchitectureInDetail/Ajax.html"><em>Ajax</em></a></li>
</ul>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Implementation of application layer is given in the following 3 steps.</p>
<ol class="arabic">
<li><div class="first line-block">
<div class="line"><a class="reference internal" href="#controller-label"><em>Implementing Controller</em></a></div>
<div class="line">Controller receives the request, calls business logic, updates model, decides View. Thereby, controls one complete round of operations after receiving the request.</div>
<div class="line">It is the most important part in the implementation of application layer.</div>
</div>
</li>
<li><div class="first line-block">
<div class="line"><a class="reference internal" href="#formobject"><em>Implementing form object</em></a></div>
</div>
<p><a href="#id1"><span class="problematic" id="id2">|</span></a>Form object transfers the values between HTML form and application.</p>
</li>
<li><div class="first line-block">
<div class="line"><a class="reference internal" href="#view"><em>Implementing View</em></a></div>
<div class="line">View (JSP) acquires the data from model (form object, domain object etc.) and generates screen (HTML).</div>
</div>
</li>
</ol>
<div class="section" id="implementing-controller">
<span id="controller-label"></span><h2><a class="toc-backref" href="#id26">4.3.1. Implementing Controller</a><a class="headerlink" href="#implementing-controller" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">Implementation of Controller is explained below.</div>
<div class="line">The Controller performs the following roles.</div>
</div>
<ol class="arabic">
<li><div class="first line-block">
<div class="line"><strong>Provides a method to receive the request.</strong></div>
<div class="line">Receives requests by implementing methods to which <tt class="docutils literal"><span class="pre">&#64;RequestMapping</span></tt>annotation is assigned.</div>
</div>
</li>
<li><div class="first line-block">
<div class="line"><strong>Performs input validation of request parameter.</strong></div>
<div class="line">For request which requires input validation of request parameters, it can be  performed by specifying <tt class="docutils literal"><span class="pre">&#64;Validated</span></tt> annotation to form object argument of method which receives the request.</div>
<div class="line">Performs single item check using Bean Validation and correlation check by Spring Validator or Bean Validation.</div>
</div>
</li>
<li><div class="first line-block">
<div class="line"><strong>Calls business logic.</strong></div>
<div class="line">Controller does not implement business logic but delegates by calling Service method.</div>
</div>
</li>
<li><div class="first line-block">
<div class="line"><strong>Reflects the output of business logic to Model.</strong></div>
<div class="line">The output can be referred in View by reflecting domain object returned from Service method to <tt class="docutils literal"><span class="pre">Model</span></tt>.</div>
</div>
</li>
<li><div class="first line-block">
<div class="line"><strong>Returns View name corresponding to business logic output.</strong></div>
<div class="line">Controller does not implement the logic of rendering the view. Rendering is done in View technologies like JSP etc.</div>
<div class="line">Controller only returns the name of the view in which the rendering logic is implemented.</div>
<div class="line">The View corresponding to view name is resolved by <tt class="docutils literal"><span class="pre">ViewResolver</span></tt>provided by Spring Framework.</div>
</div>
</li>
</ol>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/application_logic-of-controller.png"><img alt="responsibility of logic" src="../_images/application_logic-of-controller.png" style="width: 80%;" /></a>
<p class="caption"><strong>Picture - Logic of controller</strong></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><strong>It is recommended that controller implements only the routing logic</strong> such as calling business logic, reflecting output of the business logic to <tt class="docutils literal"><span class="pre">Model</span></tt>, deciding the View name is implemented in the Controller.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>The implementation of Controller is explained by focusing on the following points.</p>
<ul class="simple">
<li><a class="reference internal" href="#controller-new-label"><em>Creating Controller class</em></a></li>
<li><a class="reference internal" href="#controller-mapping-label"><em>Mapping request and processing method</em></a></li>
<li><a class="reference internal" href="#controller-method-argument-label"><em>Regarding arguments of processing method</em></a></li>
<li><a class="reference internal" href="#controller-method-return-label"><em>Regarding return value of processing method</em></a></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="creating-controller-class">
<span id="controller-new-label"></span><h3><a class="toc-backref" href="#id27">4.3.1.1. Creating Controller class</a><a class="headerlink" href="#creating-controller-class" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line"><a href="#id3"><span class="problematic" id="id4">**</span></a>Controller class is created with &#64;Controller annotation added to POJO class (Annotation-based Controller). **</div>
<div class="line">Controller in Spring MVC can also be created by implementing <tt class="docutils literal"><span class="pre">org.springframework.web.servlet.mvc.Controller</span></tt> interface (Interface-based Controller). However, it is preferred to avoid using it as it is Deprecated from Spring 3 onwards.</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@Controller</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleController</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="mapping-request-and-processing-method">
<span id="controller-mapping-label"></span><h3><a class="toc-backref" href="#id28">4.3.1.2. Mapping request and processing method</a><a class="headerlink" href="#mapping-request-and-processing-method" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line"><tt class="docutils literal"><span class="pre">&#64;RequestMapping</span></tt>annotation is assigned to the method that receives request.</div>
<div class="line">In this document, the method to which <tt class="docutils literal"><span class="pre">&#64;RequestMapping</span></tt>is added, is called as &#8220;processing method&#8221;.</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>The rules for mapping the incoming request with a processing method can be specifying as attributes of <tt class="docutils literal"><span class="pre">&#64;RequestMapping</span></tt>annotation.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="10%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Attribute name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ol class="first last arabic simple">
<li></li>
</ol>
</td>
<td>value</td>
<td><div class="first last line-block">
<div class="line">Specify request path which needs to be mapped (multiple values allowed).</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="2">
<li></li>
</ol>
</td>
<td>method</td>
<td><div class="first last line-block">
<div class="line">Specify HTTP method (<tt class="docutils literal"><span class="pre">RequestMethod</span></tt>type) which needs to be mapped (multiple methods allowed).</div>
<div class="line">GET/POST are mainly used for mapping requests from HTML form, while other HTTP methods (such as PUT/DELETE) are used for mapping requests from REST APIs as well.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="3">
<li></li>
</ol>
</td>
<td>params</td>
<td><div class="first last line-block">
<div class="line">Specify request parameters which needs to be mapped (multiple parameters allowed).</div>
<div class="line">Request parameters are mainly used for mapping request from HTML form. If this mapping method is used, the case of mapping multiple buttons on HTML page can be implemented easily.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="4">
<li></li>
</ol>
</td>
<td>headers</td>
<td><div class="first last line-block">
<div class="line">Specify request headers which needs to be mapped (multiple headers allowed).</div>
<div class="line">Mainly used while mapping REST API and Ajax requests.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="5">
<li></li>
</ol>
</td>
<td>consumes</td>
<td><div class="first last line-block">
<div class="line">Mapping can be performed using Content-Type header of request. Specify media type which needs to be mapped (multiple types allowed).</div>
<div class="line">Mainly used while mapping REST API and Ajax requests.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="6">
<li></li>
</ol>
</td>
<td>produces</td>
<td><div class="first last line-block">
<div class="line">Mapping can be performed using Accept header of request. Specify media type which needs to be mapped (multiple types allowed).</div>
<div class="line">Mainly used while mapping REST API and Ajax requests.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Combination of mapping</strong></p>
<p class="last">Complex mapping can be performed by combining multiple attributes, but considering maintainability, mapping should be defined and designed in the simplest way possible .
It is recommended to consider combining 2 attributes (value attribute and any other 1 attribute).</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line">6 examples of mapping are shown below.</div>
</div>
<ul class="simple">
<li><a class="reference internal" href="#controller-mapping-path-label"><em>Mapping with request path</em></a></li>
<li><a class="reference internal" href="#controller-mapping-method-label"><em>Mapping by HTTP method</em></a></li>
<li><a class="reference internal" href="#controller-mapping-params-label"><em>Mapping by request parameter</em></a></li>
<li><a class="reference internal" href="#controller-mapping-headers-label"><em>Mapping using request header</em></a></li>
<li><a class="reference internal" href="#controller-mapping-contenttype-label"><em>Mapping using Content-Type header</em></a></li>
<li><a class="reference internal" href="#controller-mapping-accept-label"><em>Mapping using Accept header</em></a></li>
</ul>
<div class="line-block">
<div class="line">In the following explanation, it is prerequisite to define the processing method in the Controller class.</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="nd">@Controller</span> <span class="c1">// (1)</span>
</span><span class="hll"><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;sample&quot;</span><span class="o">)</span> <span class="c1">// (2)</span>
</span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleController</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>With <tt class="docutils literal"><span class="pre">&#64;Controller</span></tt>, it is recognized as Annotation-based controller class and becomes the target of component scan.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>All the processing methods in this class are mapped to URLs with &#8220;sample&#8221; by adding <tt class="docutils literal"><span class="pre">&#64;RequestMapping(&quot;sample&quot;)</span></tt>annotation at class level.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="mapping-with-request-path">
<span id="controller-mapping-path-label"></span><h4><a class="toc-backref" href="#id29">4.3.1.2.1. Mapping with request path</a><a class="headerlink" href="#mapping-with-request-path" title="Permalink to this headline">¶</a></h4>
<p>In case of the following definition, if the URL <tt class="docutils literal"><span class="pre">&quot;sample/hello&quot;</span></tt> is accessed, then <tt class="docutils literal"><span class="pre">hello()</span></tt> method is executed.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">()</span> <span class="o">{</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line">When multiple values are specified, it is handled by &#8216;OR&#8217; condition.</div>
<div class="line">In case of following definition, if <tt class="docutils literal"><span class="pre">&quot;sample/hello&quot;</span></tt> or <tt class="docutils literal"><span class="pre">&quot;sample/bonjour&quot;</span></tt> is accessed, then <tt class="docutils literal"><span class="pre">hello()</span></tt> method is executed.</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="o">{</span><span class="s">&quot;hello&quot;</span><span class="o">,</span> <span class="s">&quot;bonjour&quot;</span><span class="o">})</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">()</span> <span class="o">{</span>
</pre></div>
</div>
</div></blockquote>
<p>Pattern can be specified instead of a specific value for request path. For details of specifying patterns, refer to reference documention of Spring Framework.</p>
<ul class="simple">
<li><a class="reference external" href="http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/mvc.html#mvc-ann-requestmapping-uri-templates">URI Template Patterns</a></li>
<li><a class="reference external" href="http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/mvc.html#mvc-ann-requestmapping-uri-templates-regex">URI Template Patterns with Regular Expressions</a></li>
<li><a class="reference external" href="http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/mvc.html#mvc-ann-requestmapping-patterns">Path Patterns</a></li>
<li><a class="reference external" href="http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/mvc.html#mvc-ann-requestmapping-placeholders">Patterns with Placeholders</a></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="mapping-by-http-method">
<span id="controller-mapping-method-label"></span><h4><a class="toc-backref" href="#id30">4.3.1.2.2. Mapping by HTTP method</a><a class="headerlink" href="#mapping-by-http-method" title="Permalink to this headline">¶</a></h4>
<p>In case of the following definition, if the URL <tt class="docutils literal"><span class="pre">&quot;sample/hello&quot;</span></tt> is accessed with POST method, then  <tt class="docutils literal"><span class="pre">hello()</span></tt> method is executed.
For the list of supported HTTP methods, refer to <a class="reference external" href="http://static.springsource.org/spring/docs/3.2.x/javadoc-api/org/springframework/web/bind/annotation/RequestMethod.html">Javadoc</a> of Spring framework.
When not specified, all supported HTTP methods are mapped.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;hello&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">()</span> <span class="o">{</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line">When multiple values are specified, it is handled by &#8216;OR&#8217; condition.</div>
<div class="line">In case of following definition, if <tt class="docutils literal"><span class="pre">&quot;sample/hello&quot;</span></tt> is accessed with GET or HEAD method, then <tt class="docutils literal"><span class="pre">hello()</span></tt> method is executed.</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;hello&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="o">{</span><span class="n">RequestMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">,</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">HEAD</span><span class="o">})</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">()</span> <span class="o">{</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="mapping-by-request-parameter">
<span id="controller-mapping-params-label"></span><h4><a class="toc-backref" href="#id31">4.3.1.2.3. Mapping by request parameter</a><a class="headerlink" href="#mapping-by-request-parameter" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">In case of following definition, if the URL <tt class="docutils literal"><span class="pre">sample/hello?form</span></tt> is accessed, then <tt class="docutils literal"><span class="pre">hello()</span></tt> method is executed.</div>
<div class="line">When request is sent as a POST request, request parameters may exist in request body even if they do not exist in URL.</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;hello&quot;</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;form&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">()</span> <span class="o">{</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line">When multiple values are specified, it is handled by &#8216;AND&#8217; condition.</div>
<div class="line">In case of following definition, if the URL <tt class="docutils literal"><span class="pre">&quot;sample/hello?form&amp;formType=foo&quot;</span></tt> is accessed, then <tt class="docutils literal"><span class="pre">hello()</span></tt> method is executed.</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;hello&quot;</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="o">{</span><span class="s">&quot;form&quot;</span><span class="o">,</span> <span class="s">&quot;formType=foo&quot;</span><span class="o">})</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">(</span><span class="nd">@RequestParam</span><span class="o">(</span><span class="s">&quot;formType&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">formType</span><span class="o">)</span> <span class="o">{</span>
</pre></div>
</div>
</div></blockquote>
<p>Supported formats are as follows.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="25%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Format</th>
<th class="head">Explanation</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ol class="first last arabic simple">
<li></li>
</ol>
</td>
<td>paramName</td>
<td>Mapping is performed when request parameter of the specified parameName exists.</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="2">
<li></li>
</ol>
</td>
<td>!paramName</td>
<td>Mapping is performed when request parameter of the specified parameName does not exist.</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="3">
<li></li>
</ol>
</td>
<td>paramName=paramValue</td>
<td>Mapping is performed when value of the specified parameName is paramValue.</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="4">
<li></li>
</ol>
</td>
<td>paramName!=paramValue</td>
<td>Mapping is performed when value of the specified parameName is not paramValue.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="mapping-using-request-header">
<span id="controller-mapping-headers-label"></span><h4><a class="toc-backref" href="#id32">4.3.1.2.4. Mapping using request header</a><a class="headerlink" href="#mapping-using-request-header" title="Permalink to this headline">¶</a></h4>
<p>Refer to the details on the following page to mainly use the controller to map REST API and Ajax requests.</p>
<ul class="simple">
<li><a class="reference internal" href="../ArchitectureInDetail/Ajax.html"><em>Ajax</em></a></li>
</ul>
</div>
<div class="section" id="mapping-using-content-type-header">
<span id="controller-mapping-contenttype-label"></span><h4><a class="toc-backref" href="#id33">4.3.1.2.5. Mapping using Content-Type header</a><a class="headerlink" href="#mapping-using-content-type-header" title="Permalink to this headline">¶</a></h4>
<p>Refer to the details on the following page to mainly use the controller to map REST API and Ajax requests.</p>
<ul class="simple">
<li><a class="reference internal" href="../ArchitectureInDetail/Ajax.html"><em>Ajax</em></a></li>
</ul>
</div>
<div class="section" id="mapping-using-accept-header">
<span id="controller-mapping-accept-label"></span><h4><a class="toc-backref" href="#id34">4.3.1.2.6. Mapping using Accept header</a><a class="headerlink" href="#mapping-using-accept-header" title="Permalink to this headline">¶</a></h4>
<p>Refer to the details on the following page to mainly use the controller to map REST API and Ajax requests.</p>
<ul class="simple">
<li><a class="reference internal" href="../ArchitectureInDetail/Ajax.html"><em>Ajax</em></a></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="controller-mapping-policy-label">
<span id="id5"></span><h3><a class="toc-backref" href="#id35">4.3.1.3. Mapping request and processing method</a><a class="headerlink" href="#controller-mapping-policy-label" title="Permalink to this headline">¶</a></h3>
<p>Mapping by the following method is recommended.</p>
<ul>
<li><div class="first line-block">
<div class="line"><strong>Grouping of URL of request is done for each unit of business flow or functional flow.</strong></div>
<div class="line">URL grouping means defining <tt class="docutils literal"><span class="pre">&#64;RequestMapping(value</span> <span class="pre">=</span> <span class="pre">&quot;xxx&quot;)</span></tt> as class level annotation.</div>
</div>
</li>
<li><div class="first line-block">
<div class="line"><strong>Use the same URL for requests for screen transitions within same functional flow</strong></div>
<div class="line">The same URL means the value of &#8216;value&#8217; attribute of <tt class="docutils literal"><span class="pre">&#64;RequestMapping(value</span> <span class="pre">=</span> <span class="pre">&quot;xxx&quot;)</span></tt> must be same.</div>
<div class="line">Determining which processing method is used for a particular request with same functional flow is performed using HTTP method and HTTP parameters.</div>
</div>
</li>
</ul>
<p>The following is an example of mapping between incoming request and processing method by a sample application with basic screen flow.</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="#controller-mapping-policy-sampleapp-overview-label"><em>Overview of sample application</em></a></li>
<li><a class="reference internal" href="#controller-mapping-policy-sampleapp-url-design-label"><em>Request URL</em></a></li>
<li><a class="reference internal" href="#controller-mapping-policy-sampleapp-mapping-design-label"><em>Mapping request and processing method</em></a></li>
<li><a class="reference internal" href="#controller-mapping-policy-sampleapp-form-impl-label"><em>Implementing form display</em></a></li>
<li><a class="reference internal" href="#controller-mapping-policy-sampleapp-confirm-impl-label"><em>Implementing the display of user input confirmation screen</em></a></li>
<li><a class="reference internal" href="#controller-mapping-policy-sampleapp-redo-impl-label"><em>Implementing &#8216;redisplay of form&#8217;</em></a></li>
<li><a class="reference internal" href="#controller-mapping-policy-sampleapp-create-impl-label"><em>Implementing &#8216;create new user&#8217; business logic</em></a></li>
</ul>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="overview-of-sample-application">
<span id="controller-mapping-policy-sampleapp-overview-label"></span><h4><a class="toc-backref" href="#id36">4.3.1.3.1. Overview of sample application</a><a class="headerlink" href="#overview-of-sample-application" title="Permalink to this headline">¶</a></h4>
<p>Functional overview of sample application is as follows.</p>
<ul>
<li><div class="first line-block">
<div class="line">Provides functionality of performing CRUD operations of Entity.</div>
</div>
</li>
<li><div class="first line-block">
<div class="line">Following 5 operations are provided.</div>
</div>
</li>
</ul>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="20%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Operation name</th>
<th class="head">Overview</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ol class="first last arabic simple">
<li></li>
</ol>
</td>
<td>Fetching list of Entities</td>
<td>Fetch list of all the created Entities to be displayed on the list screen.</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="2">
<li></li>
</ol>
</td>
<td>Create Entity</td>
<td>Create a new Entity with the specified contents. Screen flow (form screen, confirmation screen, completion screen) exists for this process.</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="3">
<li></li>
</ol>
</td>
<td>Fetching details of Entity</td>
<td>Fetch Entity of specified ID to be displayed on the details screen.</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="4">
<li></li>
</ol>
</td>
<td>Entity update</td>
<td>Update Entity of specified ID. Screen flow (form screen, confirmation screen, completion screen) exists for this process.</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="5">
<li></li>
</ol>
</td>
<td>Entity delete</td>
<td>Delete Entity of specified ID.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<ul>
<li><div class="first line-block">
<div class="line">Screen flow of all functions is as follows.</div>
<div class="line">It is not mentioned in screen flow diagram however, when input validation error occurs, form screen is displayed again.</div>
</div>
</li>
</ul>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/application_sample-screen-flow.png"><img alt="Screen flow of entity management function" src="../_images/application_sample-screen-flow.png" style="width: 90%;" /></a>
<p class="caption"><strong>Picture - Screen flow of entity management function</strong></p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="request-url">
<span id="controller-mapping-policy-sampleapp-url-design-label"></span><h4><a class="toc-backref" href="#id37">4.3.1.3.2. Request URL</a><a class="headerlink" href="#request-url" title="Permalink to this headline">¶</a></h4>
<p>Design the URL of the required requests.</p>
<ul>
<li><div class="first line-block">
<div class="line">Request URLs of all the requests required by the process flow are grouped.</div>
<div class="line">This functionality performs CRUD operations of Entity called ABC, therefore URL that starts with <tt class="docutils literal"><span class="pre">&quot;/abc/&quot;</span></tt> is considered.</div>
</div>
</li>
<li><p class="first">Design request URL for each operation of the functionality.</p>
</li>
</ul>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="30%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Operation name</th>
<th class="head">URL for each operation (pattern)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ol class="first last arabic simple">
<li></li>
</ol>
</td>
<td>Fetching list of Entities</td>
<td>/abc/list</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="2">
<li></li>
</ol>
</td>
<td>Create Entity</td>
<td>/abc/create</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="3">
<li></li>
</ol>
</td>
<td>Fetching details of Entity</td>
<td>/abc/{id}</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="4">
<li></li>
</ol>
</td>
<td>Entity update</td>
<td>/abc/{id}/update</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="5">
<li></li>
</ol>
</td>
<td>Entity delete</td>
<td>/abc/{id}/delete</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><tt class="docutils literal"><span class="pre">&quot;{id}&quot;</span></tt> specified in URL of &#8216;Fetching details of Entity&#8217;, &#8216;Entity update&#8217;, &#8216;Entity delete&#8217; operations is called as, <a class="reference external" href="http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/mvc.html#mvc-ann-requestmapping-uri-templates">URI Template Pattern</a>and any value can be specified.
In this sample application, Entity ID is specified.</p>
</div>
<p>Assigned URL of each operation of screen flow diagram is mapped as shown below:</p>
</div></blockquote>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/application_sample-screen-flow-assigned-url.png"><img alt="Screen flow of entity management function and corresponding assigned URL" src="../_images/application_sample-screen-flow-assigned-url.png" style="width: 90%;" /></a>
<p class="caption"><strong>Picture - Screen flow of entity management function and corresponding assigned URL</strong></p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="controller-mapping-policy-sampleapp-mapping-design-label">
<span id="id6"></span><h4><a class="toc-backref" href="#id38">4.3.1.3.3. Mapping request and processing method</a><a class="headerlink" href="#controller-mapping-policy-sampleapp-mapping-design-label" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">Design the mapping between incoming request and processing method.</div>
<div class="line">The following is the mapping design which is designed according to mapping policy.</div>
</div>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="5%" />
<col width="20%" />
<col width="15%" />
<col width="22%" />
<col width="10%" />
<col width="13%" />
<col width="15%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><div class="first last line-block">
<div class="line">Sr.No.</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Operation name</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">URL</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Request name</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">HTTP</div>
<div class="line">Method</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">HTTP</div>
<div class="line">Parameter</div>
</div>
</th>
<th class="head"><div class="first last line-block">
<div class="line">Processing method</div>
</div>
</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ol class="first last arabic simple">
<li></li>
</ol>
</td>
<td>Fetching list of Entities</td>
<td>/abc/list</td>
<td>List display</td>
<td>GET</td>
<td>-</td>
<td>list</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="2">
<li></li>
</ol>
</td>
<td>Create New Entity</td>
<td>/abc/create</td>
<td>Form display</td>
<td>-</td>
<td>form</td>
<td>createForm</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="3">
<li></li>
</ol>
</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>Displaying input confirmation</td>
<td>POST</td>
<td>confirm</td>
<td>createConfirm</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="4">
<li></li>
</ol>
</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>Form re-display</td>
<td>POST</td>
<td>redo</td>
<td>createRedo</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="5">
<li></li>
</ol>
</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>Entity Creation</td>
<td>POST</td>
<td>-</td>
<td>create</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="6">
<li></li>
</ol>
</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>Displaying completion of Entity Creation</td>
<td>GET</td>
<td>complete</td>
<td>createComplete</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="7">
<li></li>
</ol>
</td>
<td>Fetching details of Entity</td>
<td>/abc/{id}</td>
<td>Display details of Entity</td>
<td>GET</td>
<td>-</td>
<td>read</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="8">
<li></li>
</ol>
</td>
<td>Entity update</td>
<td>/abc/{id}/update</td>
<td>Displaying Form</td>
<td>-</td>
<td>form</td>
<td>updateForm</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="9">
<li></li>
</ol>
</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>Displaying confirmation of user input</td>
<td>POST</td>
<td>confirm</td>
<td>updateConfirm</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="10">
<li></li>
</ol>
</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>Form re-display</td>
<td>POST</td>
<td>redo</td>
<td>updateRedo</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="11">
<li></li>
</ol>
</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>Update</td>
<td>POST</td>
<td>-</td>
<td>update</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="12">
<li></li>
</ol>
</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>Displaying completion of update process</td>
<td>GET</td>
<td>complete</td>
<td>updateComplete</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="13">
<li></li>
</ol>
</td>
<td>Entity delete</td>
<td>/abc/{id}/delete</td>
<td>Delete</td>
<td>POST</td>
<td>-</td>
<td>delete</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="14">
<li></li>
</ol>
</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>Displaying completion of delete process</td>
<td>GET</td>
<td>complete</td>
<td>deleteComplete</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line">Multiple requests exist for each of Create Entity, Entity Update and Entity Delete functions. Therefore switching of processing methods is done using HTTP method and HTTP parameters.</div>
<div class="line">The following is the flow of requests in case of multiple requests in a function like &#8220;Create New Entity&#8221;.</div>
<div class="line">All URLs are <tt class="docutils literal"><span class="pre">&quot;/abc/create&quot;</span></tt> and determining the processing method is done based on combination of HTTP method and HTTP parameters.</div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/applicationScreenflow.png"><img alt="Request flow of entity create processing" src="../_images/applicationScreenflow.png" style="width: 90%;" /></a>
<p class="caption"><strong>Picture - Request flow of entity create processing</strong></p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="line-block">
<div class="line">Implementation of processing method for &#8220;Create New Entity&#8221; is shown below.</div>
<div class="line">Here, the purpose is to understand mapping between request and processing method and therefore focus must on <tt class="docutils literal"><span class="pre">&#64;RequestMapping</span></tt>.</div>
<div class="line">The details of argument and return value (view name and view) of processing method are explained in the next chapter.</div>
</div>
<ul class="simple">
<li><a class="reference internal" href="#controller-mapping-policy-sampleapp-form-impl-label"><em>Implementing form display</em></a></li>
<li><a class="reference internal" href="#controller-mapping-policy-sampleapp-confirm-impl-label"><em>Implementing the display of user input confirmation screen</em></a></li>
<li><a class="reference internal" href="#controller-mapping-policy-sampleapp-redo-impl-label"><em>Implementing &#8216;redisplay of form&#8217;</em></a></li>
<li><a class="reference internal" href="#controller-mapping-policy-sampleapp-create-impl-label"><em>Implementing &#8216;create new user&#8217; business logic</em></a></li>
<li><a class="reference internal" href="#controller-mapping-policy-sampleapp-complete-impl-label"><em>Implementing notification of create new user process completion</em></a></li>
<li><a class="reference internal" href="#controller-mapping-policy-sampleapp-multi-impl-label"><em>Placing multiple buttons on HTML form</em></a></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="implementing-form-display">
<span id="controller-mapping-policy-sampleapp-form-impl-label"></span><h4><a class="toc-backref" href="#id39">4.3.1.3.4. Implementing form display</a><a class="headerlink" href="#implementing-form-display" title="Permalink to this headline">¶</a></h4>
<p>In order to display the form, <tt class="docutils literal"><span class="pre">form</span></tt> is specified as HTTP parameter.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;form&quot;</span><span class="o">)</span> <span class="c1">// (1)</span>
</span><span class="kd">public</span> <span class="n">String</span> <span class="nf">createForm</span><span class="o">(</span><span class="n">AbcForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// omitted</span>
<span class="hll">    <span class="k">return</span> <span class="s">&quot;abc/createForm&quot;</span><span class="o">;</span> <span class="c1">// (2)</span>
</span><span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Specify <tt class="docutils literal"><span class="pre">&quot;form&quot;</span></tt> as value of <tt class="docutils literal"><span class="pre">params</span></tt> attribute.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Return view name of JSP to render form screen.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In this processing method, <tt class="docutils literal"><span class="pre">method</span></tt> attribute is not specified since it is not required for HTTP GET method.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Example of implementation of sections other than processing method is explained below.</p>
<p>Besides implementing the processing method for form display, points mentioned below are required:</p>
<ul class="simple">
<li>Implement generation process of form object. Refer to <a class="reference internal" href="#formobject"><em>Implementing form object</em></a> for the details of form object.</li>
<li>Implement View of form screen. Refer to <a class="reference internal" href="#view"><em>Implementing View</em></a> for the details of View.</li>
</ul>
<p>Use the following form object.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AbcForm</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="o">;</span>

    <span class="nd">@NotEmpty</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">input1</span><span class="o">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Min</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
    <span class="nd">@Max</span><span class="o">(</span><span class="mi">10</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">input2</span><span class="o">;</span>

    <span class="c1">// omitted setter&amp;getter</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<p>Creating an object of AbcForm.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@ModelAttribute</span>
<span class="kd">public</span> <span class="n">AbcForm</span> <span class="nf">setUpAbcForm</span><span class="o">()</span> <span class="o">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nf">AbcForm</span><span class="o">();</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<p>Create view(JSP) of form screen.</p>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="nt">&lt;h1&gt;</span>Abc Create Form<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;form:form</span> <span class="na">modelAttribute=</span><span class="s">&quot;abcForm&quot;</span>
  <span class="na">action=</span><span class="s">&quot;${pageContext.request.contextPath}/abc/create&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;input1&quot;</span><span class="nt">&gt;</span>Input1<span class="nt">&lt;/form:label&gt;</span>
  <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;input1&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;input1&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;br&gt;</span>
  <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;input2&quot;</span><span class="nt">&gt;</span>Input2<span class="nt">&lt;/form:label&gt;</span>
  <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;input2&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;input2&quot;</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;br&gt;</span>
<span class="hll">  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">name=</span><span class="s">&quot;confirm&quot;</span> <span class="na">value=</span><span class="s">&quot;Confirm&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (1) --&gt;</span>
</span><span class="nt">&lt;/form:form&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Specify  <tt class="docutils literal"><span class="pre">name=&quot;confirm&quot;</span></tt>parameter for submit button to transit to confirmation screen.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>The operations are explained below.</p>
<div class="line-block">
<div class="line">Sending the request for form display.</div>
<div class="line">Access <tt class="docutils literal"><span class="pre">&quot;abc/create?form&quot;</span></tt> URL.</div>
<div class="line">Since <tt class="docutils literal"><span class="pre">form</span></tt> is specified in the URL as an HTTP parameter, <tt class="docutils literal"><span class="pre">createForm</span></tt> method of controller is called and form screen is displayed.</div>
</div>
<blockquote>
<div><div class="figure">
<a class="reference internal image-reference" href="../_images/applicationCreateFormDisplay.png"><img alt="../_images/applicationCreateFormDisplay.png" src="../_images/applicationCreateFormDisplay.png" style="width: 90%;" /></a>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="implementing-the-display-of-user-input-confirmation-screen">
<span id="controller-mapping-policy-sampleapp-confirm-impl-label"></span><h4><a class="toc-backref" href="#id40">4.3.1.3.5. Implementing the display of user input confirmation screen</a><a class="headerlink" href="#implementing-the-display-of-user-input-confirmation-screen" title="Permalink to this headline">¶</a></h4>
<p>To check user input in the form, data is sent by POST method and <tt class="docutils literal"><span class="pre">confirm</span></tt> is specified as HTTP parameter.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;confirm&quot;</span><span class="o">)</span> <span class="c1">// (1)</span>
</span><span class="kd">public</span> <span class="n">String</span> <span class="nf">createConfirm</span><span class="o">(</span><span class="nd">@Validated</span> <span class="n">AbcForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="o">,</span>
        <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">())</span> <span class="o">{</span>
<span class="hll">        <span class="k">return</span> <span class="nf">createRedo</span><span class="o">(</span><span class="n">form</span><span class="o">,</span> <span class="n">model</span><span class="o">);</span> <span class="c1">// return &quot;abc/createForm&quot;; (2)</span>
</span>    <span class="o">}</span>
    <span class="c1">// ommited</span>
<span class="hll">    <span class="k">return</span> <span class="s">&quot;abc/createConfirm&quot;</span><span class="o">;</span> <span class="c1">// (3)</span>
</span><span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Specify &#8220;RequestMethod.POST&#8221; in <tt class="docutils literal"><span class="pre">method</span></tt> attribute and &#8220;confirm&#8221; in <tt class="docutils literal"><span class="pre">params</span></tt> attribute.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>In case of input validation errors, it is recommended to call the processing method of form re-display.</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td>Return view-name of JSP to render the screen for user input confirmation.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">POST method is specified to prevent displaying confidential information such as password and other personal information etc. in the address bar.
(Needless to say that these security measures not sufficient and needs more secure measures such as SSL etc.)</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Example of implementation of sections other than processing method is explained below.</p>
<p>Besides implementing processing method for user input confirmation screen, points mentioned below are required.</p>
<ul class="simple">
<li>Implement view of user-input confirmation screen. Refer to <a class="reference internal" href="#view"><em>Implementing View</em></a> for the details of view.</li>
</ul>
<p>Create  the view (JSP) for user input confirmation screen.</p>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="nt">&lt;h1&gt;</span>Abc Create Form<span class="nt">&lt;/h1&gt;</span>
<span class="nt">&lt;form:form</span> <span class="na">modelAttribute=</span><span class="s">&quot;abcForm&quot;</span>
  <span class="na">action=</span><span class="s">&quot;${pageContext.request.contextPath}/abc/create&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;input1&quot;</span><span class="nt">&gt;</span>Input1<span class="nt">&lt;/form:label&gt;</span>
  ${f:h(abcForm.input1)}
<span class="hll">  <span class="nt">&lt;form:hidden</span> <span class="na">path=</span><span class="s">&quot;input1&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (1) --&gt;</span>
</span>  <span class="nt">&lt;br&gt;</span>
  <span class="nt">&lt;form:label</span> <span class="na">path=</span><span class="s">&quot;input2&quot;</span><span class="nt">&gt;</span>Input2<span class="nt">&lt;/form:label&gt;</span>
  ${f:h(abcForm.input2)}
<span class="hll">  <span class="nt">&lt;form:hidden</span> <span class="na">path=</span><span class="s">&quot;input2&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (1) --&gt;</span>
</span>  <span class="nt">&lt;br&gt;</span>
<span class="hll">  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">name=</span><span class="s">&quot;redo&quot;</span> <span class="na">value=</span><span class="s">&quot;Back&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (2) --&gt;</span>
</span><span class="hll">  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">value=</span><span class="s">&quot;Create&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (3) --&gt;</span>
</span><span class="nt">&lt;/form:form&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>The values entered on form screen is set as the hidden fields of HTML form since they must be sent back to the server when Create or Back buttons are clicked.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Specify ``name=&#8221;redo&#8221;<a href="#id7"><span class="problematic" id="id8">``</span></a>parameter for submit button to return to form screen.</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td>Parameter name need not be specified for submit button. Submit button will do the actual create operation.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In the above example, HTML escaping is performed as an XSS countermeasure using <tt class="docutils literal"><span class="pre">f:h()</span></tt> function while displaying the user input values.
For details, refer to <tt class="xref doc docutils literal"><span class="pre">Cross</span> <span class="pre">Site</span> <span class="pre">Scripting</span></tt>.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>The operations are explained below.</p>
<div class="line-block">
<div class="line">Send the request for displaying user input confirmation.</div>
<div class="line">Enter <tt class="docutils literal"><span class="pre">&quot;aa&quot;</span></tt> in Input1 and <tt class="docutils literal"><span class="pre">&quot;5&quot;</span></tt> in Input2 and click Confirm button on form screen.</div>
<div class="line">After clicking Confirm button, <tt class="docutils literal"><span class="pre">&quot;abc/create?confirm&quot;</span></tt> URI gets accessed using POST method.</div>
<div class="line">Since HTTP parameter <tt class="docutils literal"><span class="pre">confirm</span></tt> is present in the URI, <tt class="docutils literal"><span class="pre">createConfirm</span></tt> method of controller is called and user input confirmation screen is displayed.</div>
</div>
<blockquote>
<div><div class="figure">
<a class="reference internal image-reference" href="../_images/applicationCreateConfirmDisplay.png"><img alt="../_images/applicationCreateConfirmDisplay.png" src="../_images/applicationCreateConfirmDisplay.png" style="width: 90%;" /></a>
</div>
</div></blockquote>
<p>Since HTTP parameters are sent across through HTTP POST method after clicking the Confirm button, it does not appear in URI. However, &#8220;confirm&#8221; is included as HTTP parameter.</p>
<blockquote>
<div><div class="figure">
<a class="reference internal image-reference" href="../_images/applicationCreateConfirmNetwork.png"><img alt="../_images/applicationCreateConfirmNetwork.png" src="../_images/applicationCreateConfirmNetwork.png" style="width: 90%;" /></a>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="implementing-redisplay-of-form">
<span id="controller-mapping-policy-sampleapp-redo-impl-label"></span><h4><a class="toc-backref" href="#id41">4.3.1.3.6. Implementing &#8216;redisplay of form&#8217;</a><a class="headerlink" href="#implementing-redisplay-of-form" title="Permalink to this headline">¶</a></h4>
<p>&#8220;redo&#8221; is specified as HTTP parameter to indicate that form needs to be redisplayed.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;redo&quot;</span><span class="o">)</span> <span class="c1">// (1)</span>
</span><span class="kd">public</span> <span class="n">String</span> <span class="nf">createRedo</span><span class="o">(</span><span class="n">AbcForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// ommited</span>
<span class="hll">    <span class="k">return</span> <span class="s">&quot;abc/createForm&quot;</span><span class="o">;</span> <span class="c1">// (2)</span>
</span><span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Specify &#8220;RequestMethod.POST&#8221; in <tt class="docutils literal"><span class="pre">method</span></tt> attribute and &#8220;redo&#8221; in <tt class="docutils literal"><span class="pre">params</span></tt> attribute.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Return view name of JSP to render the form screen.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Operation is described below.</p>
<div class="line-block">
<div class="line">Send the request to redisplay the form screen.</div>
<div class="line">Click Back button on user input confirmation screen.</div>
<div class="line">When Back button is clicked, &#8220;abc/create?redo&#8221; URI gets accessed through HTTP POST method.</div>
<div class="line">Since &#8220;redo&#8221; HTTP parameter is present in the URI, <tt class="docutils literal"><span class="pre">createRedo</span></tt> method of controller is invoked and form screen is redisplayed.</div>
</div>
<blockquote>
<div><div class="figure">
<a class="reference internal image-reference" href="../_images/applicationCreateConfirmDisplay.png"><img alt="../_images/applicationCreateConfirmDisplay.png" src="../_images/applicationCreateConfirmDisplay.png" style="width: 90%;" /></a>
</div>
</div></blockquote>
<p>Since HTTP parameters are sent across through HTTP POST method after clicking the Back button, it does not appear in URI. However, &#8220;redo&#8221; is included as HTTP parameter.
Moreover, since input values of form had been sent as hidden fields, input values can be restored on redisplayed form screen.</p>
<blockquote>
<div><div class="figure">
<a class="reference internal image-reference" href="../_images/applicationBackToCreateFormDisplay.png"><img alt="../_images/applicationBackToCreateFormDisplay.png" src="../_images/applicationBackToCreateFormDisplay.png" style="width: 90%;" /></a>
</div>
<div class="figure">
<a class="reference internal image-reference" href="../_images/applicationBackToCreateFormNetwork.png"><img alt="../_images/applicationBackToCreateFormNetwork.png" src="../_images/applicationBackToCreateFormNetwork.png" style="width: 90%;" /></a>
</div>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>In order to implement back button functionality, setting <tt class="docutils literal"><span class="pre">onclick=&quot;javascript:history.back()&quot;</span></tt> is also one of the ways.
Both the methods differ in the following ways. Appropriate method must be selected as per requirement.</p>
<ul class="last simple">
<li>Behavior when &#8220;Back button on browser&#8221; is clicked.</li>
<li>Behavior when page having Back button is accessed and Back button is clicked.</li>
<li>History of browser</li>
</ul>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="implementing-create-new-user-business-logic">
<span id="controller-mapping-policy-sampleapp-create-impl-label"></span><h4><a class="toc-backref" href="#id42">4.3.1.3.7. Implementing &#8216;create new user&#8217; business logic</a><a class="headerlink" href="#implementing-create-new-user-business-logic" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">To register input contents of form, the data (hidden parameters) to be registered is sent with HTTP POST method.</div>
<div class="line">Sorting is not carried out using HTTP parameters since new request will be the main request of this operation.</div>
<div class="line">Since the state of database changes in this process, it should not be executed multiple times due to double submission.</div>
<div class="line">Therefore, it is &#8216;redirected&#8217; to the next screen (create complete screen) instead of directly displaying View (screen) after</div>
<div class="line">completing this process. This pattern is called as POST-Redirect-GET(PRG) pattern. For the details of <abbr title="Post-Redirect-Get">PRG</abbr> pattern</div>
<div class="line">refer to <a class="reference internal" href="../ArchitectureInDetail/DoubleSubmitProtection.html"><em>Double Submit Protection</em></a> .</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">)</span> <span class="c1">// (1)</span>
</span><span class="kd">public</span> <span class="n">String</span> <span class="nf">create</span><span class="o">(</span><span class="nd">@Validated</span> <span class="n">AbcForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="o">,</span> <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">())</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nf">createRedo</span><span class="o">(</span><span class="n">form</span><span class="o">,</span> <span class="n">model</span><span class="o">);</span> <span class="c1">// return &quot;abc/createForm&quot;;</span>
    <span class="o">}</span>
    <span class="c1">// ommited</span>
<span class="hll">    <span class="k">return</span> <span class="s">&quot;redirect:/abc/create?complete&quot;</span><span class="o">;</span> <span class="c1">// (2)</span>
</span><span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Specify <tt class="docutils literal"><span class="pre">RequestMethod.POST</span></tt> in <tt class="docutils literal"><span class="pre">method</span></tt> attribute. Do not specify <tt class="docutils literal"><span class="pre">params</span></tt> attribute.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Return URL to the request needs to be redirected as view name in order to use <abbr title="Post-Redirect-Get">PRG</abbr>  pattern.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It can be redirected to &#8220;/xxx&#8221; by returning &#8220;redirect:/xxx&#8221; as view name.</p>
</div>
</div></blockquote>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">PRG pattern is used to avoid double submission when the browser gets reloaded by clicking F5 button. However, as a countermeasure for double submission,
it is necessary to use TransactionTokenCheck functionality.
For details of TransactionTokenCheck, refer to <a class="reference internal" href="../ArchitectureInDetail/DoubleSubmitProtection.html"><em>Double Submit Protection</em></a> .</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Operation is described below.</p>
<div class="line-block">
<div class="line">Click &#8216;Create&#8217; button on input confirmation screen.</div>
<div class="line">After clicking &#8216;Create&#8217; button,  <tt class="docutils literal"><span class="pre">&quot;abc/create&quot;</span></tt> URL is accessed through POST method.</div>
<div class="line">Since HTTP parameters are not sent for identifying a button, it is considered as main request of Entity create process and &#8216;create&#8217; method of Controller is invoked.</div>
</div>
<div class="line-block">
<div class="line">&#8216;Create&#8217; request does not return to the screen directly, but it is redirected to create complete display (<tt class="docutils literal"><span class="pre">&quot;/abc/create?complete&quot;</span></tt>). Hence HTTP status is changed to 302.</div>
</div>
<blockquote>
<div><div class="figure">
<a class="reference internal image-reference" href="../_images/applicationCreateNetwork.png"><img alt="../_images/applicationCreateNetwork.png" src="../_images/applicationCreateNetwork.png" style="width: 90%;" /></a>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="implementing-notification-of-create-new-user-process-completion">
<span id="controller-mapping-policy-sampleapp-complete-impl-label"></span><h4><a class="toc-backref" href="#id43">4.3.1.3.8. Implementing notification of create new user process completion</a><a class="headerlink" href="#implementing-notification-of-create-new-user-process-completion" title="Permalink to this headline">¶</a></h4>
<p>In order to notify the completion of create process, <tt class="docutils literal"><span class="pre">complete</span></tt> must be present in the request as HTTP parameter.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;complete&quot;</span><span class="o">)</span> <span class="c1">// (1)</span>
</span><span class="kd">public</span> <span class="n">String</span> <span class="nf">createComplete</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ommited</span>
<span class="hll">    <span class="k">return</span> <span class="s">&quot;abc/createComplete&quot;</span><span class="o">;</span> <span class="c1">// (2)</span>
</span><span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Specify <tt class="docutils literal"><span class="pre">&quot;complete&quot;</span></tt> in <tt class="docutils literal"><span class="pre">params</span></tt> attribute.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Return View name of JSP to render the create completion screen.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In this processing method, <tt class="docutils literal"><span class="pre">method</span></tt> attribute is not specified since it is not required for HTTP GET method.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Operation is described below.</p>
<div class="line-block">
<div class="line">After completing creation of user, access URI (<tt class="docutils literal"><span class="pre">&quot;/abc/create?complete&quot;</span></tt>) is specified as redirect destination.</div>
<div class="line">Since HTTP parameter is <tt class="docutils literal"><span class="pre">complete</span></tt>, createComplete() method of controller is called and create completion screen is displayed.</div>
</div>
<blockquote>
<div><div class="figure">
<a class="reference internal image-reference" href="../_images/applicationCreateCompleteDisplay.png"><img alt="../_images/applicationCreateCompleteDisplay.png" src="../_images/applicationCreateCompleteDisplay.png" style="width: 90%;" /></a>
</div>
<div class="figure">
<a class="reference internal image-reference" href="../_images/applicationCreateCompleteNetwork.png"><img alt="../_images/applicationCreateCompleteNetwork.png" src="../_images/applicationCreateCompleteNetwork.png" style="width: 90%;" /></a>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Since PRG pattern is used, even if browser is reloaded, create completion screen is only re-displayed without re-executing create process.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="placing-multiple-buttons-on-html-form">
<span id="controller-mapping-policy-sampleapp-multi-impl-label"></span><h4><a class="toc-backref" href="#id44">4.3.1.3.9. Placing multiple buttons on HTML form</a><a class="headerlink" href="#placing-multiple-buttons-on-html-form" title="Permalink to this headline">¶</a></h4>
<p>To place multiple buttons on a single form, send HTTP parameter to identify the corresponding button and and so that the processing method of controller can be switched.
An example of Create button and Back button on input confirmation screen of sample application is explained here.</p>
<p>&#8216;Create&#8217; button to perform &#8216;user creation&#8217; and &#8216;Back&#8217; button to redisplay &#8216;create form&#8217; exists on the form of input confirmation screen as shown below.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/applicationControllerBackToForm.png"><img alt="Multiple button in the HTML form" src="../_images/applicationControllerBackToForm.png" style="width: 80%;" /></a>
<p class="caption"><strong>Picture - Multiple button in the HTML form</strong></p>
</div>
<p>To redisplay &#8216;create form&#8217; using request ( <tt class="docutils literal"><span class="pre">&quot;/abc/create?redo&quot;</span></tt> ) when Back button is clicked,
the following code is required in HTML form.</p>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="hll"><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">name=</span><span class="s">&quot;redo&quot;</span> <span class="na">value=</span><span class="s">&quot;Back&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (1) --&gt;</span>
</span><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">value=</span><span class="s">&quot;Create&quot;</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>In input confirmation screen ( <tt class="docutils literal"><span class="pre">&quot;abc/createConfirm.jsp&quot;</span></tt> ), specify <tt class="docutils literal"><span class="pre">name=&quot;redo&quot;</span></tt>parameter for Back button.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>For the operations when Back button is clicked, refer to <a class="reference internal" href="#controller-mapping-policy-sampleapp-redo-impl-label"><em>Implementing &#8216;redisplay of form&#8217;</em></a>.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="source-code-of-controller-of-sample-application">
<span id="controller-mapping-policy-sampleapp-all-impl-label"></span><h4><a class="toc-backref" href="#id45">4.3.1.3.10. Source code of controller of sample application</a><a class="headerlink" href="#source-code-of-controller-of-sample-application" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">Source-code of controller after implementing create process of sample application are shown below.</div>
<div class="line">Fetching list of Entities, Fetching detail of Entity, Entity update, Entity delete are implemented using the same guidelines.</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;abc&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">AbcController</span> <span class="o">{</span>

    <span class="nd">@ModelAttribute</span>
    <span class="kd">public</span> <span class="n">AbcForm</span> <span class="nf">setUpAbcForm</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">AbcForm</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="c1">// Handling request of &quot;/abc/create?form&quot;</span>
    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;form&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">createForm</span><span class="o">(</span><span class="n">AbcForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// ommited</span>
        <span class="k">return</span> <span class="s">&quot;abc/createForm&quot;</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// Handling request of &quot;POST /abc/create?confirm&quot;</span>
    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;confirm&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">createConfirm</span><span class="o">(</span><span class="nd">@Validated</span> <span class="n">AbcForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="o">,</span>
            <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">return</span> <span class="nf">createRedo</span><span class="o">(</span><span class="n">form</span><span class="o">,</span> <span class="n">model</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="c1">// ommited</span>
        <span class="k">return</span> <span class="s">&quot;abc/createConfirm&quot;</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// Handling request of &quot;POST /abc/create?redo&quot;</span>
    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;redo&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">createRedo</span><span class="o">(</span><span class="n">AbcForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// ommited</span>
        <span class="k">return</span> <span class="s">&quot;abc/createForm&quot;</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// Handling request of &quot;POST /abc/create&quot;</span>
    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">method</span> <span class="o">=</span> <span class="n">RequestMethod</span><span class="o">.</span><span class="na">POST</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">create</span><span class="o">(</span><span class="nd">@Validated</span> <span class="n">AbcForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="o">,</span> <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">())</span> <span class="o">{</span>
            <span class="k">return</span> <span class="nf">createRedo</span><span class="o">(</span><span class="n">form</span><span class="o">,</span> <span class="n">model</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="c1">// ommited</span>
        <span class="k">return</span> <span class="s">&quot;redirect:/abc/create?complete&quot;</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// Handling request of &quot;/abc/create?complete&quot;</span>
    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;create&quot;</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;complete&quot;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">createComplete</span><span class="o">()</span> <span class="o">{</span>
        <span class="c1">// ommited</span>
        <span class="k">return</span> <span class="s">&quot;abc/createComplete&quot;</span><span class="o">;</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="regarding-arguments-of-processing-method">
<span id="controller-method-argument-label"></span><h3><a class="toc-backref" href="#id46">4.3.1.4. Regarding arguments of processing method</a><a class="headerlink" href="#regarding-arguments-of-processing-method" title="Permalink to this headline">¶</a></h3>
<p>The arguments of processing method can be used to fetch various values <a class="reference external" href="http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/mvc.html#mvc-ann-arguments">http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/mvc.html#mvc-ann-arguments</a>
However, as a principle rule, the following must be not be fetched using arguments of processing method of controller.</p>
<ul class="simple">
<li>ServletRequest</li>
<li>HttpServletRequest</li>
<li>org.springframework.web.context.request.WebRequest</li>
<li>org.springframework.web.context.request.NativeWebRequest</li>
<li>java.io.InputStream</li>
<li>java.io.Reader</li>
<li>java.io.OutputStream</li>
<li>java.io.Writer</li>
<li>java.util.Map</li>
<li>org.springframework.ui.ModelMap</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>When generalized values like HttpServletRequest, getAttribute/setAttribute of HttpSession and get/put of Map are allowed, liberal use of these can degrade the maintainability of
the project with an increase in project size.</p>
<p class="last">When common parameters (request parameters) need to be stored in JavaBean and passed as an argument to a method of controller,
it can be implemented using <a class="reference internal" href="#methodargumentresolver"><em>Implementing HandlerMethodArgumentResolver</em></a> as described later.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Arguments depending on the purpose of usage are described below.</p>
<ul class="simple">
<li><a class="reference internal" href="#controller-method-argument-model-label"><em>Passing data to screen (View)</em></a></li>
<li><a class="reference internal" href="#controller-method-argument-pathvariable-label"><em>Retrieving values from URL path</em></a></li>
<li><a class="reference internal" href="#controller-method-argument-requestparam-label"><em>Retrieving request parameters individually</em></a></li>
<li><a class="reference internal" href="#controller-method-argument-form-label"><em>Retrieving request parameters collectively</em></a></li>
<li><a class="reference internal" href="#controller-method-argument-validation-label"><em>Performing input validation</em></a></li>
<li><a class="reference internal" href="#controller-method-argument-redirectattributes-label"><em>Passing data while redirecting request</em></a></li>
<li><a class="reference internal" href="#controller-method-argument-redirectattributes-param-label"><em>Passing request parameters to redirect destination</em></a></li>
<li><a class="reference internal" href="#controller-method-argument-redirectattributes-path-label"><em>Inserting values in redirect destination URL path</em></a></li>
<li><a class="reference internal" href="#controller-method-argument-cookievalue-label"><em>Acquiring values from Cookie</em></a></li>
<li><a class="reference internal" href="#controller-method-argument-cookiewrite-label"><em>Writing values in Cookie</em></a></li>
<li><a class="reference internal" href="#controller-method-argument-pagination-label"><em>Retrieving pagination information</em></a></li>
<li><a class="reference internal" href="#controller-method-argument-upload-label"><em>Retrieving uploaded file</em></a></li>
<li><a class="reference internal" href="#controller-method-argument-message-label"><em>Displaying result message on the screen</em></a></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="passing-data-to-screen-view">
<span id="controller-method-argument-model-label"></span><h4><a class="toc-backref" href="#id47">4.3.1.4.1. Passing data to screen (View)</a><a class="headerlink" href="#passing-data-to-screen-view" title="Permalink to this headline">¶</a></h4>
<p>To pass data to be displayed on screen (View), fetch <tt class="docutils literal"><span class="pre">org.springframework.ui.Model</span></tt>(Hereafter called as <tt class="docutils literal"><span class="pre">Model</span></tt>) as argument of processing method and
add the data (Object) to <tt class="docutils literal"><span class="pre">Model</span></tt>object.</p>
<ul class="simple">
<li>SampleController.java</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="hll"><span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">(</span><span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// (1)</span>
</span><span class="hll">    <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">,</span> <span class="s">&quot;Hello World!&quot;</span><span class="o">);</span> <span class="c1">// (2)</span>
</span><span class="hll">    <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="k">new</span> <span class="n">HelloBean</span><span class="o">(</span><span class="s">&quot;Bean Hello World!&quot;</span><span class="o">));</span> <span class="c1">// (3)</span>
</span>    <span class="k">return</span> <span class="s">&quot;sample/hello&quot;</span><span class="o">;</span> <span class="c1">// returns view name</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>hello.jsp</li>
</ul>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="hll">Message : ${f:h(hello)}<span class="nt">&lt;br&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">4</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span><span class="hll">Message : ${f:h(helloBean.message)}<span class="nt">&lt;br&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">5</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span></pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>HTML of created by View(hello.jsp)</li>
</ul>
<blockquote>
<div><div class="highlight-html"><div class="highlight"><pre><span class="hll">Message : Hello World!<span class="nt">&lt;br&gt;</span> <span class="c">&lt;!-- (6) --&gt;</span>
</span><span class="hll">Message : Bean Hello World!<span class="nt">&lt;br&gt;</span> <span class="c">&lt;!-- (6) --&gt;</span>
</span></pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Fetch <tt class="docutils literal"><span class="pre">Model</span></tt>object as argument.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Call <tt class="docutils literal"><span class="pre">addAttribute</span></tt>method of <tt class="docutils literal"><span class="pre">Model</span></tt>object received as argument, and add the data to <tt class="docutils literal"><span class="pre">Model</span></tt>object.</div>
<div class="line">For example, <tt class="docutils literal"><span class="pre">&quot;HelloWorld!&quot;</span></tt> string is added to the attribute name <tt class="docutils literal"><span class="pre">&quot;hello&quot;</span></tt>.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">If first argument of <tt class="docutils literal"><span class="pre">addAttribute</span></tt>method is omitted, the class name beginning with lower case letter will become the attribute name.</div>
<div class="line">For example, the result of <tt class="docutils literal"><span class="pre">model.addAttribute(&quot;helloBean&quot;,</span> <span class="pre">new</span> <span class="pre">HelloBean());</span></tt> is same as the result of <tt class="docutils literal"><span class="pre">model.addAttribute(new</span> <span class="pre">HelloBean());</span></tt></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">In View (JSP), it is possible to acquire the data added to <tt class="docutils literal"><span class="pre">Model</span></tt>object by specifying &#8220;${Attribute name}&#8221;.</div>
<div class="line">For example, HTML escaping is performed using  &#8220;${f:h(Attribute name)}&#8221; function of EL expression.</div>
<div class="line">For details of functions of EL expression that perform HTML escaping, refer to <a class="reference internal" href="../Security/XSS.html"><em>Cross Site Scripting</em></a>.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">The values of JavaBean stored in <tt class="docutils literal"><span class="pre">Model</span></tt>can be acquired by specifying &#8220;${Attribute name.property name}&#8221;.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">JSP is output in HTML format.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Even though the <tt class="docutils literal"><span class="pre">Model</span></tt>is not used, it can be specified as an argument. Even if it is not required at the initial stage of implementation,
it can be used later (so that the signature of methods need not be changed in future).</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The value can also be referred from the module which is not managed under Spring MVC (for example, ServletFilter, etc.) since
<tt class="docutils literal"><span class="pre">addAttribute</span></tt> in  <tt class="docutils literal"><span class="pre">Model</span></tt> performs a <tt class="docutils literal"><span class="pre">setAttribute</span></tt> in <tt class="docutils literal"><span class="pre">HttpServletRequest</span></tt>.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="retrieving-values-from-url-path">
<span id="controller-method-argument-pathvariable-label"></span><h4><a class="toc-backref" href="#id48">4.3.1.4.2. Retrieving values from URL path</a><a class="headerlink" href="#retrieving-values-from-url-path" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">To retrieve values from URL path, add <tt class="docutils literal"><span class="pre">&#64;PathVariable</span></tt>annotation to argument of processing method of controller.</div>
<div class="line">In order to retrieve values from the path using <tt class="docutils literal"><span class="pre">&#64;PathVariable</span></tt>annotation, value of <tt class="docutils literal"><span class="pre">&#64;RequestMapping</span></tt>annotation must contain those values in the form of variables (for example, {id}).</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;hello/{id}/{version}&quot;</span><span class="o">)</span> <span class="c1">// (1)</span>
</span><span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">(</span>
<span class="hll">        <span class="nd">@PathVariable</span><span class="o">(</span><span class="s">&quot;id&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">id</span><span class="o">,</span> <span class="c1">// (2)</span>
</span><span class="hll">        <span class="nd">@PathVariable</span> <span class="n">Integer</span> <span class="n">version</span><span class="o">,</span> <span class="c1">// (3)</span>
</span>        <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// do something</span>
    <span class="k">return</span> <span class="s">&quot;sample/hello&quot;</span><span class="o">;</span> <span class="c1">// returns view name</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify the portion to be extracted as path variable in the value of <tt class="docutils literal"><span class="pre">&#64;RequestMapping</span></tt>annotation. Specify path variable in &#8220;{variable name}&#8221; format.</div>
<div class="line">For example, 2 path variables such as  <tt class="docutils literal"><span class="pre">&quot;id&quot;</span></tt> and <tt class="docutils literal"><span class="pre">&quot;version&quot;</span></tt> are specified.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify variable name of path variable in <tt class="docutils literal"><span class="pre">&#64;PathVariable</span></tt>annotation.</div>
<div class="line">For example, when the URL <tt class="docutils literal"><span class="pre">&quot;sample/hello/aaaa/1&quot;</span></tt> is accessed, the string <tt class="docutils literal"><span class="pre">&quot;aaaa&quot;</span></tt> is passed to argument &#8220;id&#8221;.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first line-block">
<div class="line">Value attribute of <tt class="docutils literal"><span class="pre">&#64;PathVariable</span></tt>annotation can be omitted. When it is omitted, the argument name is considered as the request parameter name.</div>
<div class="line">For example, when the URL <tt class="docutils literal"><span class="pre">&quot;sample/hello/aaaa/1&quot;</span></tt> is accessed, value <tt class="docutils literal"><span class="pre">&quot;1&quot;</span></tt> is passed to argument &#8220;version&#8221;.</div>
<div class="line">However, if value attribute is omitted,</div>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">-g</span></tt> option (mode for generate debug information)</li>
<li>Java8&#8217;s <tt class="docutils literal"><span class="pre">-parameters</span></tt> option (mode for generate metadata of the reflection on the method parameters)</li>
</ul>
<p class="last">there is a need to compile with specifying either.</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Binding argument can be of any data type other than string. In case of different data type, <tt class="docutils literal"><span class="pre">org.springframework.beans.TypeMismatchException</span></tt>is thrown and default response is 400 (Bad Request).
For example, when the URL <tt class="docutils literal"><span class="pre">&quot;sample/hello/aaaa/v1&quot;</span></tt> is accessed, an exception is thrown since <tt class="docutils literal"><span class="pre">&quot;v1&quot;</span></tt> cannot be converted into Integer type.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">When omitting the value attribute of <tt class="docutils literal"><span class="pre">&#64;PathVariable</span></tt>annotation, the application to be deployed must be compiled with <tt class="docutils literal"><span class="pre">-g</span></tt> option or Java8&#8217;s <tt class="docutils literal"><span class="pre">-parameters</span></tt> option.
Compiling with those option has possibility of an impact on memory and performance, since information or processing required for debugging is inserted to the class after compiling.
Basically, explicitly specifying the value attribute is recommended.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="retrieving-request-parameters-individually">
<span id="controller-method-argument-requestparam-label"></span><h4><a class="toc-backref" href="#id49">4.3.1.4.3. Retrieving request parameters individually</a><a class="headerlink" href="#retrieving-request-parameters-individually" title="Permalink to this headline">¶</a></h4>
<p>To retrieve request parameters individually, add <tt class="docutils literal"><span class="pre">&#64;RequestParam</span></tt>annotation to argument.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;bindRequestParams&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">bindRequestParams</span><span class="o">(</span>
<span class="hll">        <span class="nd">@RequestParam</span><span class="o">(</span><span class="s">&quot;id&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">id</span><span class="o">,</span> <span class="c1">// (1)</span>
</span><span class="hll">        <span class="nd">@RequestParam</span> <span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="c1">// (2)</span>
</span><span class="hll">        <span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;age&quot;</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span> <span class="n">Integer</span> <span class="n">age</span><span class="o">,</span> <span class="c1">// (3)</span>
</span><span class="hll">        <span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;genderCode&quot;</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span> <span class="n">defaultValue</span> <span class="o">=</span> <span class="s">&quot;unknown&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">genderCode</span><span class="o">,</span> <span class="c1">// (4)</span>
</span>        <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// do something</span>
    <span class="k">return</span> <span class="s">&quot;sample/hello&quot;</span><span class="o">;</span> <span class="c1">// returns view name</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify request parameter name in the value attribute of <tt class="docutils literal"><span class="pre">&#64;RequestParam</span></tt>annotation.</div>
<div class="line">For example, when the URL <tt class="docutils literal"><span class="pre">&quot;sample/hello?id=aaaa&quot;</span></tt> is accessed, the string <tt class="docutils literal"><span class="pre">&quot;aaaa&quot;</span></tt> is passed to argument &#8220;id&#8221;.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first line-block">
<div class="line">value attribute of <tt class="docutils literal"><span class="pre">&#64;RequestParam</span></tt>annotation can be omitted. When it is omitted, the argument name becomes the request parameter name.</div>
<div class="line">For example, when the URL <tt class="docutils literal"><span class="pre">&quot;sample/hello?name=bbbb&amp;....&quot;</span></tt> is accessed, string <tt class="docutils literal"><span class="pre">&quot;bbbb&quot;</span></tt> is passed to argument &#8220;name&#8221;.</div>
<div class="line">However, if value attribute is omitted,</div>
</div>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">-g</span></tt> option (mode for generate debug information)</li>
<li>Java8&#8217;s <tt class="docutils literal"><span class="pre">-parameters</span></tt> option (mode for generate metadata of the reflection on the method parameters)</li>
</ul>
<p class="last">there is a need to compile with specifying either.</p>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">By default, an error occurs if the specified request parameter does not exist. When request parameter is not required, specify <tt class="docutils literal"><span class="pre">false</span></tt> in the <tt class="docutils literal"><span class="pre">required</span></tt> attribute.</div>
<div class="line">For example, when it is accessed where request parameter <tt class="docutils literal"><span class="pre">age</span></tt> does not exist, <tt class="docutils literal"><span class="pre">null</span></tt>is passed to argument &#8220;age&#8221;.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When default value is to be used if the specified request parameter does not exist, specify the default value in defaultValue attribute.</div>
<div class="line">For example, when it is accessed where request parameter <tt class="docutils literal"><span class="pre">genderCode</span></tt> does not exist, <tt class="docutils literal"><span class="pre">&quot;unknown&quot;</span></tt> is passed to argument &#8220;genderCode&#8221;.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When it is accessed without specifying mandatory parameters, <tt class="docutils literal"><span class="pre">org.springframework.web.bind.MissingServletRequestParameterException</span></tt>is thrown and default operation is responded with 400 (Bad Request).
However, when defaultValue attribute is specified, the value specified in defaultValue attribute is passed without throwing exception.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Binding argument can be of any data type. In case the data type do not match, <tt class="docutils literal"><span class="pre">org.springframework.beans.TypeMismatchException</span></tt>is thrown and default response is 400 (Bad Request).
For example, when <tt class="docutils literal"><span class="pre">&quot;sample/hello?age=aaaa&amp;...&quot;</span></tt> URL is accessed, exception is thrown since <tt class="docutils literal"><span class="pre">aaaa</span></tt> cannot be converted into Integer.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>Binding to form object must be done only when any of the following conditions are met.</strong></p>
<ul class="simple">
<li>If request parameter is an item in the HTML form.</li>
<li>If request parameter is not an item in HTML form, however, input validation other than mandatory check needs to be performed.</li>
<li>If error details of input validation error needs to be output for each parameter.</li>
<li>If there are 3 or more request parameters. (maintenance and readability point of view)</li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="retrieving-request-parameters-collectively">
<span id="controller-method-argument-form-label"></span><h4><a class="toc-backref" href="#id50">4.3.1.4.4. Retrieving request parameters collectively</a><a class="headerlink" href="#retrieving-request-parameters-collectively" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">Use form object to collectively fetch all the request parameters.</div>
<div class="line">Form object is JavaBean representing HTML form. For the details of form object, refer to <a class="reference internal" href="#formobject"><em>Implementing form object</em></a>.</div>
</div>
<p>Following is an example that shows the difference between processing method that fetches each request parameter using <tt class="docutils literal"><span class="pre">&#64;RequestParam</span></tt> and the same processing method when fetching request parameters in a form object</p>
<p>Processing method that receives request parameter separately using <tt class="docutils literal"><span class="pre">&#64;RequestParam</span></tt> is as shown below.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;bindRequestParams&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">bindRequestParams</span><span class="o">(</span>
        <span class="nd">@RequestParam</span><span class="o">(</span><span class="s">&quot;id&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">id</span><span class="o">,</span>
        <span class="nd">@RequestParam</span> <span class="n">String</span> <span class="n">name</span><span class="o">,</span>
        <span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;age&quot;</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span> <span class="n">Integer</span> <span class="n">age</span><span class="o">,</span>
        <span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;genderCode&quot;</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span> <span class="n">defaultValue</span> <span class="o">=</span> <span class="s">&quot;unknown&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">genderCode</span><span class="o">,</span>
        <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// do something</span>
    <span class="k">return</span> <span class="s">&quot;sample/hello&quot;</span><span class="o">;</span> <span class="c1">// returns view name</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line">Create form object class</div>
<div class="line">For jsp of HTML form corresponding to this form object, refer to <a class="reference internal" href="#formobjectjsp"><em>Binding to HTML form</em></a>.</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleForm</span> <span class="kd">implements</span> <span class="n">Serializable</span><span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1477614498217715937L</span><span class="o">;</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">age</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">genderCode</span><span class="o">;</span>

    <span class="c1">// omit setters and getters</span>

<span class="o">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>Request parameter name should match with form object property name.</strong></p>
<dl class="docutils">
<dt>When parameters <tt class="docutils literal"><span class="pre">&quot;id=aaa&amp;name=bbbb&amp;age=19&amp;genderCode=men?tel=01234567&quot;</span></tt> are sent to the above form object,</dt>
<dd>the values of <tt class="docutils literal"><span class="pre">id</span></tt> , <tt class="docutils literal"><span class="pre">name</span></tt> , <tt class="docutils literal"><span class="pre">age</span></tt> , <tt class="docutils literal"><span class="pre">genderCode</span></tt> matching with the property name, are stored, however <tt class="docutils literal"><span class="pre">tel</span></tt> is not included in form object, as it does not have matching property name.</dd>
</dl>
<p class="last">Make changes such that request parameters which were being fetched individually using <tt class="docutils literal"><span class="pre">&#64;RequestParam</span></tt> now get fetched as form object.</p>
</div>
<div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;bindRequestParams&quot;</span><span class="o">)</span>
<span class="hll"><span class="kd">public</span> <span class="n">String</span> <span class="nf">bindRequestParams</span><span class="o">(</span><span class="nd">@Validated</span> <span class="n">SampleForm</span> <span class="n">form</span><span class="o">,</span> <span class="c1">// (1)</span>
</span>        <span class="n">BindingResult</span> <span class="n">result</span><span class="o">,</span>
        <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// do something</span>
    <span class="k">return</span> <span class="s">&quot;sample/hello&quot;</span><span class="o">;</span> <span class="c1">// returns view name</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Receive <tt class="docutils literal"><span class="pre">SampleForm</span></tt>object as argument.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When form object is used as argument, unlike <tt class="docutils literal"><span class="pre">&#64;RequestParam</span></tt>,
mandatory check is not performed. ** When using form object, ** <a class="reference internal" href="#controller-method-argument-validation-label"><em>Performing input validation</em></a> ** should be performed as described below <a href="#id9"><span class="problematic" id="id10">**</span></a>.</p>
</div>
</div></blockquote>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Domain objects such as Entity, etc. can also be used as form object without any changes required.
However, the parameters such as password for confirmation, agreement confirmation checkbox, etc. should exist only on WEB screen.
Since the fields depending on such screen items should not be added to domain objects, it is recommended to create class for form object separate from domain object.
When a domain object needs to be created from request parameters, values must first be received in form object and then copied to domain object from form object.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="performing-input-validation">
<span id="controller-method-argument-validation-label"></span><h4><a class="toc-backref" href="#id51">4.3.1.4.5. Performing input validation</a><a class="headerlink" href="#performing-input-validation" title="Permalink to this headline">¶</a></h4>
<p>When performing input validation for the form object, add <tt class="docutils literal"><span class="pre">&#64;Validated</span></tt>annotation to form object argument, and specify <tt class="docutils literal"><span class="pre">org.springframework.validation.BindingResult</span></tt>(Hereafter
called as <tt class="docutils literal"><span class="pre">BindingResult</span></tt>) to argument immediately after form object argument.</p>
<p>Refer to <a class="reference internal" href="../ArchitectureInDetail/Validation.html"><em>Input Validation</em></a>  for the details of input validation.</p>
<p>Add annotations required in input validation to the fields of form object class.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleForm</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1477614498217715937L</span><span class="o">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">10</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">10</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">id</span><span class="o">;</span>

    <span class="nd">@NotNull</span>
    <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">10</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="nd">@Min</span><span class="o">(</span><span class="mi">1</span><span class="o">)</span>
    <span class="nd">@Max</span><span class="o">(</span><span class="mi">100</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">age</span><span class="o">;</span>

    <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">1</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">10</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">genderCode</span><span class="o">;</span>

    <span class="c1">// omit setters and getters</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line">Add <tt class="docutils literal"><span class="pre">&#64;Validated</span></tt>annotation to form object argument.</div>
<div class="line">Input validation is performed for the argument with <tt class="docutils literal"><span class="pre">&#64;Validated</span></tt> annotation before the processing method of controller is executed. The check result is stored in the argument <tt class="docutils literal"><span class="pre">BindingResult</span></tt> which immediately follows form object argument.</div>
<div class="line">The type conversion error that occurs when a data-type other than String is specified in form object, is also stored in <tt class="docutils literal"><span class="pre">BindingResult</span></tt>.</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;bindRequestParams&quot;</span><span class="o">)</span>
<span class="hll"><span class="kd">public</span> <span class="n">String</span> <span class="nf">bindRequestParams</span><span class="o">(</span><span class="nd">@Validated</span> <span class="n">SampleForm</span> <span class="n">form</span><span class="o">,</span> <span class="c1">// (1)</span>
</span><span class="hll">        <span class="n">BindingResult</span> <span class="n">result</span><span class="o">,</span> <span class="c1">// (2)</span>
</span>        <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
<span class="hll">    <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">())</span> <span class="o">{</span> <span class="c1">// (3)</span>
</span>        <span class="k">return</span> <span class="s">&quot;sample/input&quot;</span><span class="o">;</span> <span class="c1">// back to the input view</span>
    <span class="o">}</span>
    <span class="c1">// do something</span>
    <span class="k">return</span> <span class="s">&quot;sample/hello&quot;</span><span class="o">;</span> <span class="c1">// returns view name</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Add <tt class="docutils literal"><span class="pre">&#64;Validated</span></tt>annotation to <tt class="docutils literal"><span class="pre">SampleForm</span></tt>argument, and mark it as target for input validation.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Specify <tt class="docutils literal"><span class="pre">BindingResult</span></tt> in the argument where input validation result is stored.</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td>Check if input validation error exists. If there is an error, <tt class="docutils literal"><span class="pre">true</span></tt> is returned.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="passing-data-while-redirecting-request">
<span id="controller-method-argument-redirectattributes-label"></span><h4><a class="toc-backref" href="#id52">4.3.1.4.6. Passing data while redirecting request</a><a class="headerlink" href="#passing-data-while-redirecting-request" title="Permalink to this headline">¶</a></h4>
<p>To redirect after executing a processing method ofcontroller and to pass data along with it, fetch <tt class="docutils literal"><span class="pre">org.springframework.web.servlet.mvc.support.RedirectAttributes</span></tt>(Henceforth called as <tt class="docutils literal"><span class="pre">RedirectAttributes</span></tt>) as an argument of processing method,
and add the data to <tt class="docutils literal"><span class="pre">RedirectAttributes</span></tt> object.</p>
<ul class="simple">
<li>SampleController.java</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="hll"><span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">(</span><span class="n">RedirectAttributes</span> <span class="n">redirectAttrs</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// (1)</span>
</span><span class="hll">    <span class="n">redirectAttrs</span><span class="o">.</span><span class="na">addFlashAttribute</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">,</span> <span class="s">&quot;Hello World!&quot;</span><span class="o">);</span> <span class="c1">// (2)</span>
</span><span class="hll">    <span class="n">redirectAttrs</span><span class="o">.</span><span class="na">addFlashAttribute</span><span class="o">(</span><span class="k">new</span> <span class="n">HelloBean</span><span class="o">(</span><span class="s">&quot;Bean Hello World!&quot;</span><span class="o">));</span> <span class="c1">// (3)</span>
</span><span class="hll">    <span class="k">return</span> <span class="s">&quot;redirect:/sample/hello?complete&quot;</span><span class="o">;</span> <span class="c1">// (4)</span>
</span><span class="o">}</span>

<span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;hello&quot;</span><span class="o">,</span> <span class="n">params</span> <span class="o">=</span> <span class="s">&quot;complete&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">helloComplete</span><span class="o">()</span> <span class="o">{</span>
<span class="hll">    <span class="k">return</span> <span class="s">&quot;sample/complete&quot;</span><span class="o">;</span> <span class="c1">// (5)</span>
</span><span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>complete.jsp</li>
</ul>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="hll">Message : ${f:h(hello)}<span class="nt">&lt;br&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">6</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span><span class="hll">Message : ${f:h(helloBean.message)}<span class="nt">&lt;br&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">7</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span></pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>HTML of created by View(complete.jsp)</li>
</ul>
<blockquote>
<div><div class="highlight-html"><div class="highlight"><pre><span class="hll">Message : Hello World!<span class="nt">&lt;br&gt;</span> <span class="c">&lt;!-- (8) --&gt;</span>
</span><span class="hll">Message : Bean Hello World!<span class="nt">&lt;br&gt;</span> <span class="c">&lt;!-- (8) --&gt;</span>
</span></pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Fetch <tt class="docutils literal"><span class="pre">RedirectAttributes</span></tt>object as argument of the processing method of controller.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Call <tt class="docutils literal"><span class="pre">addFlashAttribute</span></tt>method of <tt class="docutils literal"><span class="pre">RedirectAttributes</span></tt>and add the data to <tt class="docutils literal"><span class="pre">RedirectAttributes</span></tt>object.</div>
<div class="line">For example, the string data <tt class="docutils literal"><span class="pre">&quot;HelloWorld!&quot;</span></tt> is added to attribute name <tt class="docutils literal"><span class="pre">&quot;hello&quot;</span></tt>.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">If first argument of <tt class="docutils literal"><span class="pre">addFlashAttribute</span></tt>method is omitted, the class name beginning with lower case letter becomes the attribute name.</div>
<div class="line">For example, the result of <tt class="docutils literal"><span class="pre">model.addFlashAttribute(&quot;helloBean&quot;,</span> <span class="pre">new</span> <span class="pre">HelloBean());</span></tt> is same as <tt class="docutils literal"><span class="pre">model.addFlashAttribute(new</span> <span class="pre">HelloBean());</span></tt>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Send a redirect request to another URL which will display the next screen instead of displaying screen (View) directly.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">In the processing method after redirection, return view name of the screen that displays the data added in (2) and (3).</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">In the View (JSP) side, the data added to <tt class="docutils literal"><span class="pre">RedirectAttributes</span></tt>object can be obtained by specifying &#8220;${attribute name}&#8221;.</div>
<div class="line">For example, HTML escaping is performed using &#8220;${f:h(attribute name)}&#8221; function of EL expression.</div>
<div class="line">For the details of functions of EL expression that performs HTML escaping, refer to <a class="reference internal" href="../Security/XSS.html"><em>Cross Site Scripting</em></a>.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(7)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">The value stored in <tt class="docutils literal"><span class="pre">RedirectAttributes</span></tt>can be obtained from JavaBean by using &#8220;${Attribute name.Property name}&#8221;.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(8)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">HTML output.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The data cannot be passed to redirect destination even though it is added to <tt class="docutils literal"><span class="pre">Model</span></tt>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is similar to the <tt class="docutils literal"><span class="pre">addAttribute</span></tt>method of <tt class="docutils literal"><span class="pre">Model</span></tt>. However survival time of data differs.
In <tt class="docutils literal"><span class="pre">addFlashAttribute</span></tt>of <tt class="docutils literal"><span class="pre">RedirectAttributes</span></tt>, the data is stored in a scope called flash scope.
Data of only 1 request (G in PRG pattern) can be referred after redirect. The data from the second request onwards is deleted.</p>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/applicationFlashscope.png"><img alt="Survival time of flush scope" src="../_images/applicationFlashscope.png" style="width: 80%;" /></a>
<p class="caption"><strong>Picture - Survival time of flush scope</strong></p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="passing-request-parameters-to-redirect-destination">
<span id="controller-method-argument-redirectattributes-param-label"></span><h4><a class="toc-backref" href="#id53">4.3.1.4.7. Passing request parameters to redirect destination</a><a class="headerlink" href="#passing-request-parameters-to-redirect-destination" title="Permalink to this headline">¶</a></h4>
<p>When request parameters are to be set dynamically to redirect destination, add the values to be passed to <tt class="docutils literal"><span class="pre">RedirectAttributes</span></tt>object of argument.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">(</span><span class="n">RedirectAttributes</span> <span class="n">redirectAttrs</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">id</span> <span class="o">=</span> <span class="s">&quot;aaaa&quot;</span><span class="o">;</span>
<span class="hll">    <span class="n">redirectAttrs</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">&quot;id&quot;</span><span class="o">,</span> <span class="n">id</span><span class="o">);</span> <span class="c1">// (1)</span>
</span>    <span class="c1">// must not return &quot;redirect:/sample/hello?complete&amp;id=&quot; + id;</span>
    <span class="k">return</span> <span class="s">&quot;redirect:/sample/hello?complete&quot;</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify request parameter name in argument <tt class="docutils literal"><span class="pre">name</span> <span class="pre">and</span> <span class="pre">request</span> <span class="pre">parameter</span> <span class="pre">value</span> <span class="pre">in</span> <span class="pre">argument</span> <span class="pre">``value</span></tt> and call <tt class="docutils literal"><span class="pre">addAttribute</span></tt>method of <tt class="docutils literal"><span class="pre">RedirectAttributes</span></tt>object.</div>
<div class="line">In the above example, it is redirected to <tt class="docutils literal"><span class="pre">&quot;/sample/hello?complete&amp;id=aaaa&quot;</span></tt>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">In the above example, the result is the same as of <tt class="docutils literal"><span class="pre">return</span> <span class="pre">&quot;redirect:/sample/hello?complete&amp;id=&quot;</span> <span class="pre">+</span> <span class="pre">id;</span></tt>(as shown in the commented out line in the above example).
However, since URL encoding is also performed if <tt class="docutils literal"><span class="pre">addAttribute</span></tt> method of <tt class="docutils literal"><span class="pre">RedirectAttributes</span></tt>object is used,
the request parameters that needs to be inserted dynamically <strong>should be set to the request parameter using addAttribute method and should not be set to redirect URL specified as return value.</strong>
The request parameters which are not to be inserted dynamically (&#8220;complete&#8221; as in the above example), can be directly specified in the redirect URL specified as the return value.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="inserting-values-in-redirect-destination-url-path">
<span id="controller-method-argument-redirectattributes-path-label"></span><h4><a class="toc-backref" href="#id54">4.3.1.4.8. Inserting values in redirect destination URL path</a><a class="headerlink" href="#inserting-values-in-redirect-destination-url-path" title="Permalink to this headline">¶</a></h4>
<p>To insert values in redirect destination URL path dynamically, add the value to be inserted in <tt class="docutils literal"><span class="pre">RedirectAttributes</span></tt>object of argument as shown in the example to set request parameters.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">(</span><span class="n">RedirectAttributes</span> <span class="n">redirectAttrs</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">String</span> <span class="n">id</span> <span class="o">=</span> <span class="s">&quot;aaaa&quot;</span><span class="o">;</span>
<span class="hll">    <span class="n">redirectAttrs</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">&quot;id&quot;</span><span class="o">,</span> <span class="n">id</span><span class="o">);</span> <span class="c1">// (1)</span>
</span>    <span class="c1">// must not return &quot;redirect:/sample/hello/&quot; + id + &quot;?complete&quot;;</span>
<span class="hll">    <span class="k">return</span> <span class="s">&quot;redirect:/sample/hello/{id}?complete&quot;</span><span class="o">;</span> <span class="c1">// (2)</span>
</span><span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify attribute name and the value using <tt class="docutils literal"><span class="pre">addAttribute</span></tt>method of <tt class="docutils literal"><span class="pre">RedirectAttributes</span></tt>object.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify the path of the variable &#8220;{Attribute name}&#8221;  to be inserted in the redirect URL.</div>
<div class="line">In the above example, it is redirected to <tt class="docutils literal"><span class="pre">&quot;/sample/hello/aaaa?complete&quot;</span></tt>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">In the above example, the result is same as of <tt class="docutils literal"><span class="pre">&quot;redirect:/sample/hello/&quot;</span> <span class="pre">+</span> <span class="pre">id</span> <span class="pre">+</span> <span class="pre">&quot;?complete&quot;;</span></tt>(as shown in the commented out line in the above example).
However, since URL encoding is also performed when using <tt class="docutils literal"><span class="pre">addAttribute</span></tt> method of <tt class="docutils literal"><span class="pre">RedirectAttributes</span></tt>object,
the path values to be inserted dynamically <strong>should be inserted using addAttribute method and path variable and should not be set to redirect URL specified as return value.</strong></p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="acquiring-values-from-cookie">
<span id="controller-method-argument-cookievalue-label"></span><h4><a class="toc-backref" href="#id55">4.3.1.4.9. Acquiring values from Cookie</a><a class="headerlink" href="#acquiring-values-from-cookie" title="Permalink to this headline">¶</a></h4>
<p>Add <tt class="docutils literal"><span class="pre">&#64;CookieValue</span></tt>annotation to the argument of processing method to acquire the values from a cookie.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;readCookie&quot;</span><span class="o">)</span>
<span class="hll"><span class="kd">public</span> <span class="n">String</span> <span class="nf">readCookie</span><span class="o">(</span><span class="nd">@CookieValue</span><span class="o">(</span><span class="s">&quot;JSESSIONID&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">sessionId</span><span class="o">,</span> <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// (1)</span>
</span>    <span class="c1">// do something</span>
    <span class="k">return</span> <span class="s">&quot;sample/readCookie&quot;</span><span class="o">;</span> <span class="c1">// returns view name</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify name of the cookie in the <tt class="docutils literal"><span class="pre">value</span></tt> attribute of <tt class="docutils literal"><span class="pre">&#64;CookieValue</span></tt>annotation.</div>
<div class="line">In the above example, &#8220;JSESSIONID&#8221; value is passed from cookie to sessionId argument.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<dl class="last docutils">
<dt>As in the case of <tt class="docutils literal"><span class="pre">&#64;RequestParam</span></tt> , it has <tt class="docutils literal"><span class="pre">required</span></tt> attribute and <tt class="docutils literal"><span class="pre">defaultValue</span></tt> attribute. Also, the data type of the argument need not be String.</dt>
<dd>Refer to <a class="reference internal" href="#controller-method-argument-requestparam-label"><em>Retrieving request parameters individually</em></a> for details.</dd>
</dl>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="writing-values-in-cookie">
<span id="controller-method-argument-cookiewrite-label"></span><h4><a class="toc-backref" href="#id56">4.3.1.4.10. Writing values in Cookie</a><a class="headerlink" href="#writing-values-in-cookie" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">To write values in cookie, call <tt class="docutils literal"><span class="pre">addCookie</span></tt>method of <tt class="docutils literal"><span class="pre">HttpServletResponse</span></tt>object directly and add the value to cookie.</div>
<div class="line">Since there is no way to write to cookie in Spring MVC  (3.2.3 version), ** Only in this case, HttpServletResponse can fetched as an argument of processing method of controller.**</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;writeCookie&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">writeCookie</span><span class="o">(</span><span class="n">Model</span> <span class="n">model</span><span class="o">,</span>
<span class="hll">        <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// (1)</span>
</span>    <span class="n">Cookie</span> <span class="n">cookie</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Cookie</span><span class="o">(</span><span class="s">&quot;foo&quot;</span><span class="o">,</span> <span class="s">&quot;hello world!&quot;</span><span class="o">);</span>
<span class="hll">    <span class="n">response</span><span class="o">.</span><span class="na">addCookie</span><span class="o">(</span><span class="n">cookie</span><span class="o">);</span> <span class="c1">// (2)</span>
</span>    <span class="c1">// do something</span>
    <span class="k">return</span> <span class="s">&quot;sample/writeCookie&quot;</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Specify <tt class="docutils literal"><span class="pre">HttpServletResponse</span></tt>object as argument to write to cookie.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Generate <tt class="docutils literal"><span class="pre">Cookie</span></tt>object and add to <tt class="docutils literal"><span class="pre">HttpServletResponse</span></tt>object.</div>
<div class="line">For example, <tt class="docutils literal"><span class="pre">&quot;hello</span> <span class="pre">world!&quot;</span></tt>  value is assigned to Cookie name <tt class="docutils literal"><span class="pre">&quot;foo&quot;</span></tt>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">No difference compared to use of <tt class="docutils literal"><span class="pre">HttpServletResponse</span></tt>which fetched as an argument of processing method, however,  <tt class="docutils literal"><span class="pre">org.springframework.web.util.CookieGenerator</span></tt>class is provided by Spring
as a class to write values in cookie. It should be used if required.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="retrieving-pagination-information">
<span id="controller-method-argument-pagination-label"></span><h4><a class="toc-backref" href="#id57">4.3.1.4.11. Retrieving pagination information</a><a class="headerlink" href="#retrieving-pagination-information" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">Pagination related information is required for the requests performing list search.</div>
<div class="line">Fetching <tt class="docutils literal"><span class="pre">org.springframework.data.domain.Pageable</span></tt>(henceforth called as <tt class="docutils literal"><span class="pre">Pageable</span></tt>) object as an argument of processing method enables to handle pagination related information (page count, fetch record count) easily.</div>
</div>
<blockquote>
<div>Refer to <a class="reference internal" href="../ArchitectureInDetail/Pagination.html"><em>Pagination</em></a>  for details.</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="retrieving-uploaded-file">
<span id="controller-method-argument-upload-label"></span><h4><a class="toc-backref" href="#id58">4.3.1.4.12. Retrieving uploaded file</a><a class="headerlink" href="#retrieving-uploaded-file" title="Permalink to this headline">¶</a></h4>
<p>Uploaded file can be obtained in 2 ways.</p>
<ul class="simple">
<li>Provide <tt class="docutils literal"><span class="pre">MultipartFile</span></tt> property in form object.</li>
<li>Use <tt class="docutils literal"><span class="pre">org.springframework.web.multipart.MultipartFile</span></tt> as an argument of processing method having <tt class="docutils literal"><span class="pre">&#64;RequestParam</span></tt> annotation.</li>
</ul>
<p>Refer to <a class="reference internal" href="../ArchitectureInDetail/FileUpload.html"><em>File Upload</em></a>  for details.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="displaying-result-message-on-the-screen">
<span id="controller-method-argument-message-label"></span><h4><a class="toc-backref" href="#id59">4.3.1.4.13. Displaying result message on the screen</a><a class="headerlink" href="#displaying-result-message-on-the-screen" title="Permalink to this headline">¶</a></h4>
<p><tt class="docutils literal"><span class="pre">Model</span></tt> object or <tt class="docutils literal"><span class="pre">RedirectAttributes</span></tt>object can be obtained as an argument of processing method and
result message of business logic execution can be displayed by adding <tt class="docutils literal"><span class="pre">ResultMessages</span></tt> object to Model or RedirectAttributes.</p>
<p>Refer to <a class="reference internal" href="../ArchitectureInDetail/MessageManagement.html"><em>Message Management</em></a>  for details.</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="regarding-return-value-of-processing-method">
<span id="controller-method-return-label"></span><h3><a class="toc-backref" href="#id60">4.3.1.5. Regarding return value of processing method</a><a class="headerlink" href="#regarding-return-value-of-processing-method" title="Permalink to this headline">¶</a></h3>
<p>Various return types supported by the processing method are given in &lt;<a class="reference external" href="http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/mvc.html#mvc-ann-return-types">http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/mvc.html#mvc-ann-return-types</a>&gt;&#8217;_  however,
only the following basic values should be used.</p>
<ul class="simple">
<li>String (for logical name of view)</li>
</ul>
<p>Return types depending on the purpose of usage are described below:</p>
<ul class="simple">
<li><a class="reference internal" href="#controller-method-return-html-label"><em>HTML response</em></a></li>
<li><a class="reference internal" href="#controller-method-return-download-label"><em>Responding to downloaded data</em></a></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="html-response">
<span id="controller-method-return-html-label"></span><h4><a class="toc-backref" href="#id61">4.3.1.5.1. HTML response</a><a class="headerlink" href="#html-response" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">To get HTML response to display the output of processing method, it has to return view name of JSP.</div>
<div class="line">ViewResolver, at the time of generating HTML using JSP,  must be extended class of <tt class="docutils literal"><span class="pre">UrlBasedViewResolver</span></tt> (<tt class="docutils literal"><span class="pre">InternalViewResolver</span></tt> and <tt class="docutils literal"><span class="pre">TilesViewResolver</span></tt>).</div>
</div>
<div class="line-block">
<div class="line">An example using <tt class="docutils literal"><span class="pre">InternalViewResolver</span></tt>is mentioned below, however, it is recommended to use <tt class="docutils literal"><span class="pre">TilesViewResolver</span></tt> when the screen layout is in templated format.</div>
<div class="line">Refer to <a class="reference internal" href="../ArchitectureInDetail/TilesLayout.html"><em>Screen Layout using Tiles</em></a>  for the usage of <tt class="docutils literal"><span class="pre">TilesViewResolver</span></tt>.</div>
</div>
<ul class="simple">
<li>spring-mvc.xml</li>
</ul>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span><span class="nt">&gt;</span>
<span class="hll">    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;prefix&quot;</span> <span class="na">value=</span><span class="s">&quot;/WEB-INF/views/&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (1) --&gt;</span>
</span><span class="hll">    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;suffix&quot;</span> <span class="na">value=</span><span class="s">&quot;.jsp&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (2) --&gt;</span>
</span><span class="hll">    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;order&quot;</span> <span class="na">value=</span><span class="s">&quot;1&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (3) --&gt;</span>
</span><span class="nt">&lt;/bean&gt;</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>SampleController.java</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ommited</span>
<span class="hll">    <span class="k">return</span> <span class="s">&quot;sample/hello&quot;</span><span class="o">;</span> <span class="c1">// (4)</span>
</span><span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">S.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify base directory (prefix of file path) where JSP files are stored.</div>
<div class="line">By specifying prefix of file path, there is no need to specify physical storage location of JSP files, at the time of returning view name in the processing method of controller.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify extension (suffix of file path) of JSP file.</div>
<div class="line">By specifying suffix of file path, there is no need to specify extention of JSP files, at the time of returning view name in the processing method of controller.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify execution order when multiple ViewResolvers are specified. It can be specified in the range of Integers and executed in increasing order.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When View name <tt class="docutils literal"><span class="pre">&quot;sample/hello&quot;</span></tt> is the return value of processing method, <tt class="docutils literal"><span class="pre">&quot;/WEB-INF/views/sample/hello.jsp&quot;</span></tt> is displayed.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">HTML output is generated using JSP in the above example, however, even if HTML is generated using other template engine such as Velocity, FreeMarker, return value of processing method will be <tt class="docutils literal"><span class="pre">&quot;sample/hello</span></tt>.
<tt class="docutils literal"><span class="pre">ViewResolver</span></tt> takes care of task to determine which template engine is to be used.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="responding-to-downloaded-data">
<span id="controller-method-return-download-label"></span><h4><a class="toc-backref" href="#id62">4.3.1.5.2. Responding to downloaded data</a><a class="headerlink" href="#responding-to-downloaded-data" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">In order to return the data stored in db as download data (<tt class="docutils literal"><span class="pre">&quot;application/octet-stream&quot;</span></tt>), it is recommended to create a view</div>
<div class="line">for generating response data (download process).The processing method adds the data to be downloaded to <tt class="docutils literal"><span class="pre">Model</span></tt> and returns</div>
<div class="line">name of the view which performs the actual download process.</div>
</div>
<div class="line-block">
<div class="line">The solution to create a separate ViewResolver to resolve a view using its view name, however, <tt class="docutils literal"><span class="pre">BeanNameViewResolver</span></tt>provided by Spring Framework is recommended.</div>
<div class="line">Refer to <a class="reference internal" href="../ArchitectureInDetail/FileDownload.html"><em>File Download</em></a>  for the details of download processing.</div>
</div>
<ul class="simple">
<li>spring-mvc.xml</li>
</ul>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span class="hll"><span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;org.springframework.web.servlet.view.BeanNameViewResolver&quot;</span><span class="nt">&gt;</span> <span class="c">&lt;!-- (1) --&gt;</span>
</span><span class="hll">     <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;order&quot;</span> <span class="na">value=</span><span class="s">&quot;0&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (2) --&gt;</span>
</span><span class="nt">&lt;/bean&gt;</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>SampleController.java</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;report&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">report</span><span class="o">()</span> <span class="o">{</span>
    <span class="c1">// ommited</span>
<span class="hll">    <span class="k">return</span> <span class="s">&quot;sample/report&quot;</span><span class="o">;</span> <span class="c1">// (3)</span>
</span><span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>XxxExcelView.java</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="nd">@Component</span><span class="o">(</span><span class="s">&quot;sample/report&quot;</span><span class="o">)</span> <span class="c1">// (4)</span>
</span><span class="hll"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">XxxExcelView</span> <span class="kd">extends</span> <span class="n">AbstractExcelView</span> <span class="o">{</span> <span class="c1">// (5)</span>
</span>    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">buildExcelDocument</span><span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">model</span><span class="o">,</span>
            <span class="n">HSSFWorkbook</span> <span class="n">workbook</span><span class="o">,</span> <span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span>
            <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="n">HSSFSheet</span> <span class="n">sheet</span><span class="o">;</span>
        <span class="n">HSSFCell</span> <span class="n">cell</span><span class="o">;</span>

        <span class="n">sheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="na">createSheet</span><span class="o">(</span><span class="s">&quot;Spring&quot;</span><span class="o">);</span>
        <span class="n">sheet</span><span class="o">.</span><span class="na">setDefaultColumnWidth</span><span class="o">(</span><span class="mi">12</span><span class="o">);</span>

        <span class="c1">// write a text at A1</span>
        <span class="n">cell</span> <span class="o">=</span> <span class="n">getCell</span><span class="o">(</span><span class="n">sheet</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
        <span class="n">setText</span><span class="o">(</span><span class="n">cell</span><span class="o">,</span> <span class="s">&quot;Spring-Excel test&quot;</span><span class="o">);</span>

        <span class="n">cell</span> <span class="o">=</span> <span class="n">getCell</span><span class="o">(</span><span class="n">sheet</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">0</span><span class="o">);</span>
        <span class="n">setText</span><span class="o">(</span><span class="n">cell</span><span class="o">,</span> <span class="o">(</span><span class="n">Date</span><span class="o">)</span> <span class="n">model</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;serverTime&quot;</span><span class="o">)).</span><span class="na">toString</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">S.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><tt class="docutils literal"><span class="pre">BeanNameViewResolver</span></tt>is the class that resolves the view by searching for the bean which matches with the returned view name, from application context.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When <tt class="docutils literal"><span class="pre">BeanNameViewResolver</span></tt>is used along with <tt class="docutils literal"><span class="pre">InternalViewResolver</span></tt>or <tt class="docutils literal"><span class="pre">TilesViewResolver</span></tt>, it is recommended to give it a higher priority compared to these other ViewResolvers.</div>
<div class="line">For example, If <tt class="docutils literal"><span class="pre">&quot;0&quot;</span></tt> is specified as the priority for <tt class="docutils literal"><span class="pre">BeanNameViewResolver</span></tt>, <tt class="docutils literal"><span class="pre">BeanNameViewResolver</span></tt>is used prior to <tt class="docutils literal"><span class="pre">InternalViewResolver</span></tt>to resolve a view.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When <tt class="docutils literal"><span class="pre">&quot;sample/report&quot;</span></tt> is returned by the process menthod, the data generated by the view instance registered as bean in step (4) is returned as download data.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify view name as name of the component and register view object as a bean.</div>
<div class="line">For example, <tt class="docutils literal"><span class="pre">x.y.z.app.views.XxxExcelView</span></tt> instance is registered as a bean with bean name (view name) as <tt class="docutils literal"><span class="pre">&quot;sample/report&quot;</span></tt> .</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Example of view implementation. View class that extends <tt class="docutils literal"><span class="pre">org.springframework.web.servlet.view.document.AbstractExcelView</span></tt> and generates Excel data.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="implementing-the-process">
<h3><a class="toc-backref" href="#id63">4.3.1.6. Implementing the process</a><a class="headerlink" href="#implementing-the-process" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">The point here is that <strong>do not implement business logic in controller</strong> .</div>
<div class="line">Business logic must be implemented in Service. Controller must call the service methods in which the business logic is implemented.</div>
<div class="line">Refer to <a class="reference internal" href="DomainLayer.html"><em>Domain Layer Implementation</em></a>  for the details of implementation of business logic.</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Controller should be used only for routing purposes (mapping requests to corresponding business logic) and deciding the screen transition for each request as well as setting model data. Thereby, controller should be simple as much as possible.
By consistently following this policy, the contents of controller become clear which ensures maintainability of controller even if the size of development is large.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Operations to be performed in controller are shown below:</p>
<ul class="simple">
<li><a class="reference internal" href="#controller-logic-correlationcheck-label"><em>Correlation check of input value</em></a></li>
<li><a class="reference internal" href="#controller-logic-businesslogic-label"><em>Calling business logic</em></a></li>
<li><a class="reference internal" href="#controller-logic-domainobject-label"><em>Reflecting values to domain object</em></a></li>
<li><a class="reference internal" href="#controller-logic-formobject-label"><em>Reflecting values to form object</em></a></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="correlation-check-of-input-value">
<span id="controller-logic-correlationcheck-label"></span><h4><a class="toc-backref" href="#id64">4.3.1.6.1. Correlation check of input value</a><a class="headerlink" href="#correlation-check-of-input-value" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">Correlation check of input values should be done using <tt class="docutils literal"><span class="pre">Validation</span></tt> class which implements <tt class="docutils literal"><span class="pre">org.springframework.validation.Validator</span></tt>interface.</div>
<div class="line">Bean Validation can also be used for correlation check of input values.</div>
<div class="line">Refer to <a class="reference internal" href="../ArchitectureInDetail/Validation.html"><em>Input Validation</em></a>  for the details of implementation of correlation check.</div>
</div>
<div class="line-block">
<div class="line">The implementation of correlation check itself should not be written in the processing method of controller. However, it is necessary to add the  <tt class="docutils literal"><span class="pre">Validator</span></tt>to <tt class="docutils literal"><span class="pre">org.springframework.web.bind.WebDataBinder</span></tt>.</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@Inject</span>
<span class="hll"><span class="n">PasswordEqualsValidator</span> <span class="n">passwordEqualsValidator</span><span class="o">;</span> <span class="c1">// (1)</span>
</span>
<span class="nd">@InitBinder</span>
<span class="kd">protected</span> <span class="kt">void</span> <span class="nf">initBinder</span><span class="o">(</span><span class="n">WebDataBinder</span> <span class="n">binder</span><span class="o">){</span>
<span class="hll">    <span class="n">binder</span><span class="o">.</span><span class="na">addValidators</span><span class="o">(</span><span class="n">passwordEqualsValidator</span><span class="o">);</span> <span class="c1">// (2)</span>
</span><span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Inject <tt class="docutils literal"><span class="pre">Validator</span></tt>that performs correlation check.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Add the injected <tt class="docutils literal"><span class="pre">Validator</span></tt> to <tt class="docutils literal"><span class="pre">WebDataBinder</span></tt>.</div>
<div class="line">Adding the above to <tt class="docutils literal"><span class="pre">WebDataBinder</span></tt> enables correlation check by executing <tt class="docutils literal"><span class="pre">Validator</span></tt>before the processing method gets called.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="calling-business-logic">
<span id="controller-logic-businesslogic-label"></span><h4><a class="toc-backref" href="#id65">4.3.1.6.2. Calling business logic</a><a class="headerlink" href="#calling-business-logic" title="Permalink to this headline">¶</a></h4>
<p>Execute business logic by injecting the Service in which business logic is implemented and calling the injected Service method.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@Inject</span>
<span class="hll"><span class="n">SampleService</span> <span class="n">sampleService</span><span class="o">;</span> <span class="c1">// (1)</span>
</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">hello</span><span class="o">(</span><span class="n">Model</span> <span class="n">model</span><span class="o">){</span>
<span class="hll">    <span class="n">String</span> <span class="n">message</span> <span class="o">=</span> <span class="n">sampleService</span><span class="o">.</span><span class="na">hello</span><span class="o">();</span> <span class="c1">// (2)</span>
</span>    <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">&quot;message&quot;</span><span class="o">,</span> <span class="n">message</span><span class="o">);</span>
    <span class="k">return</span> <span class="s">&quot;sample/hello&quot;</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Inject the <tt class="docutils literal"><span class="pre">Service</span></tt> in which business logic is implemented.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Call the injected <tt class="docutils literal"><span class="pre">Service</span></tt> method to execute business logic.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="reflecting-values-to-domain-object">
<span id="controller-logic-domainobject-label"></span><h4><a class="toc-backref" href="#id66">4.3.1.6.3. Reflecting values to domain object</a><a class="headerlink" href="#reflecting-values-to-domain-object" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">In this guideline, it is recommended to bind the data sent by HTML form to form object instead of the domain object.</div>
<div class="line">Therefore, the controller should perform the process of reflecting the values of form object to domain object which is then passed to the method of service class.</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">hello</span><span class="o">(</span><span class="nd">@Validated</span> <span class="n">SampleForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="o">,</span> <span class="n">Model</span> <span class="n">model</span><span class="o">){</span>
    <span class="c1">// ommited</span>
<span class="hll">    <span class="n">Sample</span> <span class="n">sample</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Sample</span><span class="o">();</span> <span class="c1">// (1)</span>
</span>    <span class="n">sample</span><span class="o">.</span><span class="na">setField1</span><span class="o">(</span><span class="n">form</span><span class="o">.</span><span class="na">getField1</span><span class="o">());</span>
    <span class="n">sample</span><span class="o">.</span><span class="na">setField2</span><span class="o">(</span><span class="n">form</span><span class="o">.</span><span class="na">getField2</span><span class="o">());</span>
    <span class="n">sample</span><span class="o">.</span><span class="na">setField3</span><span class="o">(</span><span class="n">form</span><span class="o">.</span><span class="na">getField3</span><span class="o">());</span>
    <span class="c1">// ...</span>
    <span class="c1">// and more ...</span>
    <span class="c1">// ...</span>
<span class="hll">    <span class="n">String</span> <span class="n">message</span> <span class="o">=</span> <span class="n">sampleService</span><span class="o">.</span><span class="na">hello</span><span class="o">(</span><span class="n">sample</span><span class="o">);</span> <span class="c1">// (2)</span>
</span><span class="hll">    <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">&quot;message&quot;</span><span class="o">,</span> <span class="n">message</span><span class="o">);</span> <span class="c1">// (3)</span>
</span>    <span class="k">return</span> <span class="s">&quot;sample/hello&quot;</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Create domain object and reflect the values bound to form object in the domain object.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Call the method of service class to execute business logic.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Add the data returned from business logic to <tt class="docutils literal"><span class="pre">Model</span></tt>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line">The process of reflecting values to domain object should be implemented by the processing methodof controller. However considering the readability of processing</div>
<div class="line">method in case of large amount of code, it is recommended to delegate the process to Helper class.</div>
<div class="line">Example of delegating the process to Helper class is shown below:</div>
</div>
<ul class="simple">
<li>SampleController.java</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@Inject</span>
<span class="hll"><span class="n">SampleHelper</span> <span class="n">sampleHelper</span><span class="o">;</span> <span class="c1">// (1)</span>
</span>
<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">hello</span><span class="o">(</span><span class="nd">@Validated</span> <span class="n">SampleForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="o">){</span>
    <span class="c1">// ommited</span>
<span class="hll">    <span class="n">String</span> <span class="n">message</span> <span class="o">=</span> <span class="n">sampleHelper</span><span class="o">.</span><span class="na">hello</span><span class="o">(</span><span class="n">form</span><span class="o">);</span> <span class="c1">// (2)</span>
</span>    <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="s">&quot;message&quot;</span><span class="o">,</span> <span class="n">message</span><span class="o">);</span>
    <span class="k">return</span> <span class="s">&quot;sample/hello&quot;</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>SampleHelper.java</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleHelper</span> <span class="o">{</span>

    <span class="nd">@Inject</span>
    <span class="n">SampleService</span> <span class="n">sampleService</span><span class="o">;</span>

<span class="hll">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">hello</span><span class="o">(</span><span class="n">SampleForm</span> <span class="n">form</span><span class="o">){</span> <span class="c1">// (3)</span>
</span>        <span class="n">Sample</span> <span class="n">sample</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Sample</span><span class="o">();</span>
        <span class="n">sample</span><span class="o">.</span><span class="na">setField1</span><span class="o">(</span><span class="n">form</span><span class="o">.</span><span class="na">getField1</span><span class="o">());</span>
        <span class="n">sample</span><span class="o">.</span><span class="na">setField2</span><span class="o">(</span><span class="n">form</span><span class="o">.</span><span class="na">getField2</span><span class="o">());</span>
        <span class="n">sample</span><span class="o">.</span><span class="na">setField3</span><span class="o">(</span><span class="n">form</span><span class="o">.</span><span class="na">getField3</span><span class="o">());</span>
        <span class="c1">// ...</span>
        <span class="c1">// and more ...</span>
        <span class="c1">// ...</span>
        <span class="n">String</span> <span class="n">message</span> <span class="o">=</span> <span class="n">sampleService</span><span class="o">.</span><span class="na">hello</span><span class="o">(</span><span class="n">sample</span><span class="o">);</span>
        <span class="k">return</span> <span class="n">message</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">S.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Inject object of Helper class in controller.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Value is reflected to the domain object by calling the method of the injected Helper class.
Delegating the process to Helper class enables to keep the implementation of controller simple.</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td>Call the Service class method to execute the business logic after creating domain object.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Bean conversion functionality can be used as an alternative way to delegate the process of reflecting form object values, to Helper class.
Refer to <a class="reference internal" href="../ArchitectureInDetail/Utilities/Dozer.html"><em>Bean Mapping (Dozer)</em></a>  for the details of Bean conversion functionality.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="reflecting-values-to-form-object">
<span id="controller-logic-formobject-label"></span><h4><a class="toc-backref" href="#id67">4.3.1.6.4. Reflecting values to form object</a><a class="headerlink" href="#reflecting-values-to-form-object" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">In this guideline, it is recommended that form object (and not domain object) must be used to for that data which is to be binded to HTML form.</div>
<div class="line">For this, it is necessary to reflect the values of domain object (returned by service layer) to form object. This conversion should be performed in controller class.</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">hello</span><span class="o">(</span><span class="n">SampleForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="o">,</span> <span class="n">Model</span> <span class="n">model</span><span class="o">){</span>
    <span class="c1">// ommited</span>
<span class="hll">    <span class="n">Sample</span> <span class="n">sample</span> <span class="o">=</span> <span class="n">sampleService</span><span class="o">.</span><span class="na">getSample</span><span class="o">(</span><span class="n">form</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span> <span class="c1">// (1)</span>
</span><span class="hll">    <span class="n">form</span><span class="o">.</span><span class="na">setField1</span><span class="o">(</span><span class="n">sample</span><span class="o">.</span><span class="na">getField1</span><span class="o">());</span> <span class="c1">// (2)</span>
</span>    <span class="n">form</span><span class="o">.</span><span class="na">setField2</span><span class="o">(</span><span class="n">sample</span><span class="o">.</span><span class="na">getField2</span><span class="o">());</span>
    <span class="n">form</span><span class="o">.</span><span class="na">setField3</span><span class="o">(</span><span class="n">sample</span><span class="o">.</span><span class="na">getField3</span><span class="o">());</span>
    <span class="c1">// ...</span>
    <span class="c1">// and more ...</span>
    <span class="c1">// ...</span>
<span class="hll">    <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="n">sample</span><span class="o">);</span> <span class="c1">// (3)</span>
</span>    <span class="k">return</span> <span class="s">&quot;sample/hello&quot;</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Call the method of service class in which business logic is implemented and fetch domain object.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Reflect values of acquired domain object to form object.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When there are fields only for display, add domain object to <tt class="docutils literal"><span class="pre">Model</span></tt>so that data can be referred.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In JSP, it is recommended to refer the values from domain object instead of form object for the fields to be only displayed on the screen.</p>
</div>
</div></blockquote>
<p>The process of reflecting value to form object should be implemented by the processing method of controller.
However considering the readability of processing method in case of large amount of code, it is recommended to delegate the process to Helper class method.</p>
<ul class="simple">
<li>SampleController.java</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">hello</span><span class="o">(</span><span class="nd">@Validated</span> <span class="n">SampleForm</span> <span class="n">form</span><span class="o">,</span> <span class="n">BindingResult</span> <span class="n">result</span><span class="o">){</span>
    <span class="c1">// ommited</span>
    <span class="n">Sample</span> <span class="n">sample</span> <span class="o">=</span> <span class="n">sampleService</span><span class="o">.</span><span class="na">getSample</span><span class="o">(</span><span class="n">form</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
<span class="hll">    <span class="n">sampleHelper</span><span class="o">.</span><span class="na">applyToForm</span><span class="o">(</span><span class="n">sample</span><span class="o">,</span> <span class="n">form</span><span class="o">);</span> <span class="c1">// (1)</span>
</span>    <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="n">sample</span><span class="o">);</span>
    <span class="k">return</span> <span class="s">&quot;sample/hello&quot;</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>SampleHelper.java</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="kd">public</span> <span class="kt">void</span> <span class="nf">applyToForm</span><span class="o">(</span><span class="n">SampleForm</span> <span class="n">destForm</span><span class="o">,</span> <span class="n">Sample</span> <span class="n">srcSample</span><span class="o">){</span>
<span class="hll">    <span class="n">destForm</span><span class="o">.</span><span class="na">setField1</span><span class="o">(</span><span class="n">srcSample</span><span class="o">.</span><span class="na">getField1</span><span class="o">());</span> <span class="c1">// (2)</span>
</span>    <span class="n">destForm</span><span class="o">.</span><span class="na">setField2</span><span class="o">(</span><span class="n">srcSample</span><span class="o">.</span><span class="na">getField2</span><span class="o">());</span>
    <span class="n">destForm</span><span class="o">.</span><span class="na">setField3</span><span class="o">(</span><span class="n">srcSample</span><span class="o">.</span><span class="na">getField3</span><span class="o">());</span>
    <span class="c1">// ...</span>
    <span class="c1">// and more ...</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Call the method to reflect the values of domain object to form object.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Reflect the values of domain object to form object.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Bean conversion functionality can be used as an alternative method to delegate the process to Helper class.
Refer to <a class="reference internal" href="../ArchitectureInDetail/Utilities/Dozer.html"><em>Bean Mapping (Dozer)</em></a>  for the details of Bean conversion functionality.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
</div>
</div>
<div class="section" id="implementing-form-object">
<span id="formobject"></span><h2><a class="toc-backref" href="#id68">4.3.2. Implementing form object</a><a class="headerlink" href="#implementing-form-object" title="Permalink to this headline">¶</a></h2>
<p>Form object is the object (JavaBean) which represents HTML form and plays the following role.</p>
<ol class="arabic simple">
<li><strong>Holds business data stored in the database so that it can be referred by HTML form (JSP).</strong></li>
<li><strong>Holds request parameters sent by HTML form so that they can be referred by processing method of controller.</strong></li>
</ol>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/applicationFormobject.png"><img alt="../_images/applicationFormobject.png" src="../_images/applicationFormobject.png" style="width: 80%;" /></a>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Implementation of form object can be described by focusing on the following points.</p>
<ul class="simple">
<li><a class="reference internal" href="#formobject-new-label"><em>Creating form object</em></a></li>
<li><a class="reference internal" href="#formobject-init-label"><em>Initializing form object</em></a></li>
<li><a class="reference internal" href="#formobject-bindhtmlform-label"><em>Binding to HTML form</em></a></li>
<li><a class="reference internal" href="#formobject-bindrequestparam-label"><em>Binding request parameters</em></a></li>
</ul>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="creating-form-object">
<span id="formobject-new-label"></span><h3><a class="toc-backref" href="#id69">4.3.2.1. Creating form object</a><a class="headerlink" href="#creating-form-object" title="Permalink to this headline">¶</a></h3>
<p>Create form object as a JavaBean.
Spring Framework provides the functionality to convert and bind the request parameters (string) sent by HTML form to the format defined in form object.
Hence, the fields to be defined in form object need not only be in <tt class="docutils literal"><span class="pre">java.lang.String</span></tt>format.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleForm</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">age</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">genderCode</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Date</span> <span class="n">birthDate</span><span class="o">;</span>
    <span class="c1">// omitted getter/setter</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p><a href="#id11"><span class="problematic" id="id12">**</span></a>Regarding the mechanism provided by Spring Framework that performs format conversion **</p>
<p>Spring Framework executes format conversion using the following 3 mechanisms and supports conversion to basic format as standard. Refer to linked page for the details of each conversion function.</p>
<ul class="last simple">
<li><a class="reference external" href="http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/validation.html#core-convert">Spring 3 Type Conversion</a></li>
<li><a class="reference external" href="http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/validation.html#format">Spring 3 Field Formatting</a></li>
<li><a class="reference external" href="http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/validation.html#beans-beans-conversion">java.beans.PropertyEditor implementations</a></li>
</ul>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">In form object, it is recommended to maintain only the fields of HTML form and not the fields which are just displayed on the screen.
If display only fields are also maintained in form object, more memory will get consumed at the time of storing form objectin HTTP session object causing memory exhaustion.
In order to display the values of display only fields on the screen, it is recommended to add objects of domain layer (such as Entity) to request scope by using (<tt class="docutils literal"><span class="pre">Model.addAttribute</span></tt>).</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="number-format-conversion-of-fields">
<h4><a class="toc-backref" href="#id70">4.3.2.1.1. Number format conversion of fields</a><a class="headerlink" href="#number-format-conversion-of-fields" title="Permalink to this headline">¶</a></h4>
<p>Number format can be specified for each field using <tt class="docutils literal"><span class="pre">&#64;NumberFormat</span></tt>annotation.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleForm</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="o">{</span>
<span class="hll">    <span class="nd">@NumberFormat</span><span class="o">(</span><span class="n">pattern</span> <span class="o">=</span> <span class="s">&quot;#,#&quot;</span><span class="o">)</span> <span class="c1">// (1)</span>
</span>    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">price</span><span class="o">;</span>
    <span class="c1">// omitted getter/setter</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify the number format of request parameter sent by HTML form. For example, binding of value formatted by &#8221;,&#8221; is possible since &#8220;&#8221;#, #&#8221;&#8221; format is specified as pattern.</div>
<div class="line">When value of request parameter is &#8220;&#8221;1,050&#8221;&#8221;, Integer object of &#8220;&#8221;1050&#8221;&#8221; will bind to the property <tt class="docutils literal"><span class="pre">price</span></tt> of form object.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Attributes of <tt class="docutils literal"><span class="pre">&#64;NumberFormat</span></tt> annotation are given below.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="10%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Attribute name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ol class="first last arabic simple">
<li></li>
</ol>
</td>
<td>style</td>
<td>Specify number format style (NUMBER, CURRENCY, PERCENT). Refer to &#8216;Javadoc &lt;<a class="reference external" href="http://static.springsource.org/spring/docs/3.2.x/javadoc-api/org/springframework/format/annotation/NumberFormat.Style.html">http://static.springsource.org/spring/docs/3.2.x/javadoc-api/org/springframework/format/annotation/NumberFormat.Style.html</a>&gt; of Spring Framework&#8217;_ for details.</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="2">
<li></li>
</ol>
</td>
<td>pattern</td>
<td>Specify number format of Java. Refer to &#8216;Javadoc &lt;<a class="reference external" href="http://docs.oracle.com/javase/7/docs/api/java/text/DecimalFormat.html">http://docs.oracle.com/javase/7/docs/api/java/text/DecimalFormat.html</a>&gt; of JAVASE&#8217;_for details.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="date-and-time-format-conversion-of-fields">
<span id="applicationlayer-datetimeformat"></span><h4><a class="toc-backref" href="#id71">4.3.2.1.2. Date and time format conversion of fields</a><a class="headerlink" href="#date-and-time-format-conversion-of-fields" title="Permalink to this headline">¶</a></h4>
<p>Date and time format for each field can be specified using <tt class="docutils literal"><span class="pre">&#64;DateTimeFormat</span></tt>annotation.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleForm</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="o">{</span>
<span class="hll">    <span class="nd">@DateTimeFormat</span><span class="o">(</span><span class="n">pattern</span> <span class="o">=</span> <span class="s">&quot;yyyyMMdd&quot;</span><span class="o">)</span> <span class="c1">// (1)</span>
</span>    <span class="kd">private</span> <span class="n">Date</span> <span class="n">birthDate</span><span class="o">;</span>
    <span class="c1">// ommitted getter/setter</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Specify the date and time format of request parameter sent by HTML form. For example, <tt class="docutils literal"><span class="pre">&quot;yyyyMMdd&quot;</span></tt> format is specified as pattern.
When the value of request parameter is <tt class="docutils literal"><span class="pre">&quot;20131001&quot;</span></tt>, Date object of 1st October, 2013 will bind to property <tt class="docutils literal"><span class="pre">birthDate</span></tt> of form object.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Attributes of <tt class="docutils literal"><span class="pre">&#64;DateTimeFormat</span></tt>annotation are given below.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="10%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Attribute name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ol class="first last arabic simple">
<li></li>
</ol>
</td>
<td>iso</td>
<td>Specify ISO date and time format. Refer to &#8216;Javadoc &lt;<a class="reference external" href="http://static.springsource.org/spring/docs/3.2.x/javadoc-api/org/springframework/format/annotation/DateTimeFormat.ISO.html">http://static.springsource.org/spring/docs/3.2.x/javadoc-api/org/springframework/format/annotation/DateTimeFormat.ISO.html</a>&gt; of Spring Framework&#8217;_for details.</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="2">
<li></li>
</ol>
</td>
<td>pattern</td>
<td>Specify Java date and time format. Refer to &#8216;Javadoc &lt;<a class="reference external" href="http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html">http://docs.oracle.com/javase/7/docs/api/java/text/SimpleDateFormat.html</a>&gt; of JAVASE&#8217;_for details.</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="3">
<li></li>
</ol>
</td>
<td>style</td>
<td><div class="first last line-block">
<div class="line">日付と時刻のスタイルを2桁の文字列として指定する。</div>
<div class="line">1桁目が日付のスタイル、2桁目が時刻のスタイルとなる。</div>
<div class="line">スタイルとして指定できる値は以下の値となる。</div>
<div class="line"><br /></div>
<div class="line">S : <tt class="docutils literal"><span class="pre">java.text.DateFormat.SHORT</span></tt>と同じ形式となる。</div>
<div class="line">M : <tt class="docutils literal"><span class="pre">java.text.DateFormat.MEDIUM</span></tt>と同じ形式となる。</div>
<div class="line">L : <tt class="docutils literal"><span class="pre">java.text.DateFormat.LONG</span></tt>と同じ形式となる。</div>
<div class="line">F : <tt class="docutils literal"><span class="pre">java.text.DateFormat.FULL</span></tt>と同じ形式となる。</div>
<div class="line">- : 省略を意味するスタイル。</div>
<div class="line"><br /></div>
<div class="line">指定例及び変換例)</div>
<div class="line">MM : Dec 9, 2013 3:37:47 AM</div>
<div class="line">M- : Dec 9, 2013</div>
<div class="line">-M : 3:41:45 AM</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">Description of style is incomplete.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="datatype-conversion-in-controller">
<h4><a class="toc-backref" href="#id72">4.3.2.1.3. DataType conversion in controller</a><a class="headerlink" href="#datatype-conversion-in-controller" title="Permalink to this headline">¶</a></h4>
<p><tt class="docutils literal"><span class="pre">&#64;InitBinder</span></tt>annotation can be used to define datatype conversions at controller level.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="nd">@InitBinder</span> <span class="c1">// (1)</span>
</span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">initWebDataBinder</span><span class="o">(</span><span class="n">WebDataBinder</span> <span class="n">binder</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">binder</span><span class="o">.</span><span class="na">registerCustomEditor</span><span class="o">(</span>
            <span class="n">Long</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
<span class="hll">            <span class="k">new</span> <span class="nf">CustomNumberEditor</span><span class="o">(</span><span class="n">Long</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="k">new</span> <span class="n">DecimalFormat</span><span class="o">(</span><span class="s">&quot;#,#&quot;</span><span class="o">),</span> <span class="kc">true</span><span class="o">));</span> <span class="c1">// (2)</span>
</span><span class="o">}</span>
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="nd">@InitBinder</span><span class="o">(</span><span class="s">&quot;sampleForm&quot;</span><span class="o">)</span> <span class="c1">// (3)</span>
</span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">initSampleFormWebDataBinder</span><span class="o">(</span><span class="n">WebDataBinder</span> <span class="n">binder</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">If a method with <tt class="docutils literal"><span class="pre">&#64;InitBinder</span></tt>annotation is provided, it is called before executing the binding process and thereby default operations can be customized.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">For example, <tt class="docutils literal"><span class="pre">&quot;#.</span> <span class="pre">#&quot;</span></tt> format is specified for a field of type Long. This enables binding of value formatted with &#8221;,&#8221;.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Default operation for each form object can be customized by specifying it in the value attribute of <tt class="docutils literal"><span class="pre">&#64;InitBinder</span></tt>annotation.</div>
<div class="line">In the above example, the method is called before binding form object <tt class="docutils literal"><span class="pre">&quot;sampleForm&quot;</span></tt>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="specifying-annotation-for-input-validation">
<h4><a class="toc-backref" href="#id73">4.3.2.1.4. Specifying annotation for input validation</a><a class="headerlink" href="#specifying-annotation-for-input-validation" title="Permalink to this headline">¶</a></h4>
<p>Since form object is validated using Bean Validation, it is necessary to specify annotation which indicates constraints of the field.
Refer to <a class="reference internal" href="../ArchitectureInDetail/Validation.html"><em>Input Validation</em></a>  for the details of input validation.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="initializing-form-object">
<span id="formobject-init-label"></span><h3><a class="toc-backref" href="#id74">4.3.2.2. Initializing form object</a><a class="headerlink" href="#initializing-form-object" title="Permalink to this headline">¶</a></h3>
<p>Form object can also be called as form-backing bean and binding can be performed using <tt class="docutils literal"><span class="pre">&#64;ModelAttribute</span></tt>annotation.
Initialize form-backing bean by the method having <tt class="docutils literal"><span class="pre">&#64;ModelAttribute</span></tt>annotation.
In this guideline, such methods are called as ModelAttribute methods and defined with method names like <tt class="docutils literal"><span class="pre">setUpXxxForm</span></tt>.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="nd">@ModelAttribute</span> <span class="c1">// (1)</span>
</span><span class="kd">public</span> <span class="n">SampleForm</span> <span class="nf">setUpSampleForm</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">SampleForm</span> <span class="n">form</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SampleForm</span><span class="o">();</span>
    <span class="c1">// populate form</span>
    <span class="k">return</span> <span class="n">form</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="nd">@ModelAttribute</span><span class="o">(</span><span class="s">&quot;xxx&quot;</span><span class="o">)</span> <span class="c1">// (2)</span>
</span><span class="kd">public</span> <span class="n">SampleForm</span> <span class="nf">setUpSampleForm</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">SampleForm</span> <span class="n">form</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SampleForm</span><span class="o">();</span>
    <span class="c1">// populate form</span>
    <span class="k">return</span> <span class="n">form</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span class="nd">@ModelAttribute</span>
<span class="kd">public</span> <span class="n">SampleForm</span> <span class="nf">setUpSampleForm</span><span class="o">(</span>
<span class="hll">        <span class="nd">@CookieValue</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;name&quot;</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span> <span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="c1">// (3)</span>
</span>        <span class="nd">@CookieValue</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;age&quot;</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span> <span class="n">Integer</span> <span class="n">age</span><span class="o">,</span>
        <span class="nd">@CookieValue</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;birthDate&quot;</span><span class="o">,</span> <span class="n">required</span> <span class="o">=</span> <span class="kc">false</span><span class="o">)</span> <span class="n">Date</span> <span class="n">birthDate</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">SampleForm</span> <span class="n">form</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SampleForm</span><span class="o">();</span>
    <span class="n">form</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="n">name</span><span class="o">);</span>
    <span class="n">form</span><span class="o">.</span><span class="na">setAge</span><span class="o">(</span><span class="n">age</span><span class="o">);</span>
    <span class="n">form</span><span class="o">.</span><span class="na">setBirthDate</span><span class="o">(</span><span class="n">birthDate</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">form</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Class name beginning with lower case letter will become the attribute name to add to <tt class="docutils literal"><span class="pre">Model</span></tt>. In the above example, <tt class="docutils literal"><span class="pre">&quot;sampleForm&quot;</span></tt> is the attribute name.</div>
<div class="line">The returned object is added to <tt class="docutils literal"><span class="pre">Model</span></tt>and an appropriate process <tt class="docutils literal"><span class="pre">model.addAttribute(form)</span></tt>is executed.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When attribute name is to be specified to add to <tt class="docutils literal"><span class="pre">Model</span></tt>, specify it in the value attribute of <tt class="docutils literal"><span class="pre">&#64;ModelAttribute</span></tt>annotation. In the above example, <tt class="docutils literal"><span class="pre">&quot;xxx&quot;</span></tt> is the attribute name.</div>
<div class="line">For returned object, appropriate process &#8220;model.addAttribute(&#8220;xxx&#8221;, form)&#8221;is executed and it is returned to <tt class="docutils literal"><span class="pre">Model</span></tt>.</div>
<div class="line">When attribute name other than default value is specified, it is necessary to specify <tt class="docutils literal"><span class="pre">&#64;ModelAttribute(&quot;xxx&quot;)</span></tt>at the time of specifying form object as an argument of processing method.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">ModelAttribute method can pass the parameters required for initialization as with the case of processing method. In the above example, value of cookie is specified using <tt class="docutils literal"><span class="pre">&#64;CookieValue</span></tt>annotation.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When form object is to be initialized with default values, it should be done using ModelAttribute method.
In point (3) in above example , value is fetched from cookie, However, fixed value defined in constant class can be set directly.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Multiple ModelAttribute methods can be defined in the controller. Each method is executed before calling processing method of controller.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If ModelAttribute method is executed for each request, initialization needs to be repeated for each request and unnecessary objects will get created.
So, for form objects which are required only for specific requests, should be created inside processing method of controller and not through the use of ModelAttribute method.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="binding-to-html-form">
<span id="formobject-bindhtmlform-label"></span><span id="formobjectjsp"></span><h3><a class="toc-backref" href="#id75">4.3.2.3. Binding to HTML form</a><a class="headerlink" href="#binding-to-html-form" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">It is possible to bind form object added to the <tt class="docutils literal"><span class="pre">Model</span></tt>to HTML form(JSP) using <tt class="docutils literal"><span class="pre">&lt;form:xxx&gt;</span></tt>tag.</div>
<div class="line">Refer to <a class="reference external" href="http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/view.html#view-jsp-formtaglib">Using Spring&#8217;s form tag library</a>for the details of <tt class="docutils literal"><span class="pre">&lt;form:xxx&gt;</span></tt>tag.</div>
</div>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="hll"><span class="k">&lt;%@</span> <span class="n">taglib</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&quot;form&quot;</span> <span class="n">uri</span><span class="o">=</span><span class="s">&quot;http://www.springframework.org/tags/form&quot;</span> <span class="k">%&gt;</span> <span class="c">&lt;!-- (1) --&gt;</span>
</span></pre></div>
</div>
<div class="highlight-jsp"><div class="highlight"><pre><span class="nt">&lt;form:form</span> <span class="na">modelAttribute=</span><span class="s">&quot;sampleForm&quot;</span>
<span class="hll">           <span class="na">action=</span><span class="s">&quot;${pageContext.request.contextPath}/sample/hello&quot;</span><span class="nt">&gt;</span> <span class="c">&lt;!-- (2) --&gt;</span>
</span><span class="hll">    Id         : <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;id&quot;</span> <span class="nt">/&gt;&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;id&quot;</span> <span class="nt">/&gt;&lt;br</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (3) --&gt;</span>
</span>    Name       : <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="nt">/&gt;&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;name&quot;</span> <span class="nt">/&gt;&lt;br</span> <span class="nt">/&gt;</span>
    Age        : <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="nt">/&gt;&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;age&quot;</span> <span class="nt">/&gt;&lt;br</span> <span class="nt">/&gt;</span>
    Gender     : <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;genderCode&quot;</span> <span class="nt">/&gt;&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;genderCode&quot;</span> <span class="nt">/&gt;&lt;br</span> <span class="nt">/&gt;</span>
    Birth Date : <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;birthDate&quot;</span> <span class="nt">/&gt;&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;birthDate&quot;</span> <span class="nt">/&gt;&lt;br</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form:form&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Define taglib to use <tt class="docutils literal"><span class="pre">&lt;form:form&gt;</span></tt>tag.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Specify form object stored in <tt class="docutils literal"><span class="pre">Model</span></tt>in the <tt class="docutils literal"><span class="pre">modelAttribute</span></tt> attribute of <tt class="docutils literal"><span class="pre">&lt;form:form&gt;</span></tt>tag.</td>
</tr>
<tr class="row-even"><td><a href="#id13"><span class="problematic" id="id14">|</span></a>(3)</td>
<td>Specify property name of form object in path attribute of <tt class="docutils literal"><span class="pre">&lt;form:input&gt;</span></tt>tag.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="binding-request-parameters">
<span id="formobject-bindrequestparam-label"></span><h3><a class="toc-backref" href="#id76">4.3.2.4. Binding request parameters</a><a class="headerlink" href="#binding-request-parameters" title="Permalink to this headline">¶</a></h3>
<p>It is possible to bind the request parameters sent by HTML form to form object and pass it as an argument to the processing method of controller.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">(</span>
<span class="hll">        <span class="nd">@Validated</span> <span class="n">SampleForm</span> <span class="n">form</span><span class="o">,</span> <span class="c1">// (1)</span>
</span>        <span class="n">BindingResult</span> <span class="n">result</span><span class="o">,</span>
        <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">())</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">&quot;sample/input&quot;</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="c1">// process form...</span>
    <span class="k">return</span> <span class="s">&quot;sample/hello&quot;</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-java"><div class="highlight"><pre><span class="nd">@ModelAttribute</span><span class="o">(</span><span class="s">&quot;xxx&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">SampleForm</span> <span class="nf">setUpSampleForm</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">SampleForm</span> <span class="n">form</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SampleForm</span><span class="o">();</span>
    <span class="c1">// populate form</span>
    <span class="k">return</span> <span class="n">form</span><span class="o">;</span>
<span class="o">}</span>

<span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">(</span>
<span class="hll">        <span class="nd">@ModelAttribute</span><span class="o">(</span><span class="s">&quot;xxx&quot;</span><span class="o">)</span> <span class="nd">@Validated</span> <span class="n">SampleForm</span> <span class="n">form</span><span class="o">,</span> <span class="c1">// (2)</span>
</span>        <span class="n">BindingResult</span> <span class="n">result</span><span class="o">,</span>
        <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Form object is passed as an argument to the processing method of controller after reflecting request parameters to the form object.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">When the attribute name is specified in ModelAttribute method, it is necessary to explicitly specify attribute name of form object as <tt class="docutils literal"><span class="pre">&#64;ModelAttribute(&quot;xxx&quot;)</span></tt>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">When attribute name specified by ModelAttribute method and attribute name specified in the <tt class="docutils literal"><span class="pre">&#64;ModelAttribute(&quot;xxx&quot;)</span></tt>in the argument of processing method are different,
it should be noted that a new instance is created other than the instance created by ModelAttribute method.
When attribute name is not specified with <tt class="docutils literal"><span class="pre">&#64;ModelAttribute</span></tt> in the argument to processing method, the attribute name is deduced as the class name with first letter in lower case.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="determining-binding-result">
<h4><a class="toc-backref" href="#id77">4.3.2.4.1. Determining binding result</a><a class="headerlink" href="#determining-binding-result" title="Permalink to this headline">¶</a></h4>
<p>Error (including input validation error) that occurs while binding request parameter sent by HTML form to form object, is stored in <tt class="docutils literal"><span class="pre">org.springframework.validation.BindingResult</span></tt>.</p>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">(</span>
        <span class="nd">@Validated</span> <span class="n">SampleForm</span> <span class="n">form</span><span class="o">,</span>
<span class="hll">        <span class="n">BindingResult</span> <span class="n">result</span><span class="o">,</span> <span class="c1">// (1)</span>
</span>        <span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
<span class="hll">    <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">())</span> <span class="o">{</span> <span class="c1">// (2)</span>
</span>        <span class="k">return</span> <span class="s">&quot;sample/input&quot;</span><span class="o">;</span>
    <span class="o">}</span>
    <span class="c1">// ...</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>When <tt class="docutils literal"><span class="pre">BindingResult</span></tt>is declared immediately after form object, it is possible to refer to the error inside the processing method of controller.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Calling <tt class="docutils literal"><span class="pre">BindingResult.hasErrors()</span></tt>can determine whether any error occurred in the input values of form object.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>It is also possible to determine field errors, global errors (correlated check errors at class level) separately. These can be used separately if required.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="40%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Method</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ol class="first last arabic simple">
<li></li>
</ol>
</td>
<td><tt class="docutils literal"><span class="pre">hasGlobalErrors()</span></tt></td>
<td>Method to determine the existence of global errors.</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="2">
<li></li>
</ol>
</td>
<td><tt class="docutils literal"><span class="pre">hasFieldErrors()</span></tt></td>
<td>Method to determine the existence of field errors.</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="3">
<li></li>
</ol>
</td>
<td><tt class="docutils literal"><span class="pre">hasFieldErrors(String</span> <span class="pre">field)</span></tt></td>
<td>Method to determine the existence of errors related to specified field.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
</div>
<div class="section" id="implementing-view">
<span id="view"></span><h2><a class="toc-backref" href="#id78">4.3.3. Implementing View</a><a class="headerlink" href="#implementing-view" title="Permalink to this headline">¶</a></h2>
<p>View plays the following role.</p>
<ol class="arabic">
<li><div class="first line-block">
<div class="line"><strong>View generates response (HTML) as per the requirements of the client.</strong></div>
<div class="line">View retrieves the required data from model (form object or domain object) and generates response in the format which is required by the client for rendering.</div>
</div>
</li>
</ol>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="implementing-jsp">
<h3><a class="toc-backref" href="#id79">4.3.3.1. Implementing JSP</a><a class="headerlink" href="#implementing-jsp" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">Implement View using JSP to generate response(HTML) as per the requirement of the client.</div>
<div class="line">Use the class provided by Spring Framework as the <tt class="docutils literal"><span class="pre">ViewResolver</span></tt> for calling JSP. Refer to <a class="reference internal" href="#controller-method-return-html-label"><em>HTML response</em></a> for settings of <tt class="docutils literal"><span class="pre">ViewResolver</span></tt>.</div>
</div>
<p>Basic implementation method of JSP is described below.</p>
<ul class="simple">
<li><a class="reference internal" href="#view-jsp-include-label"><em>Creating common JSP for include</em></a></li>
<li><a class="reference internal" href="#view-jsp-out-label"><em>Displaying value stored in model</em></a></li>
<li><a class="reference internal" href="#view-jsp-outnumber-label"><em>Displaying numbers stored in model</em></a></li>
<li><a class="reference internal" href="#view-jsp-outdate-label"><em>Displaying date and time stored in model</em></a></li>
<li><a class="reference internal" href="#view-jsp-form-label"><em>Binding form object to HTML form</em></a></li>
<li><a class="reference internal" href="#view-jsp-errors-label"><em>Displaying input validation errors</em></a></li>
<li><a class="reference internal" href="#view-jsp-resultmessages-label"><em>Displaying message of processing result</em></a></li>
<li><a class="reference internal" href="#view-jsp-codelist-label"><em>Displaying codelist</em></a></li>
<li><a class="reference internal" href="#view-jsp-message-label"><em>Displaying fixed text content</em></a></li>
<li><a class="reference internal" href="#view-jsp-if-label"><em>Switching display according to conditions</em></a></li>
<li><a class="reference internal" href="#view-jsp-foreach-label"><em>Repeated display of collection elements</em></a></li>
<li><a class="reference internal" href="#view-jsp-pagination-label"><em>Displaying link for pagination</em></a></li>
<li><a class="reference internal" href="#view-jsp-authorization-label"><em>Switching display according to authority</em></a></li>
</ul>
<p>In this chapter, usage of main JSP tag libraries are described. However, refer to respective documents for the detailed usage since all JSP tag libraries are not described here.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="30%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">JSP tag library name</th>
<th class="head">Document</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><ol class="first last arabic simple">
<li></li>
</ol>
</td>
<td>Spring&#8217;s form tag library</td>
<td><ul class="first last simple">
<li><a class="reference external" href="http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/view.html#view-jsp-formtaglib">http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/view.html#view-jsp-formtaglib</a></li>
<li><a class="reference external" href="http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/spring-form.tld.html">http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/spring-form.tld.html</a></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><ol class="first last arabic simple" start="2">
<li></li>
</ol>
</td>
<td>Spring&#8217;s tag library</td>
<td><ul class="first last simple">
<li><a class="reference external" href="http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/spring.tld.html">http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/spring.tld.html</a></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><ol class="first last arabic simple" start="3">
<li></li>
</ol>
</td>
<td>JSTL</td>
<td><ul class="first last simple">
<li><a class="reference external" href="http://download.oracle.com/otndocs/jcp/jstl-1.2-mrel2-eval-oth-JSpec/">http://download.oracle.com/otndocs/jcp/jstl-1.2-mrel2-eval-oth-JSpec/</a></li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>If terasoluna-gfw-web 1.0.0.RELEASE is being used, <tt class="docutils literal"><span class="pre">action</span></tt> tag must be always be specified while using <tt class="docutils literal"><span class="pre">&lt;form:form&gt;</span></tt> tag of Spring&#8217;s form tag library.</p>
<p>terasoluna-gfw-web 1.0.0.RELEASE has a dependency on Spring MVC(3.2.4.RELEASE). In this version of Spring MVC, if <tt class="docutils literal"><span class="pre">action</span></tt> attribute of <tt class="docutils literal"><span class="pre">&lt;form:form&gt;</span></tt> tag is not specified, it will
expose a vulnerability of XSS(Cross-site scripting).
For further details regarding the vulnerability, refer to <a class="reference external" href="http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2014-1904">CVE-2014-1904 of National Vulnerability Database (NVD)</a>.</p>
<p class="last">Also, terasoluna-gfw-web 1.0.1.RELEASE have been upgraded to Spring MVC(3.2.10.RELEASE and above); hence this vulnerability is not present.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="creating-common-jsp-for-include">
<span id="view-jsp-include-label"></span><h4><a class="toc-backref" href="#id80">4.3.3.1.1. Creating common JSP for include</a><a class="headerlink" href="#creating-common-jsp-for-include" title="Permalink to this headline">¶</a></h4>
<p>Create a JSP that contains directive declaration which are required by all the JSP files of the project.
By specifying this JSP in <tt class="docutils literal"><span class="pre">&lt;jsp-config&gt;/&lt;jsp-property-group&gt;/&lt;include-prelude&gt;</span></tt> element of <tt class="docutils literal"><span class="pre">web.xml</span></tt>, eliminates the need to declare these directives and each and every JSP file of thep project.
Further, this file is provided in blank project also.</p>
<ul class="simple">
<li>include.jsp</li>
</ul>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="hll"><span class="k">&lt;%@</span> <span class="n">taglib</span> <span class="n">uri</span><span class="o">=</span><span class="s">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&quot;c&quot;</span><span class="k">%&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span><span class="k">&lt;%@</span> <span class="n">taglib</span> <span class="n">uri</span><span class="o">=</span><span class="s">&quot;http://java.sun.com/jsp/jstl/fmt&quot;</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&quot;fmt&quot;</span><span class="k">%&gt;</span>

<span class="hll"><span class="k">&lt;%@</span> <span class="n">taglib</span> <span class="n">uri</span><span class="o">=</span><span class="s">&quot;http://www.springframework.org/tags&quot;</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&quot;spring&quot;</span><span class="k">%&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span><span class="k">&lt;%@</span> <span class="n">taglib</span> <span class="n">uri</span><span class="o">=</span><span class="s">&quot;http://www.springframework.org/tags/form&quot;</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&quot;form&quot;</span><span class="k">%&gt;</span>
<span class="k">&lt;%@</span> <span class="n">taglib</span> <span class="n">uri</span><span class="o">=</span><span class="s">&quot;http://www.springframework.org/security/tags&quot;</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&quot;sec&quot;</span><span class="k">%&gt;</span>

<span class="hll"><span class="k">&lt;%@</span> <span class="n">taglib</span> <span class="n">uri</span><span class="o">=</span><span class="s">&quot;http://terasoluna.org/functions&quot;</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&quot;f&quot;</span><span class="k">%&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">3</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span><span class="k">&lt;%@</span> <span class="n">taglib</span> <span class="n">uri</span><span class="o">=</span><span class="s">&quot;http://terasoluna.org/tags&quot;</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&quot;t&quot;</span><span class="k">%&gt;</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>web.xml</li>
</ul>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;jsp-config&gt;</span>
    <span class="nt">&lt;jsp-property-group&gt;</span>
        <span class="nt">&lt;url-pattern&gt;</span>*.jsp<span class="nt">&lt;/url-pattern&gt;</span>
        <span class="nt">&lt;el-ignored&gt;</span>false<span class="nt">&lt;/el-ignored&gt;</span>
        <span class="nt">&lt;page-encoding&gt;</span>UTF-8<span class="nt">&lt;/page-encoding&gt;</span>
        <span class="nt">&lt;scripting-invalid&gt;</span>false<span class="nt">&lt;/scripting-invalid&gt;</span>
<span class="hll">        <span class="nt">&lt;include-prelude&gt;</span>/WEB-INF/views/common/include.jsp<span class="nt">&lt;/include-prelude&gt;</span> <span class="c">&lt;!-- (4) --&gt;</span>
</span>    <span class="nt">&lt;/jsp-property-group&gt;</span>
<span class="nt">&lt;/jsp-config&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">JSP tag libraries of JSTL are declared. In this example, <tt class="docutils literal"><span class="pre">core</span></tt> and <tt class="docutils literal"><span class="pre">fmt</span></tt> are used.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">JSP tag libraries of Spring Framework are declared. In this example, <tt class="docutils literal"><span class="pre">spring</span></tt>, <tt class="docutils literal"><span class="pre">form</span></tt> and <tt class="docutils literal"><span class="pre">sec</span></tt> are used.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">JSP tag libraries provided by common library are declared.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">JSP which is specified at the top of <tt class="docutils literal"><span class="pre">*.jsp</span></tt> (extension is jsp) has been included (<tt class="docutils literal"><span class="pre">/WEB-INF/views/common/include.jsp</span></tt>).</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Refer to <tt class="docutils literal"><span class="pre">JSP.1.10</span> <span class="pre">Directives</span></tt> of <a class="reference external" href="http://download.oracle.com/otndocs/jcp/jsp-2.2-mrel-eval-oth-JSpec/">JavaServer Pages Specification(Version2.2)</a>for details of directives.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Refer to <tt class="docutils literal"><span class="pre">JSP.3.3</span> <span class="pre">JSP</span> <span class="pre">Property</span> <span class="pre">Groups</span></tt> of <a class="reference external" href="http://download.oracle.com/otndocs/jcp/jsp-2.2-mrel-eval-oth-JSpec/">JavaServer Pages Specification(Version2.2)</a>for details of &lt;jsp-property-group&gt; element.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="displaying-value-stored-in-model">
<span id="view-jsp-out-label"></span><h4><a class="toc-backref" href="#id81">4.3.3.1.2. Displaying value stored in model</a><a class="headerlink" href="#displaying-value-stored-in-model" title="Permalink to this headline">¶</a></h4>
<p>To display the value stored in <tt class="docutils literal"><span class="pre">Model</span></tt> (form object or domain object) in HTML, use EL expressions or JSP tag libraries provided by JSTL.</p>
<p>Display using EL expressions.</p>
<ul class="simple">
<li>SampleController.java</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&quot;hello&quot;</span><span class="o">)</span>
<span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">(</span><span class="n">Model</span> <span class="n">model</span><span class="o">)</span> <span class="o">{</span>
<span class="hll">    <span class="n">model</span><span class="o">.</span><span class="na">addAttribute</span><span class="o">(</span><span class="k">new</span> <span class="n">HelloBean</span><span class="o">(</span><span class="s">&quot;Bean Hello World!&quot;</span><span class="o">));</span> <span class="c1">// (1)</span>
</span>    <span class="k">return</span> <span class="s">&quot;sample/hello&quot;</span><span class="o">;</span> <span class="c1">// returns view name</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>hello.jsp</li>
</ul>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="hll">Message : ${f:h(helloBean.message)} <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span></pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a href="#id16"><span class="problematic" id="id17">|</span></a>(1)</td>
<td><div class="first last line-block">
<div class="line">Add <tt class="docutils literal"><span class="pre">HelloBean</span></tt>object to <tt class="docutils literal"><span class="pre">Model</span></tt>object.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">In View(JSP), data added to the <tt class="docutils literal"><span class="pre">Model</span></tt>object can be retrieved by describing <tt class="docutils literal"><span class="pre">${Attribute</span> <span class="pre">name.Property</span> <span class="pre">name</span> <span class="pre">of</span> <span class="pre">JavaBean}</span></tt>.</div>
<div class="line">In this example, HTML escaping is performed using <tt class="docutils literal"><span class="pre">${f:h(Attribute</span> <span class="pre">name.Property</span> <span class="pre">name</span> <span class="pre">of</span> <span class="pre">JavaBean)}</span></tt> function of EL expression.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Since HTML escaping function (<tt class="docutils literal"><span class="pre">f:h</span></tt>) is provided in the common components, always use it if EL expressions are used to output values in HTML.
For details of function of EL expression that perform HTML escaping, refer to <a class="reference internal" href="../Security/XSS.html"><em>Cross Site Scripting</em></a>.</p>
</div>
</div></blockquote>
<p>Display using <tt class="docutils literal"><span class="pre">&lt;c:out&gt;</span></tt> tag provided by JSP tag library of JSTL.</p>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="hll">Message : <span class="nt">&lt;c:out</span> <span class="na">value=</span><span class="s">&quot;${helloBean.message}&quot;</span> <span class="nt">/&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span></pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify the values fetched using EL expressions in <tt class="docutils literal"><span class="pre">value</span></tt> attribute of <tt class="docutils literal"><span class="pre">&lt;c:out&gt;</span></tt> tag. HTML escaping is also performed.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Refer to <tt class="docutils literal"><span class="pre">CHAPTER</span> <span class="pre">4</span> <span class="pre">General-Purpose</span> <span class="pre">Actions</span></tt> of <a class="reference external" href="http://download.oracle.com/otndocs/jcp/jstl-1.2-mrel2-eval-oth-JSpec/">JavaServer Pages Standard Tag Library(Version 1.2)</a>for the details of <tt class="docutils literal"><span class="pre">&lt;c:out&gt;</span></tt>.</p>
</div>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="displaying-numbers-stored-in-model">
<span id="view-jsp-outnumber-label"></span><h4><a class="toc-backref" href="#id82">4.3.3.1.3. Displaying numbers stored in model</a><a class="headerlink" href="#displaying-numbers-stored-in-model" title="Permalink to this headline">¶</a></h4>
<p>Use JSP tag library provided by JSTL to output format number.</p>
<div class="line-block">
<div class="line">Display using <tt class="docutils literal"><span class="pre">&lt;fmt:formatNumber&gt;</span></tt> tag provided by JSP tag library of JSTL.</div>
</div>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="hll">Number Item : <span class="nt">&lt;fmt:formatNumber</span> <span class="na">value=</span><span class="s">&quot;${helloBean.numberItem}&quot;</span> <span class="na">pattern=</span><span class="s">&quot;0.00&quot;</span> <span class="nt">/&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span></pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify the value acquired by EL expressions in  the value attribute of <tt class="docutils literal"><span class="pre">&lt;fmt:formatNumber&gt;</span></tt> tag. Specify the format to be displayed in pattern attribute. For example, &#8220;<tt class="docutils literal"><span class="pre">0.00</span></tt>&#8221; is specified .</div>
<div class="line">When the value acquired in <tt class="docutils literal"><span class="pre">${helloBean.numberItem}</span></tt> is &#8220;<tt class="docutils literal"><span class="pre">1.2</span></tt>&#8221; temporarily, &#8220;<tt class="docutils literal"><span class="pre">1.20</span></tt>&#8221; is displayed on the screen.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Refer to <tt class="docutils literal"><span class="pre">CHAPTER</span> <span class="pre">9</span> <span class="pre">Formatting</span> <span class="pre">Actions</span></tt> of <a class="reference external" href="http://download.oracle.com/otndocs/jcp/jstl-1.2-mrel2-eval-oth-JSpec/">JavaServer Pages Standard Tag Library(Version 1.2)</a>for the details of <tt class="docutils literal"><span class="pre">&lt;fmt:formatNumber&gt;</span></tt>.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="displaying-date-and-time-stored-in-model">
<span id="view-jsp-outdate-label"></span><h4><a class="toc-backref" href="#id83">4.3.3.1.4. Displaying date and time stored in model</a><a class="headerlink" href="#displaying-date-and-time-stored-in-model" title="Permalink to this headline">¶</a></h4>
<p>Use JSP tag library provided by JSTL to output format date and time value.</p>
<p><a href="#id19"><span class="problematic" id="id20">|</span></a>Display using <tt class="docutils literal"><span class="pre">&lt;fmt:formatDate&gt;</span></tt> tag provided by JSP tag library of JSTL.</p>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="hll">Date Item : <span class="nt">&lt;fmt:formatDate</span> <span class="na">value=</span><span class="s">&quot;${helloBean.dateItem}&quot;</span> <span class="na">pattern=</span><span class="s">&quot;yyyy-MM-dd&quot;</span> <span class="nt">/&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span></pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify the value fetched using EL expression in <tt class="docutils literal"><span class="pre">value</span></tt> attribute of <tt class="docutils literal"><span class="pre">&lt;fmt:formatDate&gt;</span></tt> tag. Specify the format to be displayed in <tt class="docutils literal"><span class="pre">pattern</span></tt> attribute. In this example, &#8220;<tt class="docutils literal"><span class="pre">yyyy-MM-dd</span></tt>&#8221; is specified.</div>
<div class="line">When value recieved for <tt class="docutils literal"><span class="pre">${helloBean.dateItem}</span></tt> is 2013-3-2, &#8220;<tt class="docutils literal"><span class="pre">2013-03-02</span></tt>&#8221; is displayed on the screen.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Refer to <tt class="docutils literal"><span class="pre">CHAPTER</span> <span class="pre">9</span> <span class="pre">Formatting</span> <span class="pre">Actions</span></tt> of <a class="reference external" href="http://download.oracle.com/otndocs/jcp/jstl-1.2-mrel2-eval-oth-JSpec/">JavaServer Pages Standard Tag Library(Version 1.2)</a> for details of <tt class="docutils literal"><span class="pre">&lt;fmt:formatDate&gt;</span></tt>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">JSP tag library provided by Joda Time should be used to use <tt class="docutils literal"><span class="pre">org.joda.time.DateTime</span></tt> as date and time object type.
Refer to <a class="reference internal" href="../ArchitectureInDetail/Utilities/JodaTime.html"><em>Date Operations (Joda Time)</em></a>  for the details of Joda Time.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="binding-form-object-to-html-form">
<span id="view-jsp-form-label"></span><h4><a class="toc-backref" href="#id84">4.3.3.1.5. Binding form object to HTML form</a><a class="headerlink" href="#binding-form-object-to-html-form" title="Permalink to this headline">¶</a></h4>
<p>Use JSP tag library provided by Spring Framework to bind form object to HTML form and to display the values stored in form object.</p>
<p>Bind using <tt class="docutils literal"><span class="pre">&lt;form:form&gt;</span></tt> tag provided by Spring Framework.</p>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="nt">&lt;form:form</span> <span class="na">action=</span><span class="s">&quot;${pageContext.request.contextPath}/sample/hello&quot;</span>
<span class="hll">           <span class="na">modelAttribute=</span><span class="s">&quot;sampleForm&quot;</span><span class="nt">&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span><span class="hll">    Id : <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;id&quot;</span> <span class="nt">/&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span><span class="nt">&lt;/form:form&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Specify attribute name of form object stored in <tt class="docutils literal"><span class="pre">Model</span></tt>in <tt class="docutils literal"><span class="pre">modelAttribute</span></tt> atttribute of <tt class="docutils literal"><span class="pre">&lt;form:form&gt;</span></tt>tag.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Specify name of property to bind in the <tt class="docutils literal"><span class="pre">path</span></tt> attribute of <tt class="docutils literal"><span class="pre">&lt;form:xxx&gt;</span></tt> tag. <tt class="docutils literal"><span class="pre">xxx</span></tt> part changes along with each input element.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Refer to <a class="reference external" href="http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/view.html#view-jsp-formtaglib">Using Spring&#8217;s form tag library</a>for the details of <tt class="docutils literal"><span class="pre">&lt;form:form&gt;</span></tt>, <tt class="docutils literal"><span class="pre">&lt;form:xxx&gt;</span></tt>.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="displaying-input-validation-errors">
<span id="view-jsp-errors-label"></span><h4><a class="toc-backref" href="#id85">4.3.3.1.6. Displaying input validation errors</a><a class="headerlink" href="#displaying-input-validation-errors" title="Permalink to this headline">¶</a></h4>
<p>To display the contents of input validation error, use JSP tag library provided by Spring Framework.</p>
<div class="line-block">
<div class="line">Display using <tt class="docutils literal"><span class="pre">&lt;form:errors&gt;</span></tt> tag provided by Spring Framework.</div>
<div class="line">Refer to <a class="reference internal" href="../ArchitectureInDetail/Validation.html"><em>Input Validation</em></a> for details.</div>
</div>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="nt">&lt;form:form</span> <span class="na">action=</span><span class="s">&quot;${pageContext.request.contextPath}/sample/hello&quot;</span>
           <span class="na">modelAttribute=</span><span class="s">&quot;sampleForm&quot;</span><span class="nt">&gt;</span>
<span class="hll">    Id : <span class="nt">&lt;form:input</span> <span class="na">path=</span><span class="s">&quot;id&quot;</span> <span class="nt">/&gt;&lt;form:errors</span> <span class="na">path=</span><span class="s">&quot;id&quot;</span> <span class="nt">/&gt;</span><span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span><span class="nt">&lt;/form:form&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify name of the property to display the error in <tt class="docutils literal"><span class="pre">path</span></tt> attribute of <tt class="docutils literal"><span class="pre">&lt;form:errors&gt;</span></tt>tag.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="displaying-message-of-processing-result">
<span id="view-jsp-resultmessages-label"></span><h4><a class="toc-backref" href="#id86">4.3.3.1.7. Displaying message of processing result</a><a class="headerlink" href="#displaying-message-of-processing-result" title="Permalink to this headline">¶</a></h4>
<p>To display the message notifying the output of processing the request, use JSP tag library provided in common components.</p>
<div class="line-block">
<div class="line">Use <tt class="docutils literal"><span class="pre">&lt;t:messagesPanel&gt;</span></tt> tag provided in common components.</div>
<div class="line">Refer to <a class="reference internal" href="../ArchitectureInDetail/MessageManagement.html"><em>Message Management</em></a>  for details.</div>
</div>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;messages&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;h2&gt;</span>Message pattern<span class="nt">&lt;/h2&gt;</span>
<span class="hll">    <span class="nt">&lt;t:messagesPanel</span> <span class="nt">/&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span><span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Messages stored with attribute name &#8220;<tt class="docutils literal"><span class="pre">resultMessages</span></tt>&#8221; are output.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="displaying-codelist">
<span id="view-jsp-codelist-label"></span><h4><a class="toc-backref" href="#id87">4.3.3.1.8. Displaying codelist</a><a class="headerlink" href="#displaying-codelist" title="Permalink to this headline">¶</a></h4>
<p>To display the codelist (provided in common components), use JSP tag library provided by Spring Framework.</p>
<div class="line-block">
<div class="line">Codelist can be referred from JSP in the same way as <tt class="docutils literal"><span class="pre">java.util.Map</span></tt> interface.</div>
<div class="line">Refer to <a class="reference internal" href="../ArchitectureInDetail/Codelist.html"><em>Codelist</em></a>  for details.</div>
</div>
<p>Display codelist in select box.</p>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="nt">&lt;form:select</span> <span class="na">path=</span><span class="s">&quot;orderStatus&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;form:option</span> <span class="na">value=</span><span class="s">&quot;&quot;</span> <span class="na">label=</span><span class="s">&quot;--Select--&quot;</span> <span class="nt">/&gt;</span>
<span class="hll">    <span class="nt">&lt;form:options</span> <span class="na">items=</span><span class="s">&quot;${CL_ORDERSTATUS}&quot;</span> <span class="nt">/&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span><span class="nt">&lt;/form:select&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Codelist (<tt class="docutils literal"><span class="pre">java.util.Map</span></tt> interface) is stored with name (<tt class="docutils literal"><span class="pre">&quot;CL_ORDERSTATUS&quot;</span></tt>) as attribute name.
Therefore, in JSP, codelist (<tt class="docutils literal"><span class="pre">java.util.Map</span></tt> interface) can be accessed using EL expression.
Codelist can be displayed in select box by passing the object of <tt class="docutils literal"><span class="pre">Map</span></tt> interface to <tt class="docutils literal"><span class="pre">items</span></tt> attribute of <tt class="docutils literal"><span class="pre">&lt;form:options&gt;</span></tt>.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Label part is displayed on the screen for the value selected in select box.</p>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre>Order Status : ${f:h(CL_ORDERSTATUS[orderForm.orderStatus])}
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>In the same way as in case of creating select box, Codelist (<tt class="docutils literal"><span class="pre">java.util.Map</span></tt> interface) is stored with name (<tt class="docutils literal"><span class="pre">&quot;CL_ORDERSTATUS&quot;</span></tt>) as attribute name.
If value selected in select box is specified as key of the fetched <tt class="docutils literal"><span class="pre">Map</span></tt> interface, its possible to display the code name.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="displaying-fixed-text-content">
<span id="view-jsp-message-label"></span><h4><a class="toc-backref" href="#id88">4.3.3.1.9. Displaying fixed text content</a><a class="headerlink" href="#displaying-fixed-text-content" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">Strings for screen name, element name and guidance etc can be directly written in JSP when internationalization is not required.</div>
<div class="line">However, when internationalization is required, display the values acquired from property file using JSP tag library provided by Spring Framework.</div>
</div>
<div class="line-block">
<div class="line">Display using <tt class="docutils literal"><span class="pre">&lt;spring:message&gt;</span></tt> tag provided by Spring Framework.</div>
<div class="line">Refer to <a class="reference internal" href="../ArchitectureInDetail/Internationalization.html"><em>Internationalization</em></a>  for details.</div>
</div>
<ul class="simple">
<li>properties</li>
</ul>
<blockquote>
<div><div class="highlight-properties"><div class="highlight"><pre><span class="hll"><span class="c"># (1)</span>
</span><span class="hll"><span class="na">label.orderStatus</span><span class="o">=</span><span class="s">Order status</span>
</span></pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>jsp</li>
</ul>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="hll"><span class="nt">&lt;spring:message</span> <span class="na">code=</span><span class="s">&quot;label.orderStatus&quot;</span> <span class="na">text=</span><span class="s">&quot;Order Status&quot;</span> <span class="nt">/&gt;</span> : <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span>    ${f:h(CL_ORDERSTATUS[orderForm.orderStatus])}
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Define the string of label in properties file.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>If key in the properties file is specified in <tt class="docutils literal"><span class="pre">code</span></tt> attribute of <tt class="docutils literal"><span class="pre">&lt;spring:message&gt;</span></tt>, string corresponding to the key is displayed.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The value specified in <tt class="docutils literal"><span class="pre">text</span></tt> attribute is displayed when property value could not be acquired.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="switching-display-according-to-conditions">
<span id="view-jsp-if-label"></span><h4><a class="toc-backref" href="#id89">4.3.3.1.10. Switching display according to conditions</a><a class="headerlink" href="#switching-display-according-to-conditions" title="Permalink to this headline">¶</a></h4>
<p>When display is to be switched according to some value in model, use JSP tag library provided by JSTL.</p>
<p>Switch display using <tt class="docutils literal"><span class="pre">&lt;c:if&gt;</span></tt> tag or <tt class="docutils literal"><span class="pre">&lt;c:choose&gt;</span></tt> provided by JSP tag library of JSTL.</p>
<p>Switching display by using <tt class="docutils literal"><span class="pre">&lt;c:if&gt;</span></tt>.</p>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="hll"><span class="nt">&lt;c:if</span> <span class="na">test=</span><span class="s">&quot;${orderForm.orderStatus != &#39;complete&#39;}&quot;</span><span class="nt">&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span>        <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">...</span> <span class="o">--</span><span class="k">%&gt;</span>
<span class="nt">&lt;/c:if&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Put the condition for entering the branch in <tt class="docutils literal"><span class="pre">test</span></tt> attribute of <tt class="docutils literal"><span class="pre">&lt;c:if&gt;</span></tt>. In this example, when order status is not <tt class="docutils literal"><span class="pre">'complete'</span></tt>, the contents of the branch will be displayed.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Switching display using <tt class="docutils literal"><span class="pre">&lt;c:choose&gt;</span></tt>.</p>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="nt">&lt;c:choose&gt;</span>
<span class="hll">    <span class="nt">&lt;c:when</span> <span class="na">test=</span><span class="s">&quot;${customer.type == &#39;premium&#39;}&quot;</span><span class="nt">&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span>        <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">...</span> <span class="o">--</span><span class="k">%&gt;</span>
    <span class="nt">&lt;/c:when&gt;</span>
    <span class="nt">&lt;c:when</span> <span class="na">test=</span><span class="s">&quot;${customer.type == &#39;general&#39;}&quot;</span><span class="nt">&gt;</span>
        <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">...</span> <span class="o">--</span><span class="k">%&gt;</span>
    <span class="nt">&lt;/c:when&gt;</span>
<span class="hll">    <span class="nt">&lt;c:otherwise&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span>        <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">...</span> <span class="o">--</span><span class="k">%&gt;</span>
    <span class="nt">&lt;/c:otherwise&gt;</span>
<span class="nt">&lt;/c:choose&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Put the condition for entering the branch in <tt class="docutils literal"><span class="pre">test</span></tt> attribute of <tt class="docutils literal"><span class="pre">&lt;c:when&gt;</span></tt>. In this example, when customer type is <tt class="docutils literal"><span class="pre">'premium'</span></tt>, the contents of the branch will be displayed.
When condition specified in <tt class="docutils literal"><span class="pre">test</span></tt> attribute is <tt class="docutils literal"><span class="pre">false</span></tt>, next <tt class="docutils literal"><span class="pre">&lt;c:when&gt;</span></tt> tag is processed.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>When result of <tt class="docutils literal"><span class="pre">test</span></tt> attribute of all <tt class="docutils literal"><span class="pre">&lt;c:when&gt;</span></tt> tags is <tt class="docutils literal"><span class="pre">false</span></tt>, <tt class="docutils literal"><span class="pre">&lt;c:otherwise&gt;</span></tt> tag is evaluated.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Refer to <tt class="docutils literal"><span class="pre">CHAPTER</span> <span class="pre">5</span> <span class="pre">Conditional</span> <span class="pre">Actions</span></tt> of <a class="reference external" href="http://download.oracle.com/otndocs/jcp/jstl-1.2-mrel2-eval-oth-JSpec/">JavaServer Pages Standard Tag Library(Version 1.2)</a>for details.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="repeated-display-of-collection-elements">
<span id="view-jsp-foreach-label"></span><h4><a class="toc-backref" href="#id90">4.3.3.1.11. Repeated display of collection elements</a><a class="headerlink" href="#repeated-display-of-collection-elements" title="Permalink to this headline">¶</a></h4>
<p>To repeat display of collection stored in model, use JSP tag library provided by JSTL.</p>
<p>Repeated display can be done using <tt class="docutils literal"><span class="pre">&lt;c:forEach&gt;</span></tt> provided by JSP tag library of JSTL.</p>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="nt">&lt;table&gt;</span>
    <span class="nt">&lt;tr&gt;</span>
        <span class="nt">&lt;th&gt;</span>No<span class="nt">&lt;/th&gt;</span>
        <span class="nt">&lt;th&gt;</span>Name<span class="nt">&lt;/th&gt;</span>
    <span class="nt">&lt;/tr&gt;</span>
<span class="hll">    <span class="nt">&lt;c:forEach</span> <span class="na">var=</span><span class="s">&quot;customer&quot;</span> <span class="na">items=</span><span class="s">&quot;${customers}&quot;</span> <span class="na">varStatus=</span><span class="s">&quot;status&quot;</span><span class="nt">&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">1</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span>        <span class="nt">&lt;tr&gt;</span>
<span class="hll">            <span class="nt">&lt;td&gt;</span>${status.count}<span class="nt">&lt;/td&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">2</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span><span class="hll">            <span class="nt">&lt;td&gt;</span>${f:h(customer.name)}<span class="nt">&lt;/td&gt;</span> <span class="k">&lt;%-</span><span class="o">-</span> <span class="o">(</span><span class="mi">3</span><span class="o">)</span> <span class="o">--</span><span class="k">%&gt;</span>
</span>        <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;/c:forEach&gt;</span>
<span class="nt">&lt;/table&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>By specifying the collection object in <tt class="docutils literal"><span class="pre">items</span></tt> attribute of <tt class="docutils literal"><span class="pre">&lt;c:forEach&gt;</span></tt> tag, <tt class="docutils literal"><span class="pre">&lt;c:forEach&gt;</span></tt> tag is repeatedly executed to iterate over the collection.
While iterating over the collection, if the current element is to be referred inside <tt class="docutils literal"><span class="pre">&lt;c:forEach&gt;</span></tt> tag, it can be done by specifying a variable name for the
current element in <tt class="docutils literal"><span class="pre">var</span></tt> attribute.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>By specifying a variable name in <tt class="docutils literal"><span class="pre">varStatus</span></tt> attribute,  current position (count) of iteration in <tt class="docutils literal"><span class="pre">&lt;c:forEach&gt;</span></tt>  tag can be fetched.
Refer to <a class="reference external" href="http://download.oracle.com/otndocs/jcp/jstl-1.2-mrel2-eval-oth-JSpec/">JavaDoc</a>of <tt class="docutils literal"><span class="pre">javax.servlet.jsp.jstl.core.LoopTagStatus</span></tt> for attributes other than count.</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td>This is the value acquired from the object stored in variable specified by <tt class="docutils literal"><span class="pre">var</span></tt> attribute of <tt class="docutils literal"><span class="pre">&lt;c:forEach&gt;</span></tt> tag.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Refer to <tt class="docutils literal"><span class="pre">CHAPTER</span> <span class="pre">6</span> <span class="pre">Iterator</span> <span class="pre">Actions</span></tt> of <a class="reference external" href="http://download.oracle.com/otndocs/jcp/jstl-1.2-mrel2-eval-oth-JSpec/">JavaServer Pages Standard Tag Library(Version 1.2)</a>for details.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="displaying-link-for-pagination">
<span id="view-jsp-pagination-label"></span><h4><a class="toc-backref" href="#id91">4.3.3.1.12. Displaying link for pagination</a><a class="headerlink" href="#displaying-link-for-pagination" title="Permalink to this headline">¶</a></h4>
<p>To display links of pagination on the screen while displaying the list, use JSP tag library provided in common components.</p>
<p>Display the link for pagination using <tt class="docutils literal"><span class="pre">&lt;t:pagination&gt;</span></tt> provided in common components.
Refer to <a class="reference internal" href="../ArchitectureInDetail/Pagination.html"><em>Pagination</em></a>  for details.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="switching-display-according-to-authority">
<span id="view-jsp-authorization-label"></span><h4><a class="toc-backref" href="#id92">4.3.3.1.13. Switching display according to authority</a><a class="headerlink" href="#switching-display-according-to-authority" title="Permalink to this headline">¶</a></h4>
<p>To switch display according to authority of the user who has logged in, use JSP tag library provided by Spring Security.</p>
<p>Switch display using <tt class="docutils literal"><span class="pre">&lt;sec:authorize&gt;</span></tt> provided by Spring Security.
Refer to <a class="reference internal" href="../Security/Authorization.html"><em>Authorization</em></a>  for details.</p>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="implementing-javascript">
<h3><a class="toc-backref" href="#id93">4.3.3.2. Implementing JavaScript</a><a class="headerlink" href="#implementing-javascript" title="Permalink to this headline">¶</a></h3>
<p>When it is necessary to control screen items (controls of hide/display, activate/deactivate, etc.) after screen rendering, control items using JavaScript.</p>
<div class="admonition-todo admonition" id="index-1">
<p class="first admonition-title">Todo</p>
<p><strong>TBD</strong></p>
<p class="last">Details will be included in the coming versions.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="implementing-style-sheet">
<h3><a class="toc-backref" href="#id94">4.3.3.3. Implementing style sheet</a><a class="headerlink" href="#implementing-style-sheet" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">It is recommended to specify attribute values related to screen design in style sheet (css file) and not in JSP(HTML) directly.</div>
<div class="line">In JSP(HTML), specify <tt class="docutils literal"><span class="pre">id</span></tt> attribute to identify the items uniquely and <tt class="docutils literal"><span class="pre">class</span></tt> attribute which indicates classification of elements.</div>
<div class="line">While, specify values related to actual location of elements or appearance should be specified in style sheet (css file).</div>
<div class="line">By configuring in this way, it is possible to reduce the design related aspects from the implementation of JSP.</div>
<div class="line">Simultaneously, if there is any change in design, only style sheet (css file) is modified and not JSP.</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When form is created using <tt class="docutils literal"><span class="pre">&lt;form:xxx&gt;</span></tt>, <tt class="docutils literal"><span class="pre">id</span></tt> attribute will be set automatically. Application developer should specify <tt class="docutils literal"><span class="pre">class</span></tt> attribute.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="implementing-common-logic">
<h2><a class="toc-backref" href="#id95">4.3.4. Implementing common logic</a><a class="headerlink" href="#implementing-common-logic" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="implementing-common-logic-to-be-executed-before-and-after-calling-controller">
<h3><a class="toc-backref" href="#id96">4.3.4.1. Implementing common logic to be executed before and after calling controller</a><a class="headerlink" href="#implementing-common-logic-to-be-executed-before-and-after-calling-controller" title="Permalink to this headline">¶</a></h3>
<p>Here, common logic indicates processes which are required to be executed before and after execution the controller.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="implementing-servlet-filter">
<h4><a class="toc-backref" href="#id97">4.3.4.1.1. Implementing Servlet Filter</a><a class="headerlink" href="#implementing-servlet-filter" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">Common processes independent of Spring MVC are implemented using Servlet Filter.</div>
<div class="line">However, when common processes are to be executed only for the certain requests mapped with processing method of controller,</div>
<div class="line">then it should be implemented using Handler Interceptor and not Servlet Filter.</div>
</div>
<div class="line-block">
<div class="line">Samples of Servlet Filter are given below.</div>
<div class="line">In sample code, value is stored in <tt class="docutils literal"><span class="pre">MDC</span></tt> in order to output the log of IP address of client.</div>
</div>
<ul class="simple">
<li>java</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ClientInfoPutFilter</span> <span class="kd">extends</span> <span class="n">OncePerRequestFilter</span> <span class="o">{</span> <span class="c1">// (1)</span>
</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">ATTRIBUTE_NAME</span> <span class="o">=</span> <span class="s">&quot;X-Forwarded-For&quot;</span><span class="o">;</span>
    <span class="kd">protected</span> <span class="kd">final</span> <span class="kt">void</span> <span class="nf">doFilterInternal</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span>
            <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span> <span class="n">FilterChain</span> <span class="n">filterChain</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">ServletException</span><span class="o">,</span> <span class="n">IOException</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">remoteIp</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getHeader</span><span class="o">(</span><span class="n">ATTRIBUTE_NAME</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">remoteIp</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">remoteIp</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getRemoteAddr</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="n">MDC</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">ATTRIBUTE_NAME</span><span class="o">,</span> <span class="n">remoteIp</span><span class="o">);</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">filterChain</span><span class="o">.</span><span class="na">doFilter</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
            <span class="n">MDC</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">ATTRIBUTE_NAME</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>web.xml</li>
</ul>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span class="hll"><span class="nt">&lt;filter&gt;</span> <span class="c">&lt;!-- (2) --&gt;</span>
</span>    <span class="nt">&lt;filter-name&gt;</span>clientInfoPutFilter<span class="nt">&lt;/filter-name&gt;</span>
    <span class="nt">&lt;filter-class&gt;</span>x.y.z.ClientInfoPutFilter<span class="nt">&lt;/filter-class&gt;</span>
<span class="nt">&lt;/filter&gt;</span>
<span class="hll"><span class="nt">&lt;filter-mapping&gt;</span> <span class="c">&lt;!-- (3) --&gt;</span>
</span>    <span class="nt">&lt;filter-name&gt;</span>clientInfoPutFilter<span class="nt">&lt;/filter-name&gt;</span>
    <span class="nt">&lt;url-pattern&gt;</span>/*<span class="nt">&lt;/url-pattern&gt;</span>
<span class="nt">&lt;/filter-mapping&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>In sample, it is guaranteed that it is executed only once for similar requests by creating the Servlet Filter as subclass
of <tt class="docutils literal"><span class="pre">org.springframework.web.filter.OncePerRequestFilter</span></tt> provided by Spring Framework.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Register the created Servlet Filter in <tt class="docutils literal"><span class="pre">web.xml</span></tt>.</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td>Specify URL pattern to apply the registered Servlet Filter.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Servlet Filter can also be defined as Bean of Spring Framework.</p>
<ul class="simple">
<li>web.xml</li>
</ul>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;filter&gt;</span>
    <span class="nt">&lt;filter-name&gt;</span>clientInfoPutFilter<span class="nt">&lt;/filter-name&gt;</span>
<span class="hll">    <span class="nt">&lt;filter-class&gt;</span>org.springframework.web.filter.DelegatingFilterProxy<span class="nt">&lt;/filter-class&gt;</span> <span class="c">&lt;!-- (1) --&gt;</span>
</span><span class="nt">&lt;/filter&gt;</span>
<span class="nt">&lt;filter-mapping&gt;</span>
    <span class="nt">&lt;filter-name&gt;</span>clientInfoPutFilter<span class="nt">&lt;/filter-name&gt;</span>
    <span class="nt">&lt;url-pattern&gt;</span>/*<span class="nt">&lt;/url-pattern&gt;</span>
<span class="nt">&lt;/filter-mapping&gt;</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>applicationContext.xml</li>
</ul>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span class="hll"><span class="nt">&lt;bean</span> <span class="na">id=</span><span class="s">&quot;clientInfoPutFilter&quot;</span> <span class="na">class=</span><span class="s">&quot;x.y.z.ClientInfoPutFilter&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (2) --&gt;</span>
</span></pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>In sample, process is delegated to Servlet Filter defined in step (2) by specifying <tt class="docutils literal"><span class="pre">org.springframework.web.filter.DelegatingFilterProxy</span></tt>
provided by Spring Framework in Servlet Filter class.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Add the Servlet Filter class to Bean definition file (<tt class="docutils literal"><span class="pre">applicationContext.xml</span></tt>).
At this time, <tt class="docutils literal"><span class="pre">id</span></tt> attribute of bean definition should be assigned with the filter name (value specified in <tt class="docutils literal"><span class="pre">&lt;filter-name&gt;</span></tt> tag) specified in <tt class="docutils literal"><span class="pre">web.xml</span></tt>.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="implementing-handlerinterceptor">
<h4><a class="toc-backref" href="#id98">4.3.4.1.2. Implementing HandlerInterceptor</a><a class="headerlink" href="#implementing-handlerinterceptor" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">Common processes dependent on Spring MVC are implemented using HandlerInterceptor.</div>
<div class="line">HandlerInterceptor can execute common processes only for the requests which are allowed by the application since it is called after the determining the processing method</div>
<div class="line">to which the request is to be mapped to.</div>
</div>
<p>HandlerInterceptor can execute the process keeping in mind the following 3 points.</p>
<ul>
<li><div class="first line-block">
<div class="line">Before executing processing method of controller</div>
<div class="line">Implemented as <tt class="docutils literal"><span class="pre">HandlerInterceptor#preHandle</span></tt> method.</div>
</div>
</li>
<li><div class="first line-block">
<div class="line">After successfully executing processing method of controller</div>
<div class="line">Implemented as <tt class="docutils literal"><span class="pre">HandlerInterceptor#postHandle</span></tt> method.</div>
</div>
</li>
<li><div class="first line-block">
<div class="line">After completion of processing method of controller (executed irrespective of Normal / Abnormal)</div>
<div class="line">Implemented as <tt class="docutils literal"><span class="pre">HandlerInterceptor#afterCompletion</span></tt> method.</div>
</div>
</li>
</ul>
<div class="line-block">
<div class="line">Sample of HandlerInterceptor is given below.</div>
<div class="line">In sample code, log of info level is output after successfully executing controller process.</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SuccessLoggingInterceptor</span> <span class="kd">extends</span> <span class="n">HandlerInterceptorAdapter</span> <span class="o">{</span> <span class="c1">// (1)</span>
</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Logger</span> <span class="n">logger</span> <span class="o">=</span> <span class="n">LoggerFactory</span>
            <span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="n">SuccessLoggingInterceptor</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">postHandle</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span>
            <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span> <span class="n">Object</span> <span class="n">handler</span><span class="o">,</span>
            <span class="n">ModelAndView</span> <span class="n">modelAndView</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
        <span class="n">HandlerMethod</span> <span class="n">handlerMethod</span> <span class="o">=</span> <span class="o">(</span><span class="n">HandlerMethod</span><span class="o">)</span> <span class="n">handler</span><span class="o">;</span>
        <span class="n">Method</span> <span class="n">m</span> <span class="o">=</span> <span class="n">handlerMethod</span><span class="o">.</span><span class="na">getMethod</span><span class="o">();</span>
        <span class="n">logger</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">&quot;[SUCCESS CONTROLLER] {}.{}&quot;</span><span class="o">,</span> <span class="k">new</span> <span class="n">Object</span><span class="o">[]</span> <span class="o">{</span>
                <span class="n">m</span><span class="o">.</span><span class="na">getDeclaringClass</span><span class="o">().</span><span class="na">getSimpleName</span><span class="o">(),</span> <span class="n">m</span><span class="o">.</span><span class="na">getName</span><span class="o">()});</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>spring-mvc.xml</li>
</ul>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;mvc:interceptors&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>
    <span class="nt">&lt;mvc:interceptor&gt;</span>
<span class="hll">        <span class="nt">&lt;mvc:mapping</span> <span class="na">path=</span><span class="s">&quot;/**&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (2) --&gt;</span>
</span><span class="hll">        <span class="nt">&lt;mvc:exclude-mapping</span> <span class="na">path=</span><span class="s">&quot;/resources/**&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (3) --&gt;</span>
</span>        <span class="nt">&lt;mvc:exclude-mapping</span> <span class="na">path=</span><span class="s">&quot;/**/*.html&quot;</span> <span class="nt">/&gt;</span>
<span class="hll">        <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;x.y.z.SuccessLoggingInterceptor&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (4) --&gt;</span>
</span>    <span class="nt">&lt;/mvc:interceptor&gt;</span>
    <span class="c">&lt;!-- ... --&gt;</span>
<span class="nt">&lt;/mvc:interceptors&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>In sample, HandlerInterceptor is created as the subclass of <tt class="docutils literal"><span class="pre">org.springframework.web.servlet.handler.HandlerInterceptorAdapter</span></tt> provided by Spring Framework.
Since <tt class="docutils literal"><span class="pre">HandlerInterceptorAdapter</span></tt> provides blank implementation of <tt class="docutils literal"><span class="pre">HandlerInterceptor</span></tt> interface, it is not required to implement unnecessary methods in the subclass.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Specify the pattern of path, where the created HandlerInterceptor is to be applied.</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td>Specify the pattern of path, where the created HandlerInterceptor need not be applied.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td>Add the created HandlerInterceptor to <tt class="docutils literal"><span class="pre">&lt;mvc:interceptors&gt;</span></tt> tag of <tt class="docutils literal"><span class="pre">spring-mvc.xml</span></tt>.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>
<div class="section" id="implementing-common-processes-of-controller">
<h3><a class="toc-backref" href="#id99">4.3.4.2. Implementing common processes of controller</a><a class="headerlink" href="#implementing-common-processes-of-controller" title="Permalink to this headline">¶</a></h3>
<p>Here, common process indicates the process that should be commonly implemented in all the controllers.</p>
<div class="section" id="implementing-handlermethodargumentresolver">
<span id="methodargumentresolver"></span><h4><a class="toc-backref" href="#id100">4.3.4.2.1. Implementing HandlerMethodArgumentResolver</a><a class="headerlink" href="#implementing-handlermethodargumentresolver" title="Permalink to this headline">¶</a></h4>
<p>When an object that is not supported by default in Spring Framework is to be passed as controller argument,
HandlerMethodArgumentResolver is to be implemented in order to enable controller to be able to receive the argument.</p>
<div class="line-block">
<div class="line">Sample of HandlerMethodArgumentResolver is given below.</div>
<div class="line">In sample code, common request parameters are converted to JavaBean which are then passed to processing method of controller.</div>
</div>
<ul class="simple">
<li>JavaBean</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CommonParameters</span> <span class="kd">implements</span> <span class="n">Serializable</span> <span class="o">{</span> <span class="c1">// (1)</span>
</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">param1</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">param2</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">param3</span><span class="o">;</span>

    <span class="c1">// ....</span>

<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>HandlerMethodArgumentResolver</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CommonParametersMethodArgumentResolver</span> <span class="kd">implements</span>
<span class="hll">                                                   <span class="n">HandlerMethodArgumentResolver</span> <span class="o">{</span> <span class="c1">// (2)</span>
</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">supportsParameter</span><span class="o">(</span><span class="n">MethodParameter</span> <span class="n">parameter</span><span class="o">)</span> <span class="o">{</span>
<span class="hll">        <span class="k">return</span> <span class="n">CommonParameters</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">parameter</span><span class="o">.</span><span class="na">getParameterType</span><span class="o">());</span> <span class="c1">// (3)</span>
</span>    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">resolveArgument</span><span class="o">(</span><span class="n">MethodParameter</span> <span class="n">parameter</span><span class="o">,</span>
            <span class="n">ModelAndViewContainer</span> <span class="n">mavContainer</span><span class="o">,</span> <span class="n">NativeWebRequest</span> <span class="n">webRequest</span><span class="o">,</span>
            <span class="n">WebDataBinderFactory</span> <span class="n">binderFactory</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
<span class="hll">        <span class="n">CommonParameters</span> <span class="n">params</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CommonParameters</span><span class="o">();</span> <span class="c1">// (4)</span>
</span>        <span class="n">params</span><span class="o">.</span><span class="na">setParam1</span><span class="o">(</span><span class="n">webRequest</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&quot;param1&quot;</span><span class="o">));</span>
        <span class="n">params</span><span class="o">.</span><span class="na">setParam2</span><span class="o">(</span><span class="n">webRequest</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&quot;param2&quot;</span><span class="o">));</span>
        <span class="n">params</span><span class="o">.</span><span class="na">setParam3</span><span class="o">(</span><span class="n">webRequest</span><span class="o">.</span><span class="na">getParameter</span><span class="o">(</span><span class="s">&quot;param3&quot;</span><span class="o">));</span>
        <span class="k">return</span> <span class="n">params</span><span class="o">;</span>
    <span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>Controller</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;home&quot;</span><span class="o">)</span>
<span class="hll"><span class="kd">public</span> <span class="n">String</span> <span class="nf">home</span><span class="o">(</span><span class="n">CommonParameters</span> <span class="n">commonParams</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// (5)</span>
</span>    <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;param1 : {}&quot;</span><span class="o">,</span><span class="n">commonParams</span><span class="o">.</span><span class="na">getParam1</span><span class="o">());</span>
    <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;param2 : {}&quot;</span><span class="o">,</span><span class="n">commonParams</span><span class="o">.</span><span class="na">getParam2</span><span class="o">());</span>
    <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;param3 : {}&quot;</span><span class="o">,</span><span class="n">commonParams</span><span class="o">.</span><span class="na">getParam3</span><span class="o">());</span>
    <span class="c1">// ...</span>
    <span class="k">return</span> <span class="s">&quot;sample/home&quot;</span><span class="o">;</span>

<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>spring-mvc.xml</li>
</ul>
<blockquote>
<div><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;mvc:annotation-driven&gt;</span>
    <span class="nt">&lt;mvc:argument-resolvers&gt;</span>
        <span class="c">&lt;!-- ... --&gt;</span>
<span class="hll">        <span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&quot;x.y.z.CommonParametersMethodArgumentResolver&quot;</span> <span class="nt">/&gt;</span> <span class="c">&lt;!-- (6) --&gt;</span>
</span>        <span class="c">&lt;!-- ... --&gt;</span>
    <span class="nt">&lt;/mvc:argument-resolvers&gt;</span>
<span class="nt">&lt;/mvc:annotation-driven&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>JavaBean that retains common parameters.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Implement <tt class="docutils literal"><span class="pre">org.springframework.web.method.support.HandlerMethodArgumentResolver</span></tt> interface.</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td>Determine parameter type. For example, when type of JavaBean that retains common parameters is specified as argument of controller,
resolveArgument method of this class is called.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td>Fetch the values of request parameters, set the parameters and return the JavaBean that retains the value of common parameters.</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(5)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Specify JavaBean that retains common parameters in the argument of processing method of controller.</div>
<div class="line">Object returned in step (4) is passed.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(6)</div>
</div>
</td>
<td>Add the created HandlerMethodArgumentResolver to <tt class="docutils literal"><span class="pre">&lt;mvc:argument-resolvers&gt;</span></tt> tag of <tt class="docutils literal"><span class="pre">spring-mvc.xml</span></tt>.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When parameters are to be passed commonly to processing methods of all controllers, it is effective to convert the parameters to JavaBean using HandlerMethodArgumentResolver.
Parameters referred here are not restricted to request parameters.</p>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="implementing-controlleradvice">
<span id="application-layer-controller-advice"></span><h4><a class="toc-backref" href="#id101">4.3.4.2.2. Implementing &#8220;&#64;ControllerAdvice&#8221;</a><a class="headerlink" href="#implementing-controlleradvice" title="Permalink to this headline">¶</a></h4>
<p>Implement the processes which are to be executed in all controllers in <tt class="docutils literal"><span class="pre">&#64;ControllerAdvice</span></tt>, .</p>
<p>In <tt class="docutils literal"><span class="pre">&#64;ControllerAdvice</span></tt>, the following processes are common.</p>
<ul class="simple">
<li>Common <tt class="docutils literal"><span class="pre">&#64;InitBinder</span></tt> method</li>
<li>Common <tt class="docutils literal"><span class="pre">&#64;ExceptionHandler</span></tt> method</li>
<li>Common <tt class="docutils literal"><span class="pre">&#64;ModelAttribute</span></tt> method</li>
</ul>
<div class="line-block">
<div class="line-block">
<div class="line">Sample of <tt class="docutils literal"><span class="pre">&#64;InitBinder</span></tt>method is given below.</div>
</div>
<div class="line">In sample code, date that can be specified in request parameter is set to <tt class="docutils literal"><span class="pre">&quot;yyyy/MM/dd&quot;</span></tt> .</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="nd">@ControllerAdvice</span> <span class="c1">// (1)</span>
</span><span class="hll"><span class="nd">@Component</span> <span class="c1">// (2)</span>
</span><span class="hll"><span class="nd">@Order</span><span class="o">(</span><span class="mi">0</span><span class="o">)</span> <span class="c1">// (3)</span>
</span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SampleControllerAdvice</span> <span class="o">{</span>

<span class="hll">    <span class="c1">// (4)</span>
</span><span class="hll">    <span class="nd">@InitBinder</span>
</span>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initBinder</span><span class="o">(</span><span class="n">WebDataBinder</span> <span class="n">binder</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">SimpleDateFormat</span> <span class="n">dateFormat</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SimpleDateFormat</span><span class="o">(</span><span class="s">&quot;yyyy/MM/dd&quot;</span><span class="o">);</span>
        <span class="n">dateFormat</span><span class="o">.</span><span class="na">setLenient</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span>
        <span class="n">binder</span><span class="o">.</span><span class="na">registerCustomEditor</span><span class="o">(</span><span class="n">Date</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
                <span class="k">new</span> <span class="nf">CustomDateEditor</span><span class="o">(</span><span class="n">dateFormat</span><span class="o">,</span> <span class="kc">true</span><span class="o">));</span>
    <span class="o">}</span>

<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>It indicates that it is Bean of ControllerAdvice by assigning the <tt class="docutils literal"><span class="pre">&#64;ControllerAdvice</span></tt>annotation.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>It should be component-scan target by assigning the <tt class="docutils literal"><span class="pre">&#64;Component</span></tt>annotation.</td>
</tr>
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(3)</div>
</div>
</td>
<td>Specify priority for common processes by assigning the <tt class="docutils literal"><span class="pre">&#64;Order</span></tt>annotation. It should be specified when multiple ControllerAdvice are to be created.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(4)</div>
</div>
</td>
<td>Implement <tt class="docutils literal"><span class="pre">&#64;InitBinder</span></tt>method. <tt class="docutils literal"><span class="pre">&#64;InitBinder</span></tt>method is applied to all Controllers.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line">Sample of <tt class="docutils literal"><span class="pre">&#64;ExceptionHandler</span></tt>method is given below.</div>
<div class="line">In sample code, View of lock error screen is returned by handling <tt class="docutils literal"><span class="pre">org.springframework.dao.PessimisticLockingFailureException</span></tt>.</div>
</div>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="c1">// (1)</span>
</span><span class="hll"><span class="nd">@ExceptionHandler</span><span class="o">(</span><span class="n">PessimisticLockingFailureException</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
</span><span class="kd">public</span> <span class="n">String</span> <span class="nf">handlePessimisticLockingFailureException</span><span class="o">(</span>
        <span class="n">PessimisticLockingFailureException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">return</span> <span class="s">&quot;error/lockError&quot;</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Implement <tt class="docutils literal"><span class="pre">&#64;ExceptionHandler</span></tt>method. <tt class="docutils literal"><span class="pre">&#64;ExceptionHandler</span></tt>method is applied to all Controllers.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line">Sample of <tt class="docutils literal"><span class="pre">&#64;ModelAttribute</span></tt>method is given below.</div>
<div class="line">In sample code, common request parameters are converted to JavaBean and stored in <tt class="docutils literal"><span class="pre">Model</span></tt>.</div>
</div>
<ul class="simple">
<li>ControllerAdvice</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="hll"><span class="c1">// (1)</span>
</span><span class="hll"><span class="nd">@ModelAttribute</span>
</span><span class="kd">public</span> <span class="n">CommonParameters</span> <span class="nf">setUpCommonParameters</span><span class="o">(</span>
        <span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;param1&quot;</span><span class="o">,</span> <span class="n">defaultValue</span><span class="o">=</span><span class="s">&quot;def1&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">param1</span><span class="o">,</span>
        <span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;param2&quot;</span><span class="o">,</span> <span class="n">defaultValue</span><span class="o">=</span><span class="s">&quot;def2&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">param2</span><span class="o">,</span>
        <span class="nd">@RequestParam</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;param3&quot;</span><span class="o">,</span> <span class="n">defaultValue</span><span class="o">=</span><span class="s">&quot;def3&quot;</span><span class="o">)</span> <span class="n">String</span> <span class="n">param3</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">CommonParameters</span> <span class="n">params</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CommonParameters</span><span class="o">();</span>
    <span class="n">params</span><span class="o">.</span><span class="na">setParam1</span><span class="o">(</span><span class="n">param1</span><span class="o">);</span>
    <span class="n">params</span><span class="o">.</span><span class="na">setParam2</span><span class="o">(</span><span class="n">param2</span><span class="o">);</span>
    <span class="n">params</span><span class="o">.</span><span class="na">setParam3</span><span class="o">(</span><span class="n">param3</span><span class="o">);</span>
    <span class="k">return</span> <span class="n">params</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>Controller</li>
</ul>
<blockquote>
<div><div class="highlight-java"><div class="highlight"><pre><span class="nd">@RequestMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&quot;home&quot;</span><span class="o">)</span>
<span class="hll"><span class="kd">public</span> <span class="n">String</span> <span class="nf">home</span><span class="o">(</span><span class="nd">@ModelAttribute</span> <span class="n">CommonParameters</span> <span class="n">commonParams</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// (2)</span>
</span>    <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;param1 : {}&quot;</span><span class="o">,</span><span class="n">commonParams</span><span class="o">.</span><span class="na">getParam1</span><span class="o">());</span>
    <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;param2 : {}&quot;</span><span class="o">,</span><span class="n">commonParams</span><span class="o">.</span><span class="na">getParam2</span><span class="o">());</span>
    <span class="n">logger</span><span class="o">.</span><span class="na">debug</span><span class="o">(</span><span class="s">&quot;param3 : {}&quot;</span><span class="o">,</span><span class="n">commonParams</span><span class="o">.</span><span class="na">getParam3</span><span class="o">());</span>
    <span class="c1">// ...</span>
    <span class="k">return</span> <span class="s">&quot;sample/home&quot;</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td>Implement <tt class="docutils literal"><span class="pre">&#64;ModelAttribute</span></tt>method. <tt class="docutils literal"><span class="pre">&#64;ModelAttribute</span></tt>method is applied to all Controllers.</td>
</tr>
<tr class="row-odd"><td><div class="first last line-block">
<div class="line">(2)</div>
</div>
</td>
<td>Object created by <tt class="docutils literal"><span class="pre">&#64;ModelAttribute</span></tt> method is passed.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</div>
</div>
</div>
<div class="section" id="prevention-of-double-submission">
<h2><a class="toc-backref" href="#id102">4.3.5. Prevention of double submission</a><a class="headerlink" href="#prevention-of-double-submission" title="Permalink to this headline">¶</a></h2>
<p>Measures should be taken to prevent double submission as the same process gets executed multiple times by clicking Send button multiple times or
refreshing (refresh using F5 button) the Finish screen.</p>
<p>For the problems occurring when countermeasures are not taken and details of implementation method, refer to <a class="reference internal" href="../ArchitectureInDetail/DoubleSubmitProtection.html"><em>Double Submit Protection</em></a> .</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="usage-of-session">
<h2><a class="toc-backref" href="#id103">4.3.6. Usage of session</a><a class="headerlink" href="#usage-of-session" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">In the default operations of Spring MVC, model (form object, domain object etc.) is not stored in session.</div>
<div class="line">When it is to be stored in session, it is necessary to assign  <tt class="docutils literal"><span class="pre">&#64;SessionAttributes</span></tt>annotation to the controller class.</div>
<div class="line">When input forms are split on multiple screens, usage of <tt class="docutils literal"><span class="pre">&#64;SessionAttributes</span></tt> annotation should be studied since model (form object, domain object etc.)</div>
<div class="line">can be shared between multiple requests for executing a series of screen transitions.</div>
<div class="line">However, whether to use <tt class="docutils literal"><span class="pre">&#64;SessionAttributes</span></tt> annotation should be determined after confirming the warning signs of using the session.</div>
</div>
<p>For details of session usage policy and implementation at the time of session usage, refer to <a class="reference internal" href="../ArchitectureInDetail/SessionManagement.html"><em>Session Management</em></a> .</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../ArchitectureInDetail/index.html" title="5. Architecture in Detail - TERASOLUNA Global Framework"
             >next</a> |</li>
        <li class="right" >
          <a href="InfrastructureLayer.html" title="4.2. Implementation of Infrastructure Layer"
             >previous</a> |</li>
        <li><a href="../index.html">TERASOLUNA Global Framework Development Guideline 1.1.0-SNAPSHOT documentation</a> &raquo;</li>
          <li><a href="index.html" >4. Application Development using TERASOLUNA Global Framework</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013-2014, NTT DATA.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.Theme by <a href="http://github.com/vkvn">vkvn</a>
    </div>
    
    <script>
    
    $(function() {
    	var $sidebar	= $('.sphinxsidebar'),
    		$window		= $(window),
    		offset		= $sidebar.offset(),
    		topPadding	= 3,
    		$scroll		= $('#scroll');
    	
    	$window.scroll(function() {
    		if ($scroll.is(':checked')) {
				if ($window.scrollTop() > offset.top) {
					$sidebar.stop().animate({
						marginTop:$window.scrollTop() - offset.top + topPadding
					});
				} else {
					$sidebar.stop().animate({
						marginTop:0
					});
				}
			}
		});
    	
    	var $navList = $('ul:first', $sidebar);
    	$('li:first', $navList).addClass('open');
    	
    	$navList.treeview({
    		persist: "location",
    		collapsed: true,
    		unique: false
    	});
    	
	});
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-46550814-1', 'terasolunaorg.github.io');
    ga('send', 'pageview');
    </script>
  </body>
</html>