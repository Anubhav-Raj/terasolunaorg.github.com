<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>6.6. XSS(Cross Site Scripting) Countermeasures &mdash; TERASOLUNA Global Framework Development Guideline 1.0.0.publicreview documentation</title>
    
    <link rel="stylesheet" href="../_static/solar.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0.0.publicreview',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="TERASOLUNA Global Framework Development Guideline 1.0.0.publicreview documentation" href="../index.html" />
    <link rel="up" title="6. Security for TERASOLUNA Global Framework" href="index.html" />
    <link rel="next" title="6.7. [coming soon] CSRF(Cross Site Request Forgeries) Countermeasures" href="CSRF.html" />
    <link rel="prev" title="6.5. [coming soon] Authorization" href="Authorization.html" /><script src="../_static/jquery.treeview.js" type="text/javascript"></script>
<!-- <link href='http://fonts.googleapis.com/css?family=Source+Code+Pro|Open+Sans:300italic,400italic,700italic,400,300,700' rel='stylesheet' type='text/css'> -->
<link href="../_static/solarized-dark.css" rel="stylesheet">
<link href="../_static/jquery.treeview.css" rel="stylesheet">
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="CSRF.html" title="6.7. [coming soon] CSRF(Cross Site Request Forgeries) Countermeasures"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="Authorization.html" title="6.5. [coming soon] Authorization"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">TERASOLUNA Global Framework Development Guideline 1.0.0.publicreview documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">6. Security for TERASOLUNA Global Framework</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper"><label><input id="scroll" type="checkbox" checked> scroll sidebar</label>

  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">6.6. XSS(Cross Site Scripting) Countermeasures</a><ul>
<li><a class="reference internal" href="#overview">6.6.1. Overview</a><ul>
<li><a class="reference internal" href="#stored-reflected-xss-attacks">6.6.1.1. Stored, Reflected XSS Attacks</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-to-use">6.6.2. How to use</a><ul>
<li><a class="reference internal" href="#output-escaping">6.6.2.1. Output Escaping</a><ul>
<li><a class="reference internal" href="#example-of-vulnerability-where-output-value-is-not-escaped">6.6.2.1.1. Example of vulnerability where output value is not escaped</a></li>
<li><a class="reference internal" href="#example-of-escaping-output-value-using-f-h-function">6.6.2.1.2. Example of escaping output value using f:h() function</a></li>
</ul>
</li>
<li><a class="reference internal" href="#javascript-escaping">6.6.2.2. JavaScript Escaping</a><ul>
<li><a class="reference internal" href="#example-of-vulnerability-where-escaping-of-output-value-is-not-performed">6.6.2.2.1. Example of vulnerability where escaping of output value is not performed</a></li>
<li><a class="reference internal" href="#example-of-escaping-output-value-using-f-js-function">6.6.2.2.2. Example of escaping output value using f:js() function</a></li>
</ul>
</li>
<li><a class="reference internal" href="#event-handler-escaping">6.6.2.3. Event handler Escaping</a><ul>
<li><a class="reference internal" href="#example-of-inability-to-escape-vulnerability-of-output-value">6.6.2.3.1. Example of inability to escape vulnerability of output value</a></li>
<li><a class="reference internal" href="#example-of-escaping-output-value-using-f-hjs-function">6.6.2.3.2. Example of escaping output value using f:hjs() function</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>


  <h4>Previous topic</h4>
  <p class="topless"><a href="Authorization.html"
                        title="previous chapter">6.5. [coming soon] Authorization</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="CSRF.html"
                        title="next chapter">6.7. [coming soon] CSRF(Cross Site Request Forgeries) Countermeasures</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/Security/XSS.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="xss-cross-site-scripting-countermeasures">
<h1>6.6. XSS(Cross Site Scripting) Countermeasures<a class="headerlink" href="#xss-cross-site-scripting-countermeasures" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>6.6.1. Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>Cross Site Scripting is injection of malicious scripts across trusted web sites
used intentionally making use of the security flaws of the web application.
For example, when data (form input) entered in web application is output in HTML where appropriate escaping is not performed,
the characters of tag existing in input value is interpreted as HTML.
Session hijack occurs when script with a malicious value acquires the cookie value and
tampers cookie information.</p>
<div class="section" id="stored-reflected-xss-attacks">
<h3>6.6.1.1. Stored, Reflected XSS Attacks<a class="headerlink" href="#stored-reflected-xss-attacks" title="Permalink to this headline">¶</a></h3>
<p>XSS attacks are broadly classified into two categories.</p>
<p><strong>Stored XSS Attacks</strong></p>
<p>Stored XSS Attacks are those where the malicious code is permanently stored on target servers
such as in a database.
The victim then retrieves the malicious script from the server when it requests the stored information.</p>
<p><strong>Reflected XSS Attacks</strong></p>
<p>Reflected attacks are those where the malicious code is reflected off the web server
such as in an error message, search result, or any other response that includes some or all of the input sent to the server as part of the request.
When a user is tricked into clicking on a malicious link, submitting a specially crafted form, or even just browsing to a malicious site,
the injected code travels to the vulnerable web site, which reflects the attack back to the user&#8217;s browser.
The browser then executes the code because it came from a &#8220;trusted&#8221; server.</p>
<p>Both Stored XSS Attacks and Reflected XSS Attacks can be prevented by escaping output value.</p>
</div>
</div>
<div class="section" id="how-to-use">
<h2>6.6.2. How to use<a class="headerlink" href="#how-to-use" title="Permalink to this headline">¶</a></h2>
<p>When the input from user is output as it is, XSS vulnerability occurs.
Therefore, as a countermeasure against XSS vulnerability, escaping of characters having specific meaning
should be performed in HTML markup language.</p>
<p>Escaping is of 3 types depending on the requirements.</p>
<p>Escaping types:</p>
<blockquote>
<div><ul class="simple">
<li>Output Escaping</li>
<li>JavaScript Escaping</li>
<li>Event handler Escaping</li>
</ul>
</div></blockquote>
<div class="section" id="output-escaping">
<h3>6.6.2.1. Output Escaping<a class="headerlink" href="#output-escaping" title="Permalink to this headline">¶</a></h3>
<p>HTML escaping for special characters is performed as a countermeasure against XSS vulnerability.
Examples of before and after escaping for special characters in HTML are shown below:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Before escaping</th>
<th class="head">After escaping</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">&amp;</span></tt></td>
<td><tt class="docutils literal"><span class="pre">&amp;amp;</span></tt></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">&lt;</span></tt></td>
<td><tt class="docutils literal"><span class="pre">&amp;lt;</span></tt></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">&gt;</span></tt></td>
<td><tt class="docutils literal"><span class="pre">&amp;gt;</span></tt></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">&quot;</span></tt></td>
<td><tt class="docutils literal"><span class="pre">&amp;quot;</span></tt></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">'</span></tt></td>
<td><tt class="docutils literal"><span class="pre">&amp;#39;</span></tt></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><tt class="docutils literal"><span class="pre">f:h()</span></tt> should be used in all display items to be output as string to prevent XSS.</div>
<div class="line">An example of application where input value is to be redisplayed on another screen is described.</div>
</div>
<div class="section" id="example-of-vulnerability-where-output-value-is-not-escaped">
<h4>6.6.2.1.1. Example of vulnerability where output value is not escaped<a class="headerlink" href="#example-of-vulnerability-where-output-value-is-not-escaped" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">Since the example is only described as reference example, the implementation as follows should not be performed.</div>
</div>
<p><strong>Implementation of output screen</strong></p>
<div class="highlight-jsp"><div class="highlight"><pre><span class="c">&lt;!-- omitted --&gt;</span>
<span class="nt">&lt;tr&gt;</span>
    <span class="nt">&lt;td&gt;</span>Job<span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;td&gt;</span>${customerForm.job}<span class="nt">&lt;/td&gt;</span>  <span class="c">&lt;!-- (1) --&gt;</span>
<span class="nt">&lt;/tr&gt;</span>
<span class="c">&lt;!-- omitted --&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is customerForm field and job is output without escaping.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">Enter &lt;script&gt; tag in Job field on input screen.</div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/xss_screen_input_html_tag.png"><img alt="input_html_tag" src="../_images/xss_screen_input_html_tag.png" style="width: 80%;" /></a>
<p class="caption"><strong>Picture - Input HTML Tag</strong></p>
</div>
<p><a href="#id1"><span class="problematic" id="id2">|</span></a>It is recognized as &lt;script&gt; tag and dialog box is displayed.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/xss_screen_no_escape_result.png"><img alt="no_escape_result" src="../_images/xss_screen_no_escape_result.png" style="width: 60%;" /></a>
<p class="caption"><strong>Picture - No Escape Result</strong></p>
</div>
</div>
<div class="section" id="example-of-escaping-output-value-using-f-h-function">
<h4>6.6.2.1.2. Example of escaping output value using f:h() function<a class="headerlink" href="#example-of-escaping-output-value-using-f-h-function" title="Permalink to this headline">¶</a></h4>
<p><strong>Implementation of output screen</strong></p>
<div class="highlight-jsp"><div class="highlight"><pre><span class="c">&lt;!-- omitted --&gt;</span>
<span class="nt">&lt;tr&gt;</span>
    <span class="nt">&lt;td&gt;</span>Job<span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;td&gt;</span>${f:h(customerForm.job)}<span class="nt">&lt;/td&gt;</span>  <span class="c">&lt;!-- (1) --&gt;</span>
<span class="nt">&lt;/tr&gt;</span>
.<span class="c">&lt;!-- omitted --&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">Value is output after escaping by <tt class="docutils literal"><span class="pre">f:h()</span></tt>  of EL expressions.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">Enter &lt;script&gt; tag in Job field on input screen.</div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/xss_screen_input_html_tag.png"><img alt="input_html_tag" src="../_images/xss_screen_input_html_tag.png" style="width: 80%;" /></a>
<p class="caption"><strong>Picture - Input HTML Tag</strong></p>
</div>
<div class="line-block">
<div class="line">By escaping special characters,</div>
<div class="line">input value is output as it is without considering as the &lt;script&gt; tag.</div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/xss_screen_escape_result.png"><img alt="escape_result" src="../_images/xss_screen_escape_result.png" style="width: 60%;" /></a>
<p class="caption"><strong>Picture - Escape Result</strong></p>
</div>
<p><strong>Output result</strong></p>
<div class="highlight-jsp"><div class="highlight"><pre><span class="c">&lt;!-- omitted --&gt;</span>
<span class="nt">&lt;tr&gt;</span>
    <span class="nt">&lt;td&gt;</span>Job<span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;td&gt;</span><span class="ni">&amp;lt;</span>script<span class="ni">&amp;gt;</span>alert(<span class="ni">&amp;quot;</span>XSS Attack<span class="ni">&amp;quot;</span>)<span class="ni">&amp;lt;</span>/script<span class="ni">&amp;gt;</span><span class="nt">&lt;/td&gt;</span>
<span class="nt">&lt;/tr&gt;</span>
<span class="c">&lt;!-- omitted --&gt;</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p><strong>java.util.Date inheritance class format</strong></p>
<p>It is recommended to use <tt class="docutils literal"><span class="pre">&lt;fmt:formatDate&gt;</span></tt> of JSTL to format and display java.util.Date inheritance class.
Example of settings is described below.</p>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="nt">&lt;fmt:formatDate</span> <span class="na">value=</span><span class="s">&quot;${form.date}&quot;</span> <span class="na">pattern=</span><span class="s">&quot;yyyyMMdd&quot;</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
</div></blockquote>
<p class="last">Value is set to String using <tt class="docutils literal"><span class="pre">f:h()</span></tt> described earlier in &#8216;value&#8217; and since <tt class="docutils literal"><span class="pre">javax.el.ELException</span></tt>  is thrown, <tt class="docutils literal"><span class="pre">${form.date}</span></tt> is used.
However, it is safe from XSS attack since the value is in yyyyMMdd format.</p>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p><strong>String that can be passed to java.lang.Number inheritance class or java.lang.Number</strong></p>
<p>It is recommended to use <tt class="docutils literal"><span class="pre">&lt;fmt:formatNumber&gt;</span></tt> to format and display the string that can be passed to java.lang.Number inheritance class or java.lang.Number.
Example of settings is described below.</p>
<blockquote>
<div><div class="highlight-jsp"><div class="highlight"><pre><span class="nt">&lt;fmt:formatNumber</span> <span class="na">value=</span><span class="s">&quot;${f:h(form.price)}&quot;</span> <span class="na">pattern=</span><span class="s">&quot;###,###&quot;</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
</div></blockquote>
<p class="last">Since there is no problem even if the above is String, <tt class="docutils literal"><span class="pre">f:h()</span></tt> is explicitly used to prevent forgetting to add <tt class="docutils literal"><span class="pre">f:h()</span></tt>  when <tt class="docutils literal"><span class="pre">&lt;fmt:formatNumber&gt;</span></tt> tag is no longer used.</p>
</div>
</div>
</div>
<div class="section" id="javascript-escaping">
<h3>6.6.2.2. JavaScript Escaping<a class="headerlink" href="#javascript-escaping" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">JavaScript escaping for special characters is performed as a countermeasure against XSS vulnerability.</div>
<div class="line">Escaping should be performed to dynamically generate string literal of JavaScript based on the input from outside.</div>
</div>
<div class="line-block">
<div class="line">Example of before and after JavaScript escaping for special characters is shown below.</div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Before escaping</th>
<th class="head">After escaping</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">'</span></tt></td>
<td><tt class="docutils literal"><span class="pre">\'</span></tt></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">&quot;</span></tt></td>
<td><tt class="docutils literal"><span class="pre">\&quot;</span></tt></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">\</span></tt></td>
<td><tt class="docutils literal"><span class="pre">\\</span></tt></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">/</span></tt></td>
<td><tt class="docutils literal"><span class="pre">\/</span></tt></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">&lt;</span></tt></td>
<td><tt class="docutils literal"><span class="pre">\x3c</span></tt></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">&gt;</span></tt></td>
<td><tt class="docutils literal"><span class="pre">\x3e</span></tt></td>
</tr>
<tr class="row-even"><td><tt class="docutils literal"><span class="pre">0x0D(Return)</span></tt></td>
<td><tt class="docutils literal"><span class="pre">\r</span></tt></td>
</tr>
<tr class="row-odd"><td><tt class="docutils literal"><span class="pre">0x0A(Linefeed)</span></tt></td>
<td><tt class="docutils literal"><span class="pre">\n</span></tt></td>
</tr>
</tbody>
</table>
<div class="section" id="example-of-vulnerability-where-escaping-of-output-value-is-not-performed">
<h4>6.6.2.2.1. Example of vulnerability where escaping of output value is not performed<a class="headerlink" href="#example-of-vulnerability-where-escaping-of-output-value-is-not-performed" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">Example of occurrence of XSS problem is described below.</div>
</div>
<div class="highlight-jsp"><div class="highlight"><pre><span class="nt">&lt;html&gt;</span>
  <span class="nt">&lt;script</span>  <span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
      var aaa = &#39;${warnCode}&#39;;
      document.write(aaa);
  <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;html&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute name</th>
<th class="head">Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>warnCode</td>
<td><tt class="docutils literal"><span class="pre">&quot;foo&quot;;</span> <span class="pre">&lt;script&gt;alert(&quot;XSS</span> <span class="pre">Attack!&quot;);&lt;/script&gt;</span> <span class="pre">dummy=</span></tt></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">To output code derived from input provided by the user</div>
<div class="line">and to dynamically generate JavaScript elements as shown in the above example, string literal is closed unintentionally and XSS vulnerability occurs.</div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/javascript_xss_screen_no_escape_result.png"><img alt="javascript_xss_screen_no_escape_result" src="../_images/javascript_xss_screen_no_escape_result.png" style="width: 30%;" /></a>
<p class="caption"><strong>Picture - No Escape Result</strong></p>
</div>
<p><strong>Output result</strong></p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;script  </span><span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
    <span class="kd">var</span> <span class="nx">aaa</span> <span class="o">=</span> <span class="s2">&quot;\&quot;foo\&quot;; &lt;script&gt;alert(\&quot;XSS!\&quot;);&lt;\/script&gt; dummy=&quot;</span><span class="p">;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">aaa</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">As long as there is no business requirement, JavaScript elements are dynamically generated depending on the input from outside
since there is a possibility of an arbitrary script being inserted, consider another method or avoid it to the extent possible.</p>
</div>
</div>
<div class="section" id="example-of-escaping-output-value-using-f-js-function">
<h4>6.6.2.2.2. Example of escaping output value using f:js() function<a class="headerlink" href="#example-of-escaping-output-value-using-f-js-function" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">To prevent XSS, it is recommended to use EL expression function and <tt class="docutils literal"><span class="pre">f:js()</span></tt> for the value entered by the user.</div>
</div>
<p>Usage example is shown below.</p>
<div class="highlight-jsp"><div class="highlight"><pre><span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
  var message = &#39;${f:js(message)}&#39;;  // (1)
  <span class="c">&lt;!-- omitted --&gt;</span>
<span class="nt">&lt;/script&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is an argument after escaping by <tt class="docutils literal"><span class="pre">f:js()</span></tt> of EL expressions.</div>
</div>
</td>
</tr>
</tbody>
</table>
<p><strong>Output result</strong></p>
<div class="highlight-jsp"><div class="highlight"><pre><span class="nt">&lt;script</span>  <span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
    var aaa = &#39;\x3cscript\x3ealert(XSS Attack!);\x3c\/script\x3e&#39;;
    document.write(aaa);
<span class="nt">&lt;/script&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="event-handler-escaping">
<h3>6.6.2.3. Event handler Escaping<a class="headerlink" href="#event-handler-escaping" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">To escape event handler of javascript, <tt class="docutils literal"><span class="pre">f:hjs()</span></tt>  should be used instead of <tt class="docutils literal"><span class="pre">f:h()</span></tt> or <tt class="docutils literal"><span class="pre">f:js()</span></tt></div>
<div class="line">It is same as  <tt class="docutils literal"><span class="pre">${f:h(f:js())}</span></tt>.</div>
</div>
<div class="line-block">
<div class="line">When <tt class="docutils literal"><span class="pre">&quot;');alert(&quot;XSS</span> <span class="pre">Atack&quot;);//</span> <span class="pre">&quot;</span></tt> is specified as event handler value such as <tt class="docutils literal"><span class="pre">&lt;input</span> <span class="pre">type=&quot;submit&quot;</span> <span class="pre">onclick=&quot;callback('xxxx');&quot;&gt;</span></tt>,</div>
<div class="line">since another script can be inserted, <tt class="docutils literal"><span class="pre">&quot;');alert(&quot;XSS</span> <span class="pre">Atack&quot;);//</span> <span class="pre">&quot;</span></tt>,</div>
<div class="line">HTML escaping should be performed after performing escaping in character reference format.</div>
</div>
<div class="section" id="example-of-inability-to-escape-vulnerability-of-output-value">
<h4>6.6.2.3.1. Example of inability to escape vulnerability of output value<a class="headerlink" href="#example-of-inability-to-escape-vulnerability-of-output-value" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">Examples of XSS occurrence are described below.</div>
</div>
<div class="highlight-jsp"><div class="highlight"><pre><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">onmouseover=</span><span class="s">&quot;alert(&#39;output is ${warnCode}&#39;) . &quot;</span><span class="nt">&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute name</th>
<th class="head">Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>warnCode</td>
<td><div class="first last line-block">
<div class="line"><tt class="docutils literal"><span class="pre">');</span> <span class="pre">alert('XSS</span> <span class="pre">Attack!');</span> <span class="pre">//</span></tt></div>
<div class="line">When the above values are set, string literal is closed unintentionally and XSS attack occurs.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">XSS dialog box is displayed on mouseover.</div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/eventhandler_xss_screen_no_escape_result.png"><img alt="eventhandler_xss_screen_no_escape_result" src="../_images/eventhandler_xss_screen_no_escape_result.png" style="width: 50%;" /></a>
<p class="caption"><strong>Picture - No Escape Result</strong></p>
</div>
<p><strong>Output result</strong></p>
<div class="highlight-jsp"><div class="highlight"><pre><span class="c">&lt;!-- omitted --&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">onmouseover=</span><span class="s">&quot;alert(&#39;output is&#39;); alert(&#39;XSS Attack!&#39;); // .&#39;) &quot;</span><span class="nt">&gt;</span>
<span class="c">&lt;!-- omitted --&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="example-of-escaping-output-value-using-f-hjs-function">
<h4>6.6.2.3.2. Example of escaping output value using f:hjs() function<a class="headerlink" href="#example-of-escaping-output-value-using-f-hjs-function" title="Permalink to this headline">¶</a></h4>
<p>Usage example is shown below:</p>
<div class="highlight-jsp"><div class="highlight"><pre><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">onmouseover=</span><span class="s">&quot;alert(&#39;output is ${f:hjs(warnCode)}&#39;) . &quot;</span><span class="nt">&gt;</span>  // (1)
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Sr.No.</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><div class="first last line-block">
<div class="line">(1)</div>
</div>
</td>
<td><div class="first last line-block">
<div class="line">It is an argument after escaping by <tt class="docutils literal"><span class="pre">f:hjs()</span></tt> of EL expressions.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line">XSS dialog is not output on mouseover.</div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="../_images/eventhandler_xss_screen_escape_result.png"><img alt="eventhandler_xss_screen_escape_result" src="../_images/eventhandler_xss_screen_escape_result.png" style="width: 50%;" /></a>
<p class="caption"><strong>Picture - Escape Result</strong></p>
</div>
<p><strong>Output result</strong></p>
<div class="highlight-jsp"><div class="highlight"><pre><span class="c">&lt;!-- omitted --&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">onmouseover=</span><span class="s">&quot;alert(&#39;output is \&amp;#39;); alert(\&amp;#39;XSS Attack!\&amp;#39;);\&amp;quot; \/\/ .&#39;) &quot;</span><span class="nt">&gt;</span>
<span class="c">&lt;!-- omitted --&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="CSRF.html" title="6.7. [coming soon] CSRF(Cross Site Request Forgeries) Countermeasures"
             >next</a> |</li>
        <li class="right" >
          <a href="Authorization.html" title="6.5. [coming soon] Authorization"
             >previous</a> |</li>
        <li><a href="../index.html">TERASOLUNA Global Framework Development Guideline 1.0.0.publicreview documentation</a> &raquo;</li>
          <li><a href="index.html" >6. Security for TERASOLUNA Global Framework</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, NTT DATA.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.Theme by <a href="http://github.com/vkvn">vkvn</a>
    </div>
    
    <script>
    
    $(function() {
    	var $sidebar	= $('.sphinxsidebar'),
    		$window		= $(window),
    		offset		= $sidebar.offset(),
    		topPadding	= 3,
    		$scroll		= $('#scroll');
    	
    	$window.scroll(function() {
    		if ($scroll.is(':checked')) {
				if ($window.scrollTop() > offset.top) {
					$sidebar.stop().animate({
						marginTop:$window.scrollTop() - offset.top + topPadding
					});
				} else {
					$sidebar.stop().animate({
						marginTop:0
					});
				}
			}
		});
    	
    	var $navList = $('ul:first', $sidebar);
    	$('li:first', $navList).addClass('open');
    	
    	$navList.treeview({
    		persist: "location",
    		collapsed: true,
    		unique: false
    	});
    	
	});
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-46550814-1', 'terasolunaorg.github.io');
    ga('send', 'pageview');
    </script>
  </body>
</html>